#######################################################################
# ###                                                             ### #
# ### EPICS Database for                                          ### #
# ###   iseg HAL                                                  ### #
# ###                                                             ### #
# ### author: J. Roemer, F.Feldbauer                              ### #
# ###                                                             ### #
# ###                                                             ### #
# ### macros: CONTROLLER_SN    serial number of crate controller  ### #
# ###         CAN_LINE    CAN line ID                             ### #
# ###         CRATE_ID    crate address                           ### #
# ###         MODULE_ID   module address                          ### #
# ###         CHANNEL_ID  HV channel address                      ### #
#######################################################################
# ###    Modified: 8-21-2018 PR     ### #
# ###    Fixes interlock PVs           ### #
# ###    1 Alias           	            ### #
#test
#######################################################################

###############################
# ### CAN_System item values ##
###############################

record( stringin, "ISEG:5230102:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@Status can0" )	
  field( FLNK, "ISEG:5230102:BitRate" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:BitRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@BitRate can0" )
  field( TSE,  "-2" )
}	

record( longin, "ISEG:5230102:ModuleNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@ModuleNumber can0" )
  field( FLNK, "ISEG:5230102:CrateNumber" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:CrateNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CrateNumber can0" )
  field( FLNK, "ISEG:5230102:CrateList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:CrateList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CrateList can0" )
  field( FLNK, "ISEG:5230102:CycleCounter" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:CycleCounter" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CycleCounter can0" )
  field( TSE,  "-2" )
}

#############################
# ### CAN_Line item values ##
#############################

record( stringin, "ISEG:5230102:0:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.Status can0" )
  field( FLNK, "ISEG:5230102:0:BitRate" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:BitRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.BitRate can0" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:ModuleNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.ModuleNumber can0" )
  field( FLNK, "ISEG:5230102:0:ModuleList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:ModuleList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.ModuleList can0" )
  field( FLNK, "ISEG:5230102:0:CrateNumber" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:CrateNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.CrateNumber can0" )
  field( FLNK, "ISEG:5230102:0:CrateList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:CrateList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.CrateList can0" )
  field( TSE,  "-2" )
}

#############################
# ### Crate item values ### #
#############################

record( mbbiDirect, "ISEG:5230102:0:1000:StatusLow" ) {
  field( DESC, "Lower 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Status can0" )
  field( NOBT, "16" )
  field( SHFT, "0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1000:StatusHigh" ) {
  field( DESC, "Upper 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Status can0" )
  field( NOBT, "16" )
  field( SHFT, "16" )  ## shift the value by 16 bits to the right
  field( TSE,  "-2" )
}

# Alternative way to read out the status:
# In this case only the calc record needs to be triggered

#record( longin, "ISEG:5230102:0:1000:StatusRead__" ) {
#  field( DTYP, "isegHAL" )
#  field( INP,  "@0.1000.Status can0" )
#}
#record( calc, "ISEG:5230102:0:1000:StatusSplit__" ) {
#  ## PP = Passive Process: Force the other record to process before sending the value
#  field( INPA, "ISEG:5230102:0:1000:StatusRead PP" )
#
#  field( INPB, "0x0000ffff" )
#  field( INPC, "0xffff0000" )
#
#  ## First, set field D to ( field A bitwise AND field B ),
#  ## then set field VAL to ( field A bitwise AND field C ) right shifted by 16 bit
#  field( CALC, "d:=(A&B); (A&C)>>16" )
#}
#record( mbbiDirect, "ISEG:5230102:0:1000:StatusLow" ) {
#  field( DTYP, "Soft Channel" )
#  field( INP,  "ISEG:5230102:0:1000:StatusSplit__.D CP" )
#}
#record( mbbiDirect, "ISEG:5230102:0:1000:StatusHigh" ) {
#  field( DTYP, "Soft Channel" )
#  field( INP,  "ISEG:5230102:0:1000:StatusSplit__.VAL CP" )
#}

record( mbbiDirect, "ISEG:5230102:0:1000:EventStatusLow" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.EventStatus can0" )
  field( NOBT, "16" )
  field( SHFT, "0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1000:EventStatusHigh" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.EventStatus can0" )
  field( NOBT, "16" )
  field( SHFT, "16" )
  field( TSE,  "-2" )
}
record( longout, "ISEG:5230102:0:1000:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.EventMask can0" )
  field( TSE,  "-2" )
}
record( ai, "ISEG:5230102:0:1000:FanSpeed" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FanSpeed can0" )
  field( TSE,  "-2" )
  field( SCAN, "1 second")
}

record( bo, "ISEG:5230102:0:1000:Control:0" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.Control:0 can0" )
  field( ZNAM, "" )
  field( ONAM, "doClear" )
  field( TSE,  "-2" )
}


record( longin, "ISEG:5230102:0:1000:SerialNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.SerialNumber can0" )
  field( TSE,  "-2" )
  field( SCAN,  "1 second" )
}

record( bo, "ISEG:5230102:0:1000:PowerOn" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.PowerOn can0" )
  field( TSE,  "-2" )
  field( ZNAM, "Off" )
  field( ONAM, "On" )
}

record( stringin, "ISEG:5230102:0:1000:FirmwareRelease" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FirmwareRelease can0" )
  field( FLNK, "ISEG:5230102:0:1000:FirmwareName" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1000:FirmwareName" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FirmwareName can0" )
  field( FLNK, "ISEG:5230102:0:1000:Article" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1000:Article" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Article can0" )
  field( TSE,  "-2" )
}


##############################
# ### Module item values ### #
##############################

record( mbbiDirect, "ISEG:5230102:0:0:Status" ) {
  field( DESC, "Lower 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( DISV, "0" )  ## Disable Value (if value linked by SDIS == DISV record is disabled)
  field( SDIS, "ISEG:5230102:0:1000:PowerOn.VAL NPP MS" )
  field( INP,  "@0.0.Status can0" )
  field( FLNK, "ISEG:5230102:0:0:EventStatus" ) ## Build read out chains
  field( TSE,  "-2" )
  field( SCAN,  "1 second" )
}

record( mbbiDirect, "ISEG:5230102:0:0:EventStatus" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.EventStatus can0" )
  field( FLNK, "ISEG:5230102:0:0:EventMask" )
  field( TSE,  "-2" )
}
record( longout, "ISEG:5230102:0:0:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.EventMask can0" )
  field( FLNK, "ISEG:5230102:0:0:Temperature" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:0:Control:doClear" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.Control:6 can0" )
  field( ZNAM, "" )
  field( ONAM, "doClear" )
  field( TSE,  "-2" )
  alias( "ch0:doClear" )
}

record( bo, "ISEG:5230102:0:0:Control:setFineAdjustment" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.Control:12 can0" )
  field( ZNAM, "FineAdjustment off" )
  field( ONAM, "FineAdjustment on" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:0:Control:setKillEnable" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.Control:14 can0" )
  field( ZNAM, "KillEnable off" )
  field( ONAM, "KillEnable on" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:VoltageRampSpeed" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.VoltageRampSpeed can0" )
  field( FLNK, "ISEG:5230102:0:0:CurrentRampSpeed" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:CurrentRampSpeed" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.CurrentRampSpeed can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:0:VoltageLimit" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.VoltageLimit can0" )
  field( FLNK, "ISEG:5230102:0:0:CurrentLimit" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( ai, "ISEG:5230102:0:0:CurrentLimit" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.CurrentLimit can0" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( ai, "ISEG:5230102:0:0:Temperature" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.Temperature can0" )
  field( TSE,  "-2" )
  field( SCAN, "1 second")
}

record( longin, "ISEG:5230102:0:0:SerialNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.SerialNumber can0" )
  field( FLNK, "ISEG:5230102:0:0:ChannelNumber" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( longin, "ISEG:5230102:0:0:ChannelNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.ChannelNumber can0" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:0:SampleRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.SampleRate can0" )
  field( FLNK, "ISEG:5230102:0:0:DigitalFilter" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:0:DigitalFilter" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.DigitalFilter can0" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:0:FirmwareRelease" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.FirmwareRelease can0" )
  field( FLNK, "ISEG:5230102:0:0:FirmwareName" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:0:FirmwareName" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.FirmwareName can0" )
  field( FLNK, "ISEG:5230102:0:0:Article" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:0:Article" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.Article can0" )
  field( TSE,  "-2" )
}

#####################################
# ### Decoding of Module Status ### #
#####################################

record( bi, "ISEG:5230102:0:0:isAdjustment" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B0 can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:Status:isLiveInsertion" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B2 can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:needService" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B4 can0" )
  field( ZNAM, "ok" )
  field( ONAM, "Hardware failure detected" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:isInputError" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B6 CP can0" )
  field( ZNAM, "ok" )
  field( ONAM, "Error" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:0:isNoSumError" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B8 CP can0" )
  field( ZNAM, "Error" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isNoRamp" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B9 CP can0" )
  field( ZNAM, "channel is ramping" )
  field( ONAM, "all channels stable" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isSafetyLoopGood" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BA CP can0" )
  field( ZNAM, "broken" )
  field( ONAM, "closed" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "Passive" )
  alias( "ch0:isSafetyLoopGood" )  
}

record( bi, "ISEG:5230102:0:0:isEVentActive" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BB CP can0" )
  field( ZNAM, "no active Event" )
  field( ONAM, "any event active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isModuleGood" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BC CP can0" )
  field( ZNAM, "failure" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isSuppliesGodd" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BD CP can0" )
  field( ZNAM, "Out of Range" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isTemperatureGood" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BE CP can0" )
  field( ZNAM, "above 55 degC" )
  field( ONAM, "within range" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isKillEnable" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BF can0" )
  field( ZNAM, "disabled" )
  field( ONAM, "enabled" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

###########################################
# ### Decoding of Module Event Status ### #
###########################################
record( bi, "ISEG:5230102:0:0:EventLiveInsertion" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.B2 CP can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:EventService" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.B4 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Hardware failure detected" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:EventInputError" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.B6 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Input Error in connection" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:EventSafetyLoopNotGood" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.BA CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Safety loop open" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
  alias( "ch0:EventSafetyLoopNotGood" )
}

record( bi, "ISEG:5230102:0:0:EventSuppliesNotGood" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.BD CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Supply is not good" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:EventTemperatureNotGood" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.BD CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Temperature above 55 degC" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

###############################
# ### Channel item values ### #
###############################

record( ao, "ISEG:5230102:0:0:0:VoltageSet" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.0.VoltageSet can0" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" )
  alias( "ch0:VoltageSet" )
}

record( ao, "ISEG:5230102:0:0:0:CurrentSet" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.0.CurrentSet can0" )
  field( TSE,  "-2" )
  field( PREC, "6" )
  field( SCAN, "1 second" )
  field( VAL, ".001")
  field( PINI, "YES")
  alias( "ch0:CurrentSet" )
}

record( ai, "ISEG:5230102:0:0:0:VoltageMeasure" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.0.VoltageMeasure can0" )
  field( FLNK, "ISEG:5230102:0:0:0:CurrentMeasure" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" )
  alias( "ch0:VoltageMeasure" )
}

record( ai, "ISEG:5230102:0:0:0:CurrentMeasure" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.0.CurrentMeasure can0" )
  field( FLNK, "ISEG:5230102:0:0:0:Status" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" ) 
  alias( "ch0:CurrentMeasure" )
}

record( ao, "ISEG:5230102:0:0:0:VoltageBounds" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.0.VoltageBounds can0" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:0:CurrentBounds" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.0.CurrentBounds can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:0:0:VoltageNominal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.0.VoltageNominal can0" )
  field( FLNK, "ISEG:5230102:0:0:0:CurrentNominal" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:0:0:CurrentNominal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.0.CurrentNominal can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:0:0:TemperatureExternal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.0.TemperatureExternal can0" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:0:VctCoefficient" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.0.VctCoefficient can0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:0:0:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.0.Status can0" )
  field( FLNK, "ISEG:5230102:0:0:0:EventStatus" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:0:0:Control:setOn" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.0.Control:3 can0" )
  field( ZNAM, "Channel off" )
  field( ONAM, "Channel on" )
  field( TSE,  "-2" )
  alias( "ch0:setOn" )
}

record( bo, "ISEG:5230102:0:0:0:Control:setEmergency" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.0.Control:5 can0" )
  field( ZNAM, "" )
  field( ONAM, "Set EMCY" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:0:0:EventStatus" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.0.EventStatus can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:0:0:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.0.EventMask can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:0:0:DelayedTripAction" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.0.DelayedTripAction can0" )
  field( FLNK, "ISEG:5230102:0:0:0:DelayedTripTime" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:0:DelayedTripTime" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.0.DelayedTripTime can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:0:0:ExternalInhibitAction" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.0.ExternalInhibitAction can0" )
  field( TSE,  "-2" )
}

######################################
# ### Decoding of Channel Status ### #
######################################
record( bi, "ISEG:5230102:0:0:0:InputError" ) {
  field( INP,  "ISEG:5230102:0:0:0:Status.B2 CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Input Error" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:0:0:isOn" ) {
  field( INP,  "ISEG:5230102:0:0:0:Status.B3 CP can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "1 second" )
  alias( "ch0:isOn" ) 
}

record( bi, "ISEG:5230102:0:0:0:isVoltageRamp" ) {
  field( INP,  "ISEG:5230102:0:0:0:Status.B4 CP can0" )
  field( ZNAM, "stable" )
  field( ONAM, "ramping" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:0:isEmergency" ) {
  field( INP,  "ISEG:5230102:0:0:0:Status.B5 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:0:isCC" ) {
  field( INP,  "ISEG:5230102:0:0:0:Status.B6 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
  field( SCAN,  "1 second" )
}

record( bi, "ISEG:5230102:0:0:0:isCV" ) {
  field( INP,  "ISEG:5230102:0:0:0:Status.B7 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "1 second" )
}

record( bi, "ISEG:5230102:0:0:0:isCurrentBound" ) {
  field( INP,  "ISEG:5230102:0:0:0:Status.BA CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Out of bounds" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:0:isVoltageBound" ) {
  field( INP,  "ISEG:5230102:0:0:0:Status.BB CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Out of bounds" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:0:isEventInhibit" ) {
  field( INP,  "ISEG:5230102:0:0:0:Status.BC CP can0" )
  field( ZNAM, "no" )
  field( ONAM, "yes" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:0:isTrip" ) {
  field( INP,  "ISEG:5230102:0:0:0:Status.BD CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "tripped" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:0:isCurrentLimit" ) {
  field( INP,  "ISEG:5230102:0:0:0:Status.BE CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "exceeded" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:0:isVoltageLimit" ) {
  field( INP,  "ISEG:5230102:0:0:0:Status.BF CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "exceeded" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

############################################
# ### Decoding of Channel Event Status ### #
############################################
record( bi, "ISEG:5230102:0:0:0:EventInputError" ) {
  field( INP,  "ISEG:5230102:0:0:0:EventStatus.B2 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:0:0:EOn2Off" ) {
  field( INP,  "ISEG:5230102:0:0:0:EventStatus.B3 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:0:EventEndOfRamp" ) {
  field( INP,  "ISEG:5230102:0:0:0:EventStatus.B4 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:0:EventEmergency" ) {
  field( INP,  "ISEG:5230102:0:0:0:EventStatus.B5 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:0:ECC" ) {
  field( INP,  "ISEG:5230102:0:0:0:EventStatus.B6 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:0:ECV" ) {
  field( INP,  "ISEG:5230102:0:0:0:EventStatus.B7 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:0:ECurrentBounds" ) {
  field( INP,  "ISEG:5230102:0:0:0:EventStatus.BA CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:0:EVVoltageBounds" ) {
  field( INP,  "ISEG:5230102:0:0:0:EventStatus.BB CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:0:EventExternalInhibit" ) {
  field( INP,  "ISEG:5230102:0:0:0:EventStatus.BC CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:0:EventTrip" ) {
  field( INP,  "ISEG:5230102:0:0:0:EventStatus.BD CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:0:EventCurrentLimit" ) {
  field( INP,  "ISEG:5230102:0:0:0:EventStatus.BE CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:0:EventVoltageLimit" ) {
  field( INP,  "ISEG:5230102:0:0:0:EventStatus.BF CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

#######################################################################
# ###                                                             ### #
# ### EPICS Database for                                          ### #
# ###   iseg HAL                                                  ### #
# ###                                                             ### #
# ### author: J. Roemer, F.Feldbauer                              ### #
# ###                                                             ### #
# ###                                                             ### #
# ### macros: CONTROLLER_SN    serial number of crate controller  ### #
# ###         CAN_LINE    CAN line ID                             ### #
# ###         CRATE_ID    crate address                           ### #
# ###         MODULE_ID   module address                          ### #
# ###         CHANNEL_ID  HV channel address                      ### #
#######################################################################
# ###    Modified: 8-21-2018 PR     ### #
# ###    Fixes interlock PVs           ### #
# ###    1 Alias           	            ### #
#test
#######################################################################

###############################
# ### CAN_System item values ##
###############################

record( stringin, "ISEG:5230102:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@Status can0" )	
  field( FLNK, "ISEG:5230102:BitRate" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:BitRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@BitRate can0" )
  field( TSE,  "-2" )
}	

record( longin, "ISEG:5230102:ModuleNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@ModuleNumber can0" )
  field( FLNK, "ISEG:5230102:CrateNumber" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:CrateNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CrateNumber can0" )
  field( FLNK, "ISEG:5230102:CrateList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:CrateList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CrateList can0" )
  field( FLNK, "ISEG:5230102:CycleCounter" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:CycleCounter" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CycleCounter can0" )
  field( TSE,  "-2" )
}

#############################
# ### CAN_Line item values ##
#############################

record( stringin, "ISEG:5230102:0:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.Status can0" )
  field( FLNK, "ISEG:5230102:0:BitRate" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:BitRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.BitRate can0" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:ModuleNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.ModuleNumber can0" )
  field( FLNK, "ISEG:5230102:0:ModuleList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:ModuleList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.ModuleList can0" )
  field( FLNK, "ISEG:5230102:0:CrateNumber" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:CrateNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.CrateNumber can0" )
  field( FLNK, "ISEG:5230102:0:CrateList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:CrateList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.CrateList can0" )
  field( TSE,  "-2" )
}

#############################
# ### Crate item values ### #
#############################

record( mbbiDirect, "ISEG:5230102:0:1000:StatusLow" ) {
  field( DESC, "Lower 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Status can0" )
  field( NOBT, "16" )
  field( SHFT, "0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1000:StatusHigh" ) {
  field( DESC, "Upper 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Status can0" )
  field( NOBT, "16" )
  field( SHFT, "16" )  ## shift the value by 16 bits to the right
  field( TSE,  "-2" )
}

# Alternative way to read out the status:
# In this case only the calc record needs to be triggered

#record( longin, "ISEG:5230102:0:1000:StatusRead__" ) {
#  field( DTYP, "isegHAL" )
#  field( INP,  "@0.1000.Status can0" )
#}
#record( calc, "ISEG:5230102:0:1000:StatusSplit__" ) {
#  ## PP = Passive Process: Force the other record to process before sending the value
#  field( INPA, "ISEG:5230102:0:1000:StatusRead PP" )
#
#  field( INPB, "0x0000ffff" )
#  field( INPC, "0xffff0000" )
#
#  ## First, set field D to ( field A bitwise AND field B ),
#  ## then set field VAL to ( field A bitwise AND field C ) right shifted by 16 bit
#  field( CALC, "d:=(A&B); (A&C)>>16" )
#}
#record( mbbiDirect, "ISEG:5230102:0:1000:StatusLow" ) {
#  field( DTYP, "Soft Channel" )
#  field( INP,  "ISEG:5230102:0:1000:StatusSplit__.D CP" )
#}
#record( mbbiDirect, "ISEG:5230102:0:1000:StatusHigh" ) {
#  field( DTYP, "Soft Channel" )
#  field( INP,  "ISEG:5230102:0:1000:StatusSplit__.VAL CP" )
#}

record( mbbiDirect, "ISEG:5230102:0:1000:EventStatusLow" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.EventStatus can0" )
  field( NOBT, "16" )
  field( SHFT, "0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1000:EventStatusHigh" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.EventStatus can0" )
  field( NOBT, "16" )
  field( SHFT, "16" )
  field( TSE,  "-2" )
}
record( longout, "ISEG:5230102:0:1000:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.EventMask can0" )
  field( TSE,  "-2" )
}
record( ai, "ISEG:5230102:0:1000:FanSpeed" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FanSpeed can0" )
  field( TSE,  "-2" )
  field( SCAN, "1 second")
}

record( bo, "ISEG:5230102:0:1000:Control:0" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.Control:0 can0" )
  field( ZNAM, "" )
  field( ONAM, "doClear" )
  field( TSE,  "-2" )
}


record( longin, "ISEG:5230102:0:1000:SerialNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.SerialNumber can0" )
  field( TSE,  "-2" )
  field( SCAN,  "1 second" )
}

record( bo, "ISEG:5230102:0:1000:PowerOn" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.PowerOn can0" )
  field( TSE,  "-2" )
  field( ZNAM, "Off" )
  field( ONAM, "On" )
}

record( stringin, "ISEG:5230102:0:1000:FirmwareRelease" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FirmwareRelease can0" )
  field( FLNK, "ISEG:5230102:0:1000:FirmwareName" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1000:FirmwareName" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FirmwareName can0" )
  field( FLNK, "ISEG:5230102:0:1000:Article" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1000:Article" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Article can0" )
  field( TSE,  "-2" )
}


##############################
# ### Module item values ### #
##############################

record( mbbiDirect, "ISEG:5230102:0:0:Status" ) {
  field( DESC, "Lower 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( DISV, "0" )  ## Disable Value (if value linked by SDIS == DISV record is disabled)
  field( SDIS, "ISEG:5230102:0:1000:PowerOn.VAL NPP MS" )
  field( INP,  "@0.0.Status can0" )
  field( FLNK, "ISEG:5230102:0:0:EventStatus" ) ## Build read out chains
  field( TSE,  "-2" )
  field( SCAN,  "1 second" )
}

record( mbbiDirect, "ISEG:5230102:0:0:EventStatus" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.EventStatus can0" )
  field( FLNK, "ISEG:5230102:0:0:EventMask" )
  field( TSE,  "-2" )
}
record( longout, "ISEG:5230102:0:0:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.EventMask can0" )
  field( FLNK, "ISEG:5230102:0:0:Temperature" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:0:Control:doClear" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.Control:6 can0" )
  field( ZNAM, "" )
  field( ONAM, "doClear" )
  field( TSE,  "-2" )
  alias( "ch1:doClear" )
}

record( bo, "ISEG:5230102:0:0:Control:setFineAdjustment" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.Control:12 can0" )
  field( ZNAM, "FineAdjustment off" )
  field( ONAM, "FineAdjustment on" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:0:Control:setKillEnable" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.Control:14 can0" )
  field( ZNAM, "KillEnable off" )
  field( ONAM, "KillEnable on" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:VoltageRampSpeed" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.VoltageRampSpeed can0" )
  field( FLNK, "ISEG:5230102:0:0:CurrentRampSpeed" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:CurrentRampSpeed" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.CurrentRampSpeed can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:0:VoltageLimit" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.VoltageLimit can0" )
  field( FLNK, "ISEG:5230102:0:0:CurrentLimit" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( ai, "ISEG:5230102:0:0:CurrentLimit" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.CurrentLimit can0" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( ai, "ISEG:5230102:0:0:Temperature" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.Temperature can0" )
  field( TSE,  "-2" )
  field( SCAN, "1 second")
}

record( longin, "ISEG:5230102:0:0:SerialNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.SerialNumber can0" )
  field( FLNK, "ISEG:5230102:0:0:ChannelNumber" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( longin, "ISEG:5230102:0:0:ChannelNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.ChannelNumber can0" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:0:SampleRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.SampleRate can0" )
  field( FLNK, "ISEG:5230102:0:0:DigitalFilter" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:0:DigitalFilter" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.DigitalFilter can0" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:0:FirmwareRelease" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.FirmwareRelease can0" )
  field( FLNK, "ISEG:5230102:0:0:FirmwareName" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:0:FirmwareName" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.FirmwareName can0" )
  field( FLNK, "ISEG:5230102:0:0:Article" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:0:Article" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.Article can0" )
  field( TSE,  "-2" )
}

#####################################
# ### Decoding of Module Status ### #
#####################################

record( bi, "ISEG:5230102:0:0:isAdjustment" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B0 can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:Status:isLiveInsertion" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B2 can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:needService" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B4 can0" )
  field( ZNAM, "ok" )
  field( ONAM, "Hardware failure detected" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:isInputError" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B6 CP can0" )
  field( ZNAM, "ok" )
  field( ONAM, "Error" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:0:isNoSumError" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B8 CP can0" )
  field( ZNAM, "Error" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isNoRamp" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B9 CP can0" )
  field( ZNAM, "channel is ramping" )
  field( ONAM, "all channels stable" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isSafetyLoopGood" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BA CP can0" )
  field( ZNAM, "broken" )
  field( ONAM, "closed" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "Passive" )
  alias( "ch1:isSafetyLoopGood" )  
}

record( bi, "ISEG:5230102:0:0:isEVentActive" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BB CP can0" )
  field( ZNAM, "no active Event" )
  field( ONAM, "any event active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isModuleGood" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BC CP can0" )
  field( ZNAM, "failure" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isSuppliesGodd" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BD CP can0" )
  field( ZNAM, "Out of Range" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isTemperatureGood" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BE CP can0" )
  field( ZNAM, "above 55 degC" )
  field( ONAM, "within range" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isKillEnable" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BF can0" )
  field( ZNAM, "disabled" )
  field( ONAM, "enabled" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

###########################################
# ### Decoding of Module Event Status ### #
###########################################
record( bi, "ISEG:5230102:0:0:EventLiveInsertion" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.B2 CP can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:EventService" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.B4 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Hardware failure detected" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:EventInputError" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.B6 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Input Error in connection" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:EventSafetyLoopNotGood" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.BA CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Safety loop open" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
  alias( "ch1:EventSafetyLoopNotGood" )
}

record( bi, "ISEG:5230102:0:0:EventSuppliesNotGood" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.BD CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Supply is not good" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:EventTemperatureNotGood" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.BD CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Temperature above 55 degC" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

###############################
# ### Channel item values ### #
###############################

record( ao, "ISEG:5230102:0:0:1:VoltageSet" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.1.VoltageSet can0" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" )
  alias( "ch1:VoltageSet" )
}

record( ao, "ISEG:5230102:0:0:1:CurrentSet" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.1.CurrentSet can0" )
  field( TSE,  "-2" )
  field( PREC, "6" )
  field( SCAN, "1 second" )
  field( VAL, ".001")
  field( PINI, "YES")
  alias( "ch1:CurrentSet" )
}

record( ai, "ISEG:5230102:0:0:1:VoltageMeasure" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.1.VoltageMeasure can0" )
  field( FLNK, "ISEG:5230102:0:0:1:CurrentMeasure" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" )
  alias( "ch1:VoltageMeasure" )
}

record( ai, "ISEG:5230102:0:0:1:CurrentMeasure" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.1.CurrentMeasure can0" )
  field( FLNK, "ISEG:5230102:0:0:1:Status" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" ) 
  alias( "ch1:CurrentMeasure" )
}

record( ao, "ISEG:5230102:0:0:1:VoltageBounds" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.1.VoltageBounds can0" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:1:CurrentBounds" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.1.CurrentBounds can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:0:1:VoltageNominal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.1.VoltageNominal can0" )
  field( FLNK, "ISEG:5230102:0:0:1:CurrentNominal" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:0:1:CurrentNominal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.1.CurrentNominal can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:0:1:TemperatureExternal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.1.TemperatureExternal can0" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:1:VctCoefficient" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.1.VctCoefficient can0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:0:1:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.1.Status can0" )
  field( FLNK, "ISEG:5230102:0:0:1:EventStatus" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:0:1:Control:setOn" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.1.Control:3 can0" )
  field( ZNAM, "Channel off" )
  field( ONAM, "Channel on" )
  field( TSE,  "-2" )
  alias( "ch1:setOn" )
}

record( bo, "ISEG:5230102:0:0:1:Control:setEmergency" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.1.Control:5 can0" )
  field( ZNAM, "" )
  field( ONAM, "Set EMCY" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:0:1:EventStatus" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.1.EventStatus can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:0:1:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.1.EventMask can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:0:1:DelayedTripAction" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.1.DelayedTripAction can0" )
  field( FLNK, "ISEG:5230102:0:0:1:DelayedTripTime" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:1:DelayedTripTime" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.1.DelayedTripTime can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:0:1:ExternalInhibitAction" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.1.ExternalInhibitAction can0" )
  field( TSE,  "-2" )
}

######################################
# ### Decoding of Channel Status ### #
######################################
record( bi, "ISEG:5230102:0:0:1:InputError" ) {
  field( INP,  "ISEG:5230102:0:0:1:Status.B2 CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Input Error" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:0:1:isOn" ) {
  field( INP,  "ISEG:5230102:0:0:1:Status.B3 CP can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "1 second" )
  alias( "ch1:isOn" ) 
}

record( bi, "ISEG:5230102:0:0:1:isVoltageRamp" ) {
  field( INP,  "ISEG:5230102:0:0:1:Status.B4 CP can0" )
  field( ZNAM, "stable" )
  field( ONAM, "ramping" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:1:isEmergency" ) {
  field( INP,  "ISEG:5230102:0:0:1:Status.B5 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:1:isCC" ) {
  field( INP,  "ISEG:5230102:0:0:1:Status.B6 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
  field( SCAN,  "1 second" )
}

record( bi, "ISEG:5230102:0:0:1:isCV" ) {
  field( INP,  "ISEG:5230102:0:0:1:Status.B7 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "1 second" )
}

record( bi, "ISEG:5230102:0:0:1:isCurrentBound" ) {
  field( INP,  "ISEG:5230102:0:0:1:Status.BA CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Out of bounds" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:1:isVoltageBound" ) {
  field( INP,  "ISEG:5230102:0:0:1:Status.BB CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Out of bounds" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:1:isEventInhibit" ) {
  field( INP,  "ISEG:5230102:0:0:1:Status.BC CP can0" )
  field( ZNAM, "no" )
  field( ONAM, "yes" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:1:isTrip" ) {
  field( INP,  "ISEG:5230102:0:0:1:Status.BD CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "tripped" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:1:isCurrentLimit" ) {
  field( INP,  "ISEG:5230102:0:0:1:Status.BE CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "exceeded" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:1:isVoltageLimit" ) {
  field( INP,  "ISEG:5230102:0:0:1:Status.BF CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "exceeded" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

############################################
# ### Decoding of Channel Event Status ### #
############################################
record( bi, "ISEG:5230102:0:0:1:EventInputError" ) {
  field( INP,  "ISEG:5230102:0:0:1:EventStatus.B2 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:0:1:EOn2Off" ) {
  field( INP,  "ISEG:5230102:0:0:1:EventStatus.B3 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:1:EventEndOfRamp" ) {
  field( INP,  "ISEG:5230102:0:0:1:EventStatus.B4 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:1:EventEmergency" ) {
  field( INP,  "ISEG:5230102:0:0:1:EventStatus.B5 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:1:ECC" ) {
  field( INP,  "ISEG:5230102:0:0:1:EventStatus.B6 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:1:ECV" ) {
  field( INP,  "ISEG:5230102:0:0:1:EventStatus.B7 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:1:ECurrentBounds" ) {
  field( INP,  "ISEG:5230102:0:0:1:EventStatus.BA CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:1:EVVoltageBounds" ) {
  field( INP,  "ISEG:5230102:0:0:1:EventStatus.BB CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:1:EventExternalInhibit" ) {
  field( INP,  "ISEG:5230102:0:0:1:EventStatus.BC CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:1:EventTrip" ) {
  field( INP,  "ISEG:5230102:0:0:1:EventStatus.BD CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:1:EventCurrentLimit" ) {
  field( INP,  "ISEG:5230102:0:0:1:EventStatus.BE CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:1:EventVoltageLimit" ) {
  field( INP,  "ISEG:5230102:0:0:1:EventStatus.BF CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

#######################################################################
# ###                                                             ### #
# ### EPICS Database for                                          ### #
# ###   iseg HAL                                                  ### #
# ###                                                             ### #
# ### author: J. Roemer, F.Feldbauer                              ### #
# ###                                                             ### #
# ###                                                             ### #
# ### macros: CONTROLLER_SN    serial number of crate controller  ### #
# ###         CAN_LINE    CAN line ID                             ### #
# ###         CRATE_ID    crate address                           ### #
# ###         MODULE_ID   module address                          ### #
# ###         CHANNEL_ID  HV channel address                      ### #
#######################################################################
# ###    Modified: 8-21-2018 PR     ### #
# ###    Fixes interlock PVs           ### #
# ###    1 Alias           	            ### #
#test
#######################################################################

###############################
# ### CAN_System item values ##
###############################

record( stringin, "ISEG:5230102:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@Status can0" )	
  field( FLNK, "ISEG:5230102:BitRate" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:BitRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@BitRate can0" )
  field( TSE,  "-2" )
}	

record( longin, "ISEG:5230102:ModuleNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@ModuleNumber can0" )
  field( FLNK, "ISEG:5230102:CrateNumber" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:CrateNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CrateNumber can0" )
  field( FLNK, "ISEG:5230102:CrateList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:CrateList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CrateList can0" )
  field( FLNK, "ISEG:5230102:CycleCounter" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:CycleCounter" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CycleCounter can0" )
  field( TSE,  "-2" )
}

#############################
# ### CAN_Line item values ##
#############################

record( stringin, "ISEG:5230102:0:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.Status can0" )
  field( FLNK, "ISEG:5230102:0:BitRate" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:BitRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.BitRate can0" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:ModuleNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.ModuleNumber can0" )
  field( FLNK, "ISEG:5230102:0:ModuleList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:ModuleList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.ModuleList can0" )
  field( FLNK, "ISEG:5230102:0:CrateNumber" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:CrateNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.CrateNumber can0" )
  field( FLNK, "ISEG:5230102:0:CrateList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:CrateList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.CrateList can0" )
  field( TSE,  "-2" )
}

#############################
# ### Crate item values ### #
#############################

record( mbbiDirect, "ISEG:5230102:0:1000:StatusLow" ) {
  field( DESC, "Lower 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Status can0" )
  field( NOBT, "16" )
  field( SHFT, "0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1000:StatusHigh" ) {
  field( DESC, "Upper 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Status can0" )
  field( NOBT, "16" )
  field( SHFT, "16" )  ## shift the value by 16 bits to the right
  field( TSE,  "-2" )
}

# Alternative way to read out the status:
# In this case only the calc record needs to be triggered

#record( longin, "ISEG:5230102:0:1000:StatusRead__" ) {
#  field( DTYP, "isegHAL" )
#  field( INP,  "@0.1000.Status can0" )
#}
#record( calc, "ISEG:5230102:0:1000:StatusSplit__" ) {
#  ## PP = Passive Process: Force the other record to process before sending the value
#  field( INPA, "ISEG:5230102:0:1000:StatusRead PP" )
#
#  field( INPB, "0x0000ffff" )
#  field( INPC, "0xffff0000" )
#
#  ## First, set field D to ( field A bitwise AND field B ),
#  ## then set field VAL to ( field A bitwise AND field C ) right shifted by 16 bit
#  field( CALC, "d:=(A&B); (A&C)>>16" )
#}
#record( mbbiDirect, "ISEG:5230102:0:1000:StatusLow" ) {
#  field( DTYP, "Soft Channel" )
#  field( INP,  "ISEG:5230102:0:1000:StatusSplit__.D CP" )
#}
#record( mbbiDirect, "ISEG:5230102:0:1000:StatusHigh" ) {
#  field( DTYP, "Soft Channel" )
#  field( INP,  "ISEG:5230102:0:1000:StatusSplit__.VAL CP" )
#}

record( mbbiDirect, "ISEG:5230102:0:1000:EventStatusLow" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.EventStatus can0" )
  field( NOBT, "16" )
  field( SHFT, "0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1000:EventStatusHigh" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.EventStatus can0" )
  field( NOBT, "16" )
  field( SHFT, "16" )
  field( TSE,  "-2" )
}
record( longout, "ISEG:5230102:0:1000:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.EventMask can0" )
  field( TSE,  "-2" )
}
record( ai, "ISEG:5230102:0:1000:FanSpeed" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FanSpeed can0" )
  field( TSE,  "-2" )
  field( SCAN, "1 second")
}

record( bo, "ISEG:5230102:0:1000:Control:0" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.Control:0 can0" )
  field( ZNAM, "" )
  field( ONAM, "doClear" )
  field( TSE,  "-2" )
}


record( longin, "ISEG:5230102:0:1000:SerialNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.SerialNumber can0" )
  field( TSE,  "-2" )
  field( SCAN,  "1 second" )
}

record( bo, "ISEG:5230102:0:1000:PowerOn" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.PowerOn can0" )
  field( TSE,  "-2" )
  field( ZNAM, "Off" )
  field( ONAM, "On" )
}

record( stringin, "ISEG:5230102:0:1000:FirmwareRelease" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FirmwareRelease can0" )
  field( FLNK, "ISEG:5230102:0:1000:FirmwareName" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1000:FirmwareName" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FirmwareName can0" )
  field( FLNK, "ISEG:5230102:0:1000:Article" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1000:Article" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Article can0" )
  field( TSE,  "-2" )
}


##############################
# ### Module item values ### #
##############################

record( mbbiDirect, "ISEG:5230102:0:0:Status" ) {
  field( DESC, "Lower 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( DISV, "0" )  ## Disable Value (if value linked by SDIS == DISV record is disabled)
  field( SDIS, "ISEG:5230102:0:1000:PowerOn.VAL NPP MS" )
  field( INP,  "@0.0.Status can0" )
  field( FLNK, "ISEG:5230102:0:0:EventStatus" ) ## Build read out chains
  field( TSE,  "-2" )
  field( SCAN,  "1 second" )
}

record( mbbiDirect, "ISEG:5230102:0:0:EventStatus" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.EventStatus can0" )
  field( FLNK, "ISEG:5230102:0:0:EventMask" )
  field( TSE,  "-2" )
}
record( longout, "ISEG:5230102:0:0:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.EventMask can0" )
  field( FLNK, "ISEG:5230102:0:0:Temperature" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:0:Control:doClear" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.Control:6 can0" )
  field( ZNAM, "" )
  field( ONAM, "doClear" )
  field( TSE,  "-2" )
  alias( "ch2:doClear" )
}

record( bo, "ISEG:5230102:0:0:Control:setFineAdjustment" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.Control:12 can0" )
  field( ZNAM, "FineAdjustment off" )
  field( ONAM, "FineAdjustment on" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:0:Control:setKillEnable" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.Control:14 can0" )
  field( ZNAM, "KillEnable off" )
  field( ONAM, "KillEnable on" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:VoltageRampSpeed" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.VoltageRampSpeed can0" )
  field( FLNK, "ISEG:5230102:0:0:CurrentRampSpeed" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:CurrentRampSpeed" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.CurrentRampSpeed can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:0:VoltageLimit" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.VoltageLimit can0" )
  field( FLNK, "ISEG:5230102:0:0:CurrentLimit" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( ai, "ISEG:5230102:0:0:CurrentLimit" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.CurrentLimit can0" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( ai, "ISEG:5230102:0:0:Temperature" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.Temperature can0" )
  field( TSE,  "-2" )
  field( SCAN, "1 second")
}

record( longin, "ISEG:5230102:0:0:SerialNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.SerialNumber can0" )
  field( FLNK, "ISEG:5230102:0:0:ChannelNumber" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( longin, "ISEG:5230102:0:0:ChannelNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.ChannelNumber can0" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:0:SampleRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.SampleRate can0" )
  field( FLNK, "ISEG:5230102:0:0:DigitalFilter" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:0:DigitalFilter" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.DigitalFilter can0" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:0:FirmwareRelease" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.FirmwareRelease can0" )
  field( FLNK, "ISEG:5230102:0:0:FirmwareName" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:0:FirmwareName" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.FirmwareName can0" )
  field( FLNK, "ISEG:5230102:0:0:Article" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:0:Article" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.Article can0" )
  field( TSE,  "-2" )
}

#####################################
# ### Decoding of Module Status ### #
#####################################

record( bi, "ISEG:5230102:0:0:isAdjustment" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B0 can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:Status:isLiveInsertion" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B2 can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:needService" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B4 can0" )
  field( ZNAM, "ok" )
  field( ONAM, "Hardware failure detected" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:isInputError" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B6 CP can0" )
  field( ZNAM, "ok" )
  field( ONAM, "Error" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:0:isNoSumError" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B8 CP can0" )
  field( ZNAM, "Error" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isNoRamp" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B9 CP can0" )
  field( ZNAM, "channel is ramping" )
  field( ONAM, "all channels stable" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isSafetyLoopGood" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BA CP can0" )
  field( ZNAM, "broken" )
  field( ONAM, "closed" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "Passive" )
  alias( "ch2:isSafetyLoopGood" )  
}

record( bi, "ISEG:5230102:0:0:isEVentActive" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BB CP can0" )
  field( ZNAM, "no active Event" )
  field( ONAM, "any event active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isModuleGood" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BC CP can0" )
  field( ZNAM, "failure" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isSuppliesGodd" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BD CP can0" )
  field( ZNAM, "Out of Range" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isTemperatureGood" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BE CP can0" )
  field( ZNAM, "above 55 degC" )
  field( ONAM, "within range" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isKillEnable" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BF can0" )
  field( ZNAM, "disabled" )
  field( ONAM, "enabled" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

###########################################
# ### Decoding of Module Event Status ### #
###########################################
record( bi, "ISEG:5230102:0:0:EventLiveInsertion" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.B2 CP can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:EventService" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.B4 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Hardware failure detected" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:EventInputError" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.B6 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Input Error in connection" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:EventSafetyLoopNotGood" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.BA CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Safety loop open" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
  alias( "ch2:EventSafetyLoopNotGood" )
}

record( bi, "ISEG:5230102:0:0:EventSuppliesNotGood" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.BD CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Supply is not good" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:EventTemperatureNotGood" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.BD CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Temperature above 55 degC" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

###############################
# ### Channel item values ### #
###############################

record( ao, "ISEG:5230102:0:0:2:VoltageSet" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.2.VoltageSet can0" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" )
  alias( "ch2:VoltageSet" )
}

record( ao, "ISEG:5230102:0:0:2:CurrentSet" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.2.CurrentSet can0" )
  field( TSE,  "-2" )
  field( PREC, "6" )
  field( SCAN, "1 second" )
  field( VAL, ".001")
  field( PINI, "YES")
  alias( "ch2:CurrentSet" )
}

record( ai, "ISEG:5230102:0:0:2:VoltageMeasure" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.2.VoltageMeasure can0" )
  field( FLNK, "ISEG:5230102:0:0:2:CurrentMeasure" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" )
  alias( "ch2:VoltageMeasure" )
}

record( ai, "ISEG:5230102:0:0:2:CurrentMeasure" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.2.CurrentMeasure can0" )
  field( FLNK, "ISEG:5230102:0:0:2:Status" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" ) 
  alias( "ch2:CurrentMeasure" )
}

record( ao, "ISEG:5230102:0:0:2:VoltageBounds" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.2.VoltageBounds can0" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:2:CurrentBounds" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.2.CurrentBounds can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:0:2:VoltageNominal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.2.VoltageNominal can0" )
  field( FLNK, "ISEG:5230102:0:0:2:CurrentNominal" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:0:2:CurrentNominal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.2.CurrentNominal can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:0:2:TemperatureExternal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.2.TemperatureExternal can0" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:2:VctCoefficient" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.2.VctCoefficient can0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:0:2:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.2.Status can0" )
  field( FLNK, "ISEG:5230102:0:0:2:EventStatus" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:0:2:Control:setOn" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.2.Control:3 can0" )
  field( ZNAM, "Channel off" )
  field( ONAM, "Channel on" )
  field( TSE,  "-2" )
  alias( "ch2:setOn" )
}

record( bo, "ISEG:5230102:0:0:2:Control:setEmergency" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.2.Control:5 can0" )
  field( ZNAM, "" )
  field( ONAM, "Set EMCY" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:0:2:EventStatus" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.2.EventStatus can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:0:2:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.2.EventMask can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:0:2:DelayedTripAction" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.2.DelayedTripAction can0" )
  field( FLNK, "ISEG:5230102:0:0:2:DelayedTripTime" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:2:DelayedTripTime" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.2.DelayedTripTime can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:0:2:ExternalInhibitAction" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.2.ExternalInhibitAction can0" )
  field( TSE,  "-2" )
}

######################################
# ### Decoding of Channel Status ### #
######################################
record( bi, "ISEG:5230102:0:0:2:InputError" ) {
  field( INP,  "ISEG:5230102:0:0:2:Status.B2 CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Input Error" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:0:2:isOn" ) {
  field( INP,  "ISEG:5230102:0:0:2:Status.B3 CP can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "1 second" )
  alias( "ch2:isOn" ) 
}

record( bi, "ISEG:5230102:0:0:2:isVoltageRamp" ) {
  field( INP,  "ISEG:5230102:0:0:2:Status.B4 CP can0" )
  field( ZNAM, "stable" )
  field( ONAM, "ramping" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:2:isEmergency" ) {
  field( INP,  "ISEG:5230102:0:0:2:Status.B5 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:2:isCC" ) {
  field( INP,  "ISEG:5230102:0:0:2:Status.B6 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
  field( SCAN,  "1 second" )
}

record( bi, "ISEG:5230102:0:0:2:isCV" ) {
  field( INP,  "ISEG:5230102:0:0:2:Status.B7 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "1 second" )
}

record( bi, "ISEG:5230102:0:0:2:isCurrentBound" ) {
  field( INP,  "ISEG:5230102:0:0:2:Status.BA CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Out of bounds" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:2:isVoltageBound" ) {
  field( INP,  "ISEG:5230102:0:0:2:Status.BB CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Out of bounds" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:2:isEventInhibit" ) {
  field( INP,  "ISEG:5230102:0:0:2:Status.BC CP can0" )
  field( ZNAM, "no" )
  field( ONAM, "yes" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:2:isTrip" ) {
  field( INP,  "ISEG:5230102:0:0:2:Status.BD CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "tripped" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:2:isCurrentLimit" ) {
  field( INP,  "ISEG:5230102:0:0:2:Status.BE CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "exceeded" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:2:isVoltageLimit" ) {
  field( INP,  "ISEG:5230102:0:0:2:Status.BF CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "exceeded" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

############################################
# ### Decoding of Channel Event Status ### #
############################################
record( bi, "ISEG:5230102:0:0:2:EventInputError" ) {
  field( INP,  "ISEG:5230102:0:0:2:EventStatus.B2 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:0:2:EOn2Off" ) {
  field( INP,  "ISEG:5230102:0:0:2:EventStatus.B3 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:2:EventEndOfRamp" ) {
  field( INP,  "ISEG:5230102:0:0:2:EventStatus.B4 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:2:EventEmergency" ) {
  field( INP,  "ISEG:5230102:0:0:2:EventStatus.B5 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:2:ECC" ) {
  field( INP,  "ISEG:5230102:0:0:2:EventStatus.B6 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:2:ECV" ) {
  field( INP,  "ISEG:5230102:0:0:2:EventStatus.B7 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:2:ECurrentBounds" ) {
  field( INP,  "ISEG:5230102:0:0:2:EventStatus.BA CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:2:EVVoltageBounds" ) {
  field( INP,  "ISEG:5230102:0:0:2:EventStatus.BB CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:2:EventExternalInhibit" ) {
  field( INP,  "ISEG:5230102:0:0:2:EventStatus.BC CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:2:EventTrip" ) {
  field( INP,  "ISEG:5230102:0:0:2:EventStatus.BD CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:2:EventCurrentLimit" ) {
  field( INP,  "ISEG:5230102:0:0:2:EventStatus.BE CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:2:EventVoltageLimit" ) {
  field( INP,  "ISEG:5230102:0:0:2:EventStatus.BF CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

#######################################################################
# ###                                                             ### #
# ### EPICS Database for                                          ### #
# ###   iseg HAL                                                  ### #
# ###                                                             ### #
# ### author: J. Roemer, F.Feldbauer                              ### #
# ###                                                             ### #
# ###                                                             ### #
# ### macros: CONTROLLER_SN    serial number of crate controller  ### #
# ###         CAN_LINE    CAN line ID                             ### #
# ###         CRATE_ID    crate address                           ### #
# ###         MODULE_ID   module address                          ### #
# ###         CHANNEL_ID  HV channel address                      ### #
#######################################################################
# ###    Modified: 8-21-2018 PR     ### #
# ###    Fixes interlock PVs           ### #
# ###    1 Alias           	            ### #
#test
#######################################################################

###############################
# ### CAN_System item values ##
###############################

record( stringin, "ISEG:5230102:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@Status can0" )	
  field( FLNK, "ISEG:5230102:BitRate" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:BitRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@BitRate can0" )
  field( TSE,  "-2" )
}	

record( longin, "ISEG:5230102:ModuleNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@ModuleNumber can0" )
  field( FLNK, "ISEG:5230102:CrateNumber" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:CrateNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CrateNumber can0" )
  field( FLNK, "ISEG:5230102:CrateList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:CrateList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CrateList can0" )
  field( FLNK, "ISEG:5230102:CycleCounter" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:CycleCounter" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CycleCounter can0" )
  field( TSE,  "-2" )
}

#############################
# ### CAN_Line item values ##
#############################

record( stringin, "ISEG:5230102:0:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.Status can0" )
  field( FLNK, "ISEG:5230102:0:BitRate" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:BitRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.BitRate can0" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:ModuleNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.ModuleNumber can0" )
  field( FLNK, "ISEG:5230102:0:ModuleList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:ModuleList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.ModuleList can0" )
  field( FLNK, "ISEG:5230102:0:CrateNumber" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:CrateNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.CrateNumber can0" )
  field( FLNK, "ISEG:5230102:0:CrateList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:CrateList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.CrateList can0" )
  field( TSE,  "-2" )
}

#############################
# ### Crate item values ### #
#############################

record( mbbiDirect, "ISEG:5230102:0:1000:StatusLow" ) {
  field( DESC, "Lower 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Status can0" )
  field( NOBT, "16" )
  field( SHFT, "0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1000:StatusHigh" ) {
  field( DESC, "Upper 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Status can0" )
  field( NOBT, "16" )
  field( SHFT, "16" )  ## shift the value by 16 bits to the right
  field( TSE,  "-2" )
}

# Alternative way to read out the status:
# In this case only the calc record needs to be triggered

#record( longin, "ISEG:5230102:0:1000:StatusRead__" ) {
#  field( DTYP, "isegHAL" )
#  field( INP,  "@0.1000.Status can0" )
#}
#record( calc, "ISEG:5230102:0:1000:StatusSplit__" ) {
#  ## PP = Passive Process: Force the other record to process before sending the value
#  field( INPA, "ISEG:5230102:0:1000:StatusRead PP" )
#
#  field( INPB, "0x0000ffff" )
#  field( INPC, "0xffff0000" )
#
#  ## First, set field D to ( field A bitwise AND field B ),
#  ## then set field VAL to ( field A bitwise AND field C ) right shifted by 16 bit
#  field( CALC, "d:=(A&B); (A&C)>>16" )
#}
#record( mbbiDirect, "ISEG:5230102:0:1000:StatusLow" ) {
#  field( DTYP, "Soft Channel" )
#  field( INP,  "ISEG:5230102:0:1000:StatusSplit__.D CP" )
#}
#record( mbbiDirect, "ISEG:5230102:0:1000:StatusHigh" ) {
#  field( DTYP, "Soft Channel" )
#  field( INP,  "ISEG:5230102:0:1000:StatusSplit__.VAL CP" )
#}

record( mbbiDirect, "ISEG:5230102:0:1000:EventStatusLow" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.EventStatus can0" )
  field( NOBT, "16" )
  field( SHFT, "0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1000:EventStatusHigh" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.EventStatus can0" )
  field( NOBT, "16" )
  field( SHFT, "16" )
  field( TSE,  "-2" )
}
record( longout, "ISEG:5230102:0:1000:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.EventMask can0" )
  field( TSE,  "-2" )
}
record( ai, "ISEG:5230102:0:1000:FanSpeed" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FanSpeed can0" )
  field( TSE,  "-2" )
  field( SCAN, "1 second")
}

record( bo, "ISEG:5230102:0:1000:Control:0" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.Control:0 can0" )
  field( ZNAM, "" )
  field( ONAM, "doClear" )
  field( TSE,  "-2" )
}


record( longin, "ISEG:5230102:0:1000:SerialNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.SerialNumber can0" )
  field( TSE,  "-2" )
  field( SCAN,  "1 second" )
}

record( bo, "ISEG:5230102:0:1000:PowerOn" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.PowerOn can0" )
  field( TSE,  "-2" )
  field( ZNAM, "Off" )
  field( ONAM, "On" )
}

record( stringin, "ISEG:5230102:0:1000:FirmwareRelease" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FirmwareRelease can0" )
  field( FLNK, "ISEG:5230102:0:1000:FirmwareName" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1000:FirmwareName" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FirmwareName can0" )
  field( FLNK, "ISEG:5230102:0:1000:Article" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1000:Article" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Article can0" )
  field( TSE,  "-2" )
}


##############################
# ### Module item values ### #
##############################

record( mbbiDirect, "ISEG:5230102:0:0:Status" ) {
  field( DESC, "Lower 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( DISV, "0" )  ## Disable Value (if value linked by SDIS == DISV record is disabled)
  field( SDIS, "ISEG:5230102:0:1000:PowerOn.VAL NPP MS" )
  field( INP,  "@0.0.Status can0" )
  field( FLNK, "ISEG:5230102:0:0:EventStatus" ) ## Build read out chains
  field( TSE,  "-2" )
  field( SCAN,  "1 second" )
}

record( mbbiDirect, "ISEG:5230102:0:0:EventStatus" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.EventStatus can0" )
  field( FLNK, "ISEG:5230102:0:0:EventMask" )
  field( TSE,  "-2" )
}
record( longout, "ISEG:5230102:0:0:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.EventMask can0" )
  field( FLNK, "ISEG:5230102:0:0:Temperature" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:0:Control:doClear" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.Control:6 can0" )
  field( ZNAM, "" )
  field( ONAM, "doClear" )
  field( TSE,  "-2" )
  alias( "ch3:doClear" )
}

record( bo, "ISEG:5230102:0:0:Control:setFineAdjustment" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.Control:12 can0" )
  field( ZNAM, "FineAdjustment off" )
  field( ONAM, "FineAdjustment on" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:0:Control:setKillEnable" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.Control:14 can0" )
  field( ZNAM, "KillEnable off" )
  field( ONAM, "KillEnable on" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:VoltageRampSpeed" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.VoltageRampSpeed can0" )
  field( FLNK, "ISEG:5230102:0:0:CurrentRampSpeed" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:CurrentRampSpeed" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.CurrentRampSpeed can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:0:VoltageLimit" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.VoltageLimit can0" )
  field( FLNK, "ISEG:5230102:0:0:CurrentLimit" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( ai, "ISEG:5230102:0:0:CurrentLimit" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.CurrentLimit can0" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( ai, "ISEG:5230102:0:0:Temperature" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.Temperature can0" )
  field( TSE,  "-2" )
  field( SCAN, "1 second")
}

record( longin, "ISEG:5230102:0:0:SerialNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.SerialNumber can0" )
  field( FLNK, "ISEG:5230102:0:0:ChannelNumber" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( longin, "ISEG:5230102:0:0:ChannelNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.ChannelNumber can0" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:0:SampleRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.SampleRate can0" )
  field( FLNK, "ISEG:5230102:0:0:DigitalFilter" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:0:DigitalFilter" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.DigitalFilter can0" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:0:FirmwareRelease" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.FirmwareRelease can0" )
  field( FLNK, "ISEG:5230102:0:0:FirmwareName" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:0:FirmwareName" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.FirmwareName can0" )
  field( FLNK, "ISEG:5230102:0:0:Article" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:0:Article" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.Article can0" )
  field( TSE,  "-2" )
}

#####################################
# ### Decoding of Module Status ### #
#####################################

record( bi, "ISEG:5230102:0:0:isAdjustment" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B0 can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:Status:isLiveInsertion" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B2 can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:needService" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B4 can0" )
  field( ZNAM, "ok" )
  field( ONAM, "Hardware failure detected" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:isInputError" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B6 CP can0" )
  field( ZNAM, "ok" )
  field( ONAM, "Error" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:0:isNoSumError" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B8 CP can0" )
  field( ZNAM, "Error" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isNoRamp" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B9 CP can0" )
  field( ZNAM, "channel is ramping" )
  field( ONAM, "all channels stable" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isSafetyLoopGood" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BA CP can0" )
  field( ZNAM, "broken" )
  field( ONAM, "closed" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "Passive" )
  alias( "ch3:isSafetyLoopGood" )  
}

record( bi, "ISEG:5230102:0:0:isEVentActive" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BB CP can0" )
  field( ZNAM, "no active Event" )
  field( ONAM, "any event active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isModuleGood" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BC CP can0" )
  field( ZNAM, "failure" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isSuppliesGodd" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BD CP can0" )
  field( ZNAM, "Out of Range" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isTemperatureGood" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BE CP can0" )
  field( ZNAM, "above 55 degC" )
  field( ONAM, "within range" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isKillEnable" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BF can0" )
  field( ZNAM, "disabled" )
  field( ONAM, "enabled" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

###########################################
# ### Decoding of Module Event Status ### #
###########################################
record( bi, "ISEG:5230102:0:0:EventLiveInsertion" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.B2 CP can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:EventService" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.B4 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Hardware failure detected" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:EventInputError" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.B6 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Input Error in connection" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:EventSafetyLoopNotGood" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.BA CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Safety loop open" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
  alias( "ch3:EventSafetyLoopNotGood" )
}

record( bi, "ISEG:5230102:0:0:EventSuppliesNotGood" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.BD CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Supply is not good" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:EventTemperatureNotGood" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.BD CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Temperature above 55 degC" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

###############################
# ### Channel item values ### #
###############################

record( ao, "ISEG:5230102:0:0:3:VoltageSet" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.3.VoltageSet can0" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" )
  alias( "ch3:VoltageSet" )
}

record( ao, "ISEG:5230102:0:0:3:CurrentSet" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.3.CurrentSet can0" )
  field( TSE,  "-2" )
  field( PREC, "6" )
  field( SCAN, "1 second" )
  field( VAL, ".001")
  field( PINI, "YES")
  alias( "ch3:CurrentSet" )
}

record( ai, "ISEG:5230102:0:0:3:VoltageMeasure" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.3.VoltageMeasure can0" )
  field( FLNK, "ISEG:5230102:0:0:3:CurrentMeasure" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" )
  alias( "ch3:VoltageMeasure" )
}

record( ai, "ISEG:5230102:0:0:3:CurrentMeasure" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.3.CurrentMeasure can0" )
  field( FLNK, "ISEG:5230102:0:0:3:Status" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" ) 
  alias( "ch3:CurrentMeasure" )
}

record( ao, "ISEG:5230102:0:0:3:VoltageBounds" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.3.VoltageBounds can0" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:3:CurrentBounds" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.3.CurrentBounds can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:0:3:VoltageNominal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.3.VoltageNominal can0" )
  field( FLNK, "ISEG:5230102:0:0:3:CurrentNominal" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:0:3:CurrentNominal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.3.CurrentNominal can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:0:3:TemperatureExternal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.3.TemperatureExternal can0" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:3:VctCoefficient" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.3.VctCoefficient can0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:0:3:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.3.Status can0" )
  field( FLNK, "ISEG:5230102:0:0:3:EventStatus" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:0:3:Control:setOn" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.3.Control:3 can0" )
  field( ZNAM, "Channel off" )
  field( ONAM, "Channel on" )
  field( TSE,  "-2" )
  alias( "ch3:setOn" )
}

record( bo, "ISEG:5230102:0:0:3:Control:setEmergency" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.3.Control:5 can0" )
  field( ZNAM, "" )
  field( ONAM, "Set EMCY" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:0:3:EventStatus" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.3.EventStatus can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:0:3:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.3.EventMask can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:0:3:DelayedTripAction" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.3.DelayedTripAction can0" )
  field( FLNK, "ISEG:5230102:0:0:3:DelayedTripTime" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:3:DelayedTripTime" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.3.DelayedTripTime can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:0:3:ExternalInhibitAction" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.3.ExternalInhibitAction can0" )
  field( TSE,  "-2" )
}

######################################
# ### Decoding of Channel Status ### #
######################################
record( bi, "ISEG:5230102:0:0:3:InputError" ) {
  field( INP,  "ISEG:5230102:0:0:3:Status.B2 CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Input Error" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:0:3:isOn" ) {
  field( INP,  "ISEG:5230102:0:0:3:Status.B3 CP can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "1 second" )
  alias( "ch3:isOn" ) 
}

record( bi, "ISEG:5230102:0:0:3:isVoltageRamp" ) {
  field( INP,  "ISEG:5230102:0:0:3:Status.B4 CP can0" )
  field( ZNAM, "stable" )
  field( ONAM, "ramping" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:3:isEmergency" ) {
  field( INP,  "ISEG:5230102:0:0:3:Status.B5 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:3:isCC" ) {
  field( INP,  "ISEG:5230102:0:0:3:Status.B6 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
  field( SCAN,  "1 second" )
}

record( bi, "ISEG:5230102:0:0:3:isCV" ) {
  field( INP,  "ISEG:5230102:0:0:3:Status.B7 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "1 second" )
}

record( bi, "ISEG:5230102:0:0:3:isCurrentBound" ) {
  field( INP,  "ISEG:5230102:0:0:3:Status.BA CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Out of bounds" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:3:isVoltageBound" ) {
  field( INP,  "ISEG:5230102:0:0:3:Status.BB CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Out of bounds" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:3:isEventInhibit" ) {
  field( INP,  "ISEG:5230102:0:0:3:Status.BC CP can0" )
  field( ZNAM, "no" )
  field( ONAM, "yes" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:3:isTrip" ) {
  field( INP,  "ISEG:5230102:0:0:3:Status.BD CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "tripped" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:3:isCurrentLimit" ) {
  field( INP,  "ISEG:5230102:0:0:3:Status.BE CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "exceeded" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:3:isVoltageLimit" ) {
  field( INP,  "ISEG:5230102:0:0:3:Status.BF CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "exceeded" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

############################################
# ### Decoding of Channel Event Status ### #
############################################
record( bi, "ISEG:5230102:0:0:3:EventInputError" ) {
  field( INP,  "ISEG:5230102:0:0:3:EventStatus.B2 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:0:3:EOn2Off" ) {
  field( INP,  "ISEG:5230102:0:0:3:EventStatus.B3 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:3:EventEndOfRamp" ) {
  field( INP,  "ISEG:5230102:0:0:3:EventStatus.B4 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:3:EventEmergency" ) {
  field( INP,  "ISEG:5230102:0:0:3:EventStatus.B5 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:3:ECC" ) {
  field( INP,  "ISEG:5230102:0:0:3:EventStatus.B6 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:3:ECV" ) {
  field( INP,  "ISEG:5230102:0:0:3:EventStatus.B7 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:3:ECurrentBounds" ) {
  field( INP,  "ISEG:5230102:0:0:3:EventStatus.BA CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:3:EVVoltageBounds" ) {
  field( INP,  "ISEG:5230102:0:0:3:EventStatus.BB CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:3:EventExternalInhibit" ) {
  field( INP,  "ISEG:5230102:0:0:3:EventStatus.BC CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:3:EventTrip" ) {
  field( INP,  "ISEG:5230102:0:0:3:EventStatus.BD CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:3:EventCurrentLimit" ) {
  field( INP,  "ISEG:5230102:0:0:3:EventStatus.BE CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:3:EventVoltageLimit" ) {
  field( INP,  "ISEG:5230102:0:0:3:EventStatus.BF CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

#######################################################################
# ###                                                             ### #
# ### EPICS Database for                                          ### #
# ###   iseg HAL                                                  ### #
# ###                                                             ### #
# ### author: J. Roemer, F.Feldbauer                              ### #
# ###                                                             ### #
# ###                                                             ### #
# ### macros: CONTROLLER_SN    serial number of crate controller  ### #
# ###         CAN_LINE    CAN line ID                             ### #
# ###         CRATE_ID    crate address                           ### #
# ###         MODULE_ID   module address                          ### #
# ###         CHANNEL_ID  HV channel address                      ### #
#######################################################################
# ###    Modified: 8-21-2018 PR     ### #
# ###    Fixes interlock PVs           ### #
# ###    1 Alias           	            ### #
#test
#######################################################################

###############################
# ### CAN_System item values ##
###############################

record( stringin, "ISEG:5230102:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@Status can0" )	
  field( FLNK, "ISEG:5230102:BitRate" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:BitRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@BitRate can0" )
  field( TSE,  "-2" )
}	

record( longin, "ISEG:5230102:ModuleNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@ModuleNumber can0" )
  field( FLNK, "ISEG:5230102:CrateNumber" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:CrateNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CrateNumber can0" )
  field( FLNK, "ISEG:5230102:CrateList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:CrateList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CrateList can0" )
  field( FLNK, "ISEG:5230102:CycleCounter" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:CycleCounter" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CycleCounter can0" )
  field( TSE,  "-2" )
}

#############################
# ### CAN_Line item values ##
#############################

record( stringin, "ISEG:5230102:0:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.Status can0" )
  field( FLNK, "ISEG:5230102:0:BitRate" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:BitRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.BitRate can0" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:ModuleNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.ModuleNumber can0" )
  field( FLNK, "ISEG:5230102:0:ModuleList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:ModuleList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.ModuleList can0" )
  field( FLNK, "ISEG:5230102:0:CrateNumber" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:CrateNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.CrateNumber can0" )
  field( FLNK, "ISEG:5230102:0:CrateList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:CrateList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.CrateList can0" )
  field( TSE,  "-2" )
}

#############################
# ### Crate item values ### #
#############################

record( mbbiDirect, "ISEG:5230102:0:1000:StatusLow" ) {
  field( DESC, "Lower 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Status can0" )
  field( NOBT, "16" )
  field( SHFT, "0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1000:StatusHigh" ) {
  field( DESC, "Upper 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Status can0" )
  field( NOBT, "16" )
  field( SHFT, "16" )  ## shift the value by 16 bits to the right
  field( TSE,  "-2" )
}

# Alternative way to read out the status:
# In this case only the calc record needs to be triggered

#record( longin, "ISEG:5230102:0:1000:StatusRead__" ) {
#  field( DTYP, "isegHAL" )
#  field( INP,  "@0.1000.Status can0" )
#}
#record( calc, "ISEG:5230102:0:1000:StatusSplit__" ) {
#  ## PP = Passive Process: Force the other record to process before sending the value
#  field( INPA, "ISEG:5230102:0:1000:StatusRead PP" )
#
#  field( INPB, "0x0000ffff" )
#  field( INPC, "0xffff0000" )
#
#  ## First, set field D to ( field A bitwise AND field B ),
#  ## then set field VAL to ( field A bitwise AND field C ) right shifted by 16 bit
#  field( CALC, "d:=(A&B); (A&C)>>16" )
#}
#record( mbbiDirect, "ISEG:5230102:0:1000:StatusLow" ) {
#  field( DTYP, "Soft Channel" )
#  field( INP,  "ISEG:5230102:0:1000:StatusSplit__.D CP" )
#}
#record( mbbiDirect, "ISEG:5230102:0:1000:StatusHigh" ) {
#  field( DTYP, "Soft Channel" )
#  field( INP,  "ISEG:5230102:0:1000:StatusSplit__.VAL CP" )
#}

record( mbbiDirect, "ISEG:5230102:0:1000:EventStatusLow" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.EventStatus can0" )
  field( NOBT, "16" )
  field( SHFT, "0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1000:EventStatusHigh" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.EventStatus can0" )
  field( NOBT, "16" )
  field( SHFT, "16" )
  field( TSE,  "-2" )
}
record( longout, "ISEG:5230102:0:1000:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.EventMask can0" )
  field( TSE,  "-2" )
}
record( ai, "ISEG:5230102:0:1000:FanSpeed" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FanSpeed can0" )
  field( TSE,  "-2" )
  field( SCAN, "1 second")
}

record( bo, "ISEG:5230102:0:1000:Control:0" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.Control:0 can0" )
  field( ZNAM, "" )
  field( ONAM, "doClear" )
  field( TSE,  "-2" )
}


record( longin, "ISEG:5230102:0:1000:SerialNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.SerialNumber can0" )
  field( TSE,  "-2" )
  field( SCAN,  "1 second" )
}

record( bo, "ISEG:5230102:0:1000:PowerOn" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.PowerOn can0" )
  field( TSE,  "-2" )
  field( ZNAM, "Off" )
  field( ONAM, "On" )
}

record( stringin, "ISEG:5230102:0:1000:FirmwareRelease" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FirmwareRelease can0" )
  field( FLNK, "ISEG:5230102:0:1000:FirmwareName" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1000:FirmwareName" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FirmwareName can0" )
  field( FLNK, "ISEG:5230102:0:1000:Article" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1000:Article" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Article can0" )
  field( TSE,  "-2" )
}


##############################
# ### Module item values ### #
##############################

record( mbbiDirect, "ISEG:5230102:0:0:Status" ) {
  field( DESC, "Lower 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( DISV, "0" )  ## Disable Value (if value linked by SDIS == DISV record is disabled)
  field( SDIS, "ISEG:5230102:0:1000:PowerOn.VAL NPP MS" )
  field( INP,  "@0.0.Status can0" )
  field( FLNK, "ISEG:5230102:0:0:EventStatus" ) ## Build read out chains
  field( TSE,  "-2" )
  field( SCAN,  "1 second" )
}

record( mbbiDirect, "ISEG:5230102:0:0:EventStatus" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.EventStatus can0" )
  field( FLNK, "ISEG:5230102:0:0:EventMask" )
  field( TSE,  "-2" )
}
record( longout, "ISEG:5230102:0:0:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.EventMask can0" )
  field( FLNK, "ISEG:5230102:0:0:Temperature" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:0:Control:doClear" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.Control:6 can0" )
  field( ZNAM, "" )
  field( ONAM, "doClear" )
  field( TSE,  "-2" )
  alias( "ch4:doClear" )
}

record( bo, "ISEG:5230102:0:0:Control:setFineAdjustment" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.Control:12 can0" )
  field( ZNAM, "FineAdjustment off" )
  field( ONAM, "FineAdjustment on" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:0:Control:setKillEnable" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.Control:14 can0" )
  field( ZNAM, "KillEnable off" )
  field( ONAM, "KillEnable on" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:VoltageRampSpeed" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.VoltageRampSpeed can0" )
  field( FLNK, "ISEG:5230102:0:0:CurrentRampSpeed" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:CurrentRampSpeed" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.CurrentRampSpeed can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:0:VoltageLimit" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.VoltageLimit can0" )
  field( FLNK, "ISEG:5230102:0:0:CurrentLimit" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( ai, "ISEG:5230102:0:0:CurrentLimit" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.CurrentLimit can0" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( ai, "ISEG:5230102:0:0:Temperature" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.Temperature can0" )
  field( TSE,  "-2" )
  field( SCAN, "1 second")
}

record( longin, "ISEG:5230102:0:0:SerialNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.SerialNumber can0" )
  field( FLNK, "ISEG:5230102:0:0:ChannelNumber" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( longin, "ISEG:5230102:0:0:ChannelNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.ChannelNumber can0" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:0:SampleRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.SampleRate can0" )
  field( FLNK, "ISEG:5230102:0:0:DigitalFilter" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:0:DigitalFilter" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.DigitalFilter can0" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:0:FirmwareRelease" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.FirmwareRelease can0" )
  field( FLNK, "ISEG:5230102:0:0:FirmwareName" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:0:FirmwareName" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.FirmwareName can0" )
  field( FLNK, "ISEG:5230102:0:0:Article" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:0:Article" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.Article can0" )
  field( TSE,  "-2" )
}

#####################################
# ### Decoding of Module Status ### #
#####################################

record( bi, "ISEG:5230102:0:0:isAdjustment" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B0 can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:Status:isLiveInsertion" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B2 can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:needService" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B4 can0" )
  field( ZNAM, "ok" )
  field( ONAM, "Hardware failure detected" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:isInputError" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B6 CP can0" )
  field( ZNAM, "ok" )
  field( ONAM, "Error" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:0:isNoSumError" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B8 CP can0" )
  field( ZNAM, "Error" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isNoRamp" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B9 CP can0" )
  field( ZNAM, "channel is ramping" )
  field( ONAM, "all channels stable" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isSafetyLoopGood" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BA CP can0" )
  field( ZNAM, "broken" )
  field( ONAM, "closed" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "Passive" )
  alias( "ch4:isSafetyLoopGood" )  
}

record( bi, "ISEG:5230102:0:0:isEVentActive" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BB CP can0" )
  field( ZNAM, "no active Event" )
  field( ONAM, "any event active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isModuleGood" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BC CP can0" )
  field( ZNAM, "failure" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isSuppliesGodd" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BD CP can0" )
  field( ZNAM, "Out of Range" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isTemperatureGood" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BE CP can0" )
  field( ZNAM, "above 55 degC" )
  field( ONAM, "within range" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isKillEnable" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BF can0" )
  field( ZNAM, "disabled" )
  field( ONAM, "enabled" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

###########################################
# ### Decoding of Module Event Status ### #
###########################################
record( bi, "ISEG:5230102:0:0:EventLiveInsertion" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.B2 CP can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:EventService" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.B4 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Hardware failure detected" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:EventInputError" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.B6 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Input Error in connection" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:EventSafetyLoopNotGood" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.BA CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Safety loop open" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
  alias( "ch4:EventSafetyLoopNotGood" )
}

record( bi, "ISEG:5230102:0:0:EventSuppliesNotGood" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.BD CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Supply is not good" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:EventTemperatureNotGood" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.BD CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Temperature above 55 degC" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

###############################
# ### Channel item values ### #
###############################

record( ao, "ISEG:5230102:0:0:4:VoltageSet" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.4.VoltageSet can0" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" )
  alias( "ch4:VoltageSet" )
}

record( ao, "ISEG:5230102:0:0:4:CurrentSet" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.4.CurrentSet can0" )
  field( TSE,  "-2" )
  field( PREC, "6" )
  field( SCAN, "1 second" )
  field( VAL, ".001")
  field( PINI, "YES")
  alias( "ch4:CurrentSet" )
}

record( ai, "ISEG:5230102:0:0:4:VoltageMeasure" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.4.VoltageMeasure can0" )
  field( FLNK, "ISEG:5230102:0:0:4:CurrentMeasure" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" )
  alias( "ch4:VoltageMeasure" )
}

record( ai, "ISEG:5230102:0:0:4:CurrentMeasure" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.4.CurrentMeasure can0" )
  field( FLNK, "ISEG:5230102:0:0:4:Status" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" ) 
  alias( "ch4:CurrentMeasure" )
}

record( ao, "ISEG:5230102:0:0:4:VoltageBounds" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.4.VoltageBounds can0" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:4:CurrentBounds" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.4.CurrentBounds can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:0:4:VoltageNominal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.4.VoltageNominal can0" )
  field( FLNK, "ISEG:5230102:0:0:4:CurrentNominal" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:0:4:CurrentNominal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.4.CurrentNominal can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:0:4:TemperatureExternal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.4.TemperatureExternal can0" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:4:VctCoefficient" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.4.VctCoefficient can0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:0:4:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.4.Status can0" )
  field( FLNK, "ISEG:5230102:0:0:4:EventStatus" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:0:4:Control:setOn" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.4.Control:3 can0" )
  field( ZNAM, "Channel off" )
  field( ONAM, "Channel on" )
  field( TSE,  "-2" )
  alias( "ch4:setOn" )
}

record( bo, "ISEG:5230102:0:0:4:Control:setEmergency" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.4.Control:5 can0" )
  field( ZNAM, "" )
  field( ONAM, "Set EMCY" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:0:4:EventStatus" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.4.EventStatus can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:0:4:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.4.EventMask can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:0:4:DelayedTripAction" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.4.DelayedTripAction can0" )
  field( FLNK, "ISEG:5230102:0:0:4:DelayedTripTime" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:4:DelayedTripTime" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.4.DelayedTripTime can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:0:4:ExternalInhibitAction" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.4.ExternalInhibitAction can0" )
  field( TSE,  "-2" )
}

######################################
# ### Decoding of Channel Status ### #
######################################
record( bi, "ISEG:5230102:0:0:4:InputError" ) {
  field( INP,  "ISEG:5230102:0:0:4:Status.B2 CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Input Error" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:0:4:isOn" ) {
  field( INP,  "ISEG:5230102:0:0:4:Status.B3 CP can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "1 second" )
  alias( "ch4:isOn" ) 
}

record( bi, "ISEG:5230102:0:0:4:isVoltageRamp" ) {
  field( INP,  "ISEG:5230102:0:0:4:Status.B4 CP can0" )
  field( ZNAM, "stable" )
  field( ONAM, "ramping" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:4:isEmergency" ) {
  field( INP,  "ISEG:5230102:0:0:4:Status.B5 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:4:isCC" ) {
  field( INP,  "ISEG:5230102:0:0:4:Status.B6 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
  field( SCAN,  "1 second" )
}

record( bi, "ISEG:5230102:0:0:4:isCV" ) {
  field( INP,  "ISEG:5230102:0:0:4:Status.B7 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "1 second" )
}

record( bi, "ISEG:5230102:0:0:4:isCurrentBound" ) {
  field( INP,  "ISEG:5230102:0:0:4:Status.BA CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Out of bounds" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:4:isVoltageBound" ) {
  field( INP,  "ISEG:5230102:0:0:4:Status.BB CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Out of bounds" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:4:isEventInhibit" ) {
  field( INP,  "ISEG:5230102:0:0:4:Status.BC CP can0" )
  field( ZNAM, "no" )
  field( ONAM, "yes" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:4:isTrip" ) {
  field( INP,  "ISEG:5230102:0:0:4:Status.BD CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "tripped" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:4:isCurrentLimit" ) {
  field( INP,  "ISEG:5230102:0:0:4:Status.BE CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "exceeded" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:4:isVoltageLimit" ) {
  field( INP,  "ISEG:5230102:0:0:4:Status.BF CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "exceeded" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

############################################
# ### Decoding of Channel Event Status ### #
############################################
record( bi, "ISEG:5230102:0:0:4:EventInputError" ) {
  field( INP,  "ISEG:5230102:0:0:4:EventStatus.B2 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:0:4:EOn2Off" ) {
  field( INP,  "ISEG:5230102:0:0:4:EventStatus.B3 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:4:EventEndOfRamp" ) {
  field( INP,  "ISEG:5230102:0:0:4:EventStatus.B4 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:4:EventEmergency" ) {
  field( INP,  "ISEG:5230102:0:0:4:EventStatus.B5 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:4:ECC" ) {
  field( INP,  "ISEG:5230102:0:0:4:EventStatus.B6 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:4:ECV" ) {
  field( INP,  "ISEG:5230102:0:0:4:EventStatus.B7 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:4:ECurrentBounds" ) {
  field( INP,  "ISEG:5230102:0:0:4:EventStatus.BA CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:4:EVVoltageBounds" ) {
  field( INP,  "ISEG:5230102:0:0:4:EventStatus.BB CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:4:EventExternalInhibit" ) {
  field( INP,  "ISEG:5230102:0:0:4:EventStatus.BC CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:4:EventTrip" ) {
  field( INP,  "ISEG:5230102:0:0:4:EventStatus.BD CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:4:EventCurrentLimit" ) {
  field( INP,  "ISEG:5230102:0:0:4:EventStatus.BE CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:4:EventVoltageLimit" ) {
  field( INP,  "ISEG:5230102:0:0:4:EventStatus.BF CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

#######################################################################
# ###                                                             ### #
# ### EPICS Database for                                          ### #
# ###   iseg HAL                                                  ### #
# ###                                                             ### #
# ### author: J. Roemer, F.Feldbauer                              ### #
# ###                                                             ### #
# ###                                                             ### #
# ### macros: CONTROLLER_SN    serial number of crate controller  ### #
# ###         CAN_LINE    CAN line ID                             ### #
# ###         CRATE_ID    crate address                           ### #
# ###         MODULE_ID   module address                          ### #
# ###         CHANNEL_ID  HV channel address                      ### #
#######################################################################
# ###    Modified: 8-21-2018 PR     ### #
# ###    Fixes interlock PVs           ### #
# ###    1 Alias           	            ### #
#test
#######################################################################

###############################
# ### CAN_System item values ##
###############################

record( stringin, "ISEG:5230102:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@Status can0" )	
  field( FLNK, "ISEG:5230102:BitRate" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:BitRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@BitRate can0" )
  field( TSE,  "-2" )
}	

record( longin, "ISEG:5230102:ModuleNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@ModuleNumber can0" )
  field( FLNK, "ISEG:5230102:CrateNumber" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:CrateNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CrateNumber can0" )
  field( FLNK, "ISEG:5230102:CrateList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:CrateList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CrateList can0" )
  field( FLNK, "ISEG:5230102:CycleCounter" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:CycleCounter" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CycleCounter can0" )
  field( TSE,  "-2" )
}

#############################
# ### CAN_Line item values ##
#############################

record( stringin, "ISEG:5230102:0:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.Status can0" )
  field( FLNK, "ISEG:5230102:0:BitRate" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:BitRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.BitRate can0" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:ModuleNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.ModuleNumber can0" )
  field( FLNK, "ISEG:5230102:0:ModuleList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:ModuleList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.ModuleList can0" )
  field( FLNK, "ISEG:5230102:0:CrateNumber" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:CrateNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.CrateNumber can0" )
  field( FLNK, "ISEG:5230102:0:CrateList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:CrateList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.CrateList can0" )
  field( TSE,  "-2" )
}

#############################
# ### Crate item values ### #
#############################

record( mbbiDirect, "ISEG:5230102:0:1000:StatusLow" ) {
  field( DESC, "Lower 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Status can0" )
  field( NOBT, "16" )
  field( SHFT, "0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1000:StatusHigh" ) {
  field( DESC, "Upper 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Status can0" )
  field( NOBT, "16" )
  field( SHFT, "16" )  ## shift the value by 16 bits to the right
  field( TSE,  "-2" )
}

# Alternative way to read out the status:
# In this case only the calc record needs to be triggered

#record( longin, "ISEG:5230102:0:1000:StatusRead__" ) {
#  field( DTYP, "isegHAL" )
#  field( INP,  "@0.1000.Status can0" )
#}
#record( calc, "ISEG:5230102:0:1000:StatusSplit__" ) {
#  ## PP = Passive Process: Force the other record to process before sending the value
#  field( INPA, "ISEG:5230102:0:1000:StatusRead PP" )
#
#  field( INPB, "0x0000ffff" )
#  field( INPC, "0xffff0000" )
#
#  ## First, set field D to ( field A bitwise AND field B ),
#  ## then set field VAL to ( field A bitwise AND field C ) right shifted by 16 bit
#  field( CALC, "d:=(A&B); (A&C)>>16" )
#}
#record( mbbiDirect, "ISEG:5230102:0:1000:StatusLow" ) {
#  field( DTYP, "Soft Channel" )
#  field( INP,  "ISEG:5230102:0:1000:StatusSplit__.D CP" )
#}
#record( mbbiDirect, "ISEG:5230102:0:1000:StatusHigh" ) {
#  field( DTYP, "Soft Channel" )
#  field( INP,  "ISEG:5230102:0:1000:StatusSplit__.VAL CP" )
#}

record( mbbiDirect, "ISEG:5230102:0:1000:EventStatusLow" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.EventStatus can0" )
  field( NOBT, "16" )
  field( SHFT, "0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1000:EventStatusHigh" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.EventStatus can0" )
  field( NOBT, "16" )
  field( SHFT, "16" )
  field( TSE,  "-2" )
}
record( longout, "ISEG:5230102:0:1000:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.EventMask can0" )
  field( TSE,  "-2" )
}
record( ai, "ISEG:5230102:0:1000:FanSpeed" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FanSpeed can0" )
  field( TSE,  "-2" )
  field( SCAN, "1 second")
}

record( bo, "ISEG:5230102:0:1000:Control:0" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.Control:0 can0" )
  field( ZNAM, "" )
  field( ONAM, "doClear" )
  field( TSE,  "-2" )
}


record( longin, "ISEG:5230102:0:1000:SerialNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.SerialNumber can0" )
  field( TSE,  "-2" )
  field( SCAN,  "1 second" )
}

record( bo, "ISEG:5230102:0:1000:PowerOn" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.PowerOn can0" )
  field( TSE,  "-2" )
  field( ZNAM, "Off" )
  field( ONAM, "On" )
}

record( stringin, "ISEG:5230102:0:1000:FirmwareRelease" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FirmwareRelease can0" )
  field( FLNK, "ISEG:5230102:0:1000:FirmwareName" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1000:FirmwareName" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FirmwareName can0" )
  field( FLNK, "ISEG:5230102:0:1000:Article" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1000:Article" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Article can0" )
  field( TSE,  "-2" )
}


##############################
# ### Module item values ### #
##############################

record( mbbiDirect, "ISEG:5230102:0:0:Status" ) {
  field( DESC, "Lower 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( DISV, "0" )  ## Disable Value (if value linked by SDIS == DISV record is disabled)
  field( SDIS, "ISEG:5230102:0:1000:PowerOn.VAL NPP MS" )
  field( INP,  "@0.0.Status can0" )
  field( FLNK, "ISEG:5230102:0:0:EventStatus" ) ## Build read out chains
  field( TSE,  "-2" )
  field( SCAN,  "1 second" )
}

record( mbbiDirect, "ISEG:5230102:0:0:EventStatus" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.EventStatus can0" )
  field( FLNK, "ISEG:5230102:0:0:EventMask" )
  field( TSE,  "-2" )
}
record( longout, "ISEG:5230102:0:0:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.EventMask can0" )
  field( FLNK, "ISEG:5230102:0:0:Temperature" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:0:Control:doClear" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.Control:6 can0" )
  field( ZNAM, "" )
  field( ONAM, "doClear" )
  field( TSE,  "-2" )
  alias( "ch5:doClear" )
}

record( bo, "ISEG:5230102:0:0:Control:setFineAdjustment" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.Control:12 can0" )
  field( ZNAM, "FineAdjustment off" )
  field( ONAM, "FineAdjustment on" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:0:Control:setKillEnable" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.Control:14 can0" )
  field( ZNAM, "KillEnable off" )
  field( ONAM, "KillEnable on" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:VoltageRampSpeed" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.VoltageRampSpeed can0" )
  field( FLNK, "ISEG:5230102:0:0:CurrentRampSpeed" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:CurrentRampSpeed" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.CurrentRampSpeed can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:0:VoltageLimit" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.VoltageLimit can0" )
  field( FLNK, "ISEG:5230102:0:0:CurrentLimit" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( ai, "ISEG:5230102:0:0:CurrentLimit" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.CurrentLimit can0" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( ai, "ISEG:5230102:0:0:Temperature" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.Temperature can0" )
  field( TSE,  "-2" )
  field( SCAN, "1 second")
}

record( longin, "ISEG:5230102:0:0:SerialNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.SerialNumber can0" )
  field( FLNK, "ISEG:5230102:0:0:ChannelNumber" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( longin, "ISEG:5230102:0:0:ChannelNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.ChannelNumber can0" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:0:SampleRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.SampleRate can0" )
  field( FLNK, "ISEG:5230102:0:0:DigitalFilter" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:0:DigitalFilter" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.DigitalFilter can0" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:0:FirmwareRelease" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.FirmwareRelease can0" )
  field( FLNK, "ISEG:5230102:0:0:FirmwareName" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:0:FirmwareName" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.FirmwareName can0" )
  field( FLNK, "ISEG:5230102:0:0:Article" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:0:Article" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.Article can0" )
  field( TSE,  "-2" )
}

#####################################
# ### Decoding of Module Status ### #
#####################################

record( bi, "ISEG:5230102:0:0:isAdjustment" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B0 can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:Status:isLiveInsertion" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B2 can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:needService" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B4 can0" )
  field( ZNAM, "ok" )
  field( ONAM, "Hardware failure detected" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:isInputError" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B6 CP can0" )
  field( ZNAM, "ok" )
  field( ONAM, "Error" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:0:isNoSumError" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B8 CP can0" )
  field( ZNAM, "Error" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isNoRamp" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B9 CP can0" )
  field( ZNAM, "channel is ramping" )
  field( ONAM, "all channels stable" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isSafetyLoopGood" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BA CP can0" )
  field( ZNAM, "broken" )
  field( ONAM, "closed" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "Passive" )
  alias( "ch5:isSafetyLoopGood" )  
}

record( bi, "ISEG:5230102:0:0:isEVentActive" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BB CP can0" )
  field( ZNAM, "no active Event" )
  field( ONAM, "any event active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isModuleGood" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BC CP can0" )
  field( ZNAM, "failure" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isSuppliesGodd" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BD CP can0" )
  field( ZNAM, "Out of Range" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isTemperatureGood" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BE CP can0" )
  field( ZNAM, "above 55 degC" )
  field( ONAM, "within range" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isKillEnable" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BF can0" )
  field( ZNAM, "disabled" )
  field( ONAM, "enabled" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

###########################################
# ### Decoding of Module Event Status ### #
###########################################
record( bi, "ISEG:5230102:0:0:EventLiveInsertion" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.B2 CP can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:EventService" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.B4 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Hardware failure detected" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:EventInputError" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.B6 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Input Error in connection" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:EventSafetyLoopNotGood" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.BA CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Safety loop open" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
  alias( "ch5:EventSafetyLoopNotGood" )
}

record( bi, "ISEG:5230102:0:0:EventSuppliesNotGood" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.BD CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Supply is not good" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:EventTemperatureNotGood" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.BD CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Temperature above 55 degC" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

###############################
# ### Channel item values ### #
###############################

record( ao, "ISEG:5230102:0:0:5:VoltageSet" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.5.VoltageSet can0" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" )
  alias( "ch5:VoltageSet" )
}

record( ao, "ISEG:5230102:0:0:5:CurrentSet" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.5.CurrentSet can0" )
  field( TSE,  "-2" )
  field( PREC, "6" )
  field( SCAN, "1 second" )
  field( VAL, ".001")
  field( PINI, "YES")
  alias( "ch5:CurrentSet" )
}

record( ai, "ISEG:5230102:0:0:5:VoltageMeasure" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.5.VoltageMeasure can0" )
  field( FLNK, "ISEG:5230102:0:0:5:CurrentMeasure" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" )
  alias( "ch5:VoltageMeasure" )
}

record( ai, "ISEG:5230102:0:0:5:CurrentMeasure" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.5.CurrentMeasure can0" )
  field( FLNK, "ISEG:5230102:0:0:5:Status" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" ) 
  alias( "ch5:CurrentMeasure" )
}

record( ao, "ISEG:5230102:0:0:5:VoltageBounds" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.5.VoltageBounds can0" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:5:CurrentBounds" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.5.CurrentBounds can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:0:5:VoltageNominal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.5.VoltageNominal can0" )
  field( FLNK, "ISEG:5230102:0:0:5:CurrentNominal" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:0:5:CurrentNominal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.5.CurrentNominal can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:0:5:TemperatureExternal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.5.TemperatureExternal can0" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:5:VctCoefficient" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.5.VctCoefficient can0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:0:5:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.5.Status can0" )
  field( FLNK, "ISEG:5230102:0:0:5:EventStatus" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:0:5:Control:setOn" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.5.Control:3 can0" )
  field( ZNAM, "Channel off" )
  field( ONAM, "Channel on" )
  field( TSE,  "-2" )
  alias( "ch5:setOn" )
}

record( bo, "ISEG:5230102:0:0:5:Control:setEmergency" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.5.Control:5 can0" )
  field( ZNAM, "" )
  field( ONAM, "Set EMCY" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:0:5:EventStatus" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.5.EventStatus can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:0:5:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.5.EventMask can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:0:5:DelayedTripAction" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.5.DelayedTripAction can0" )
  field( FLNK, "ISEG:5230102:0:0:5:DelayedTripTime" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:5:DelayedTripTime" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.5.DelayedTripTime can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:0:5:ExternalInhibitAction" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.5.ExternalInhibitAction can0" )
  field( TSE,  "-2" )
}

######################################
# ### Decoding of Channel Status ### #
######################################
record( bi, "ISEG:5230102:0:0:5:InputError" ) {
  field( INP,  "ISEG:5230102:0:0:5:Status.B2 CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Input Error" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:0:5:isOn" ) {
  field( INP,  "ISEG:5230102:0:0:5:Status.B3 CP can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "1 second" )
  alias( "ch5:isOn" ) 
}

record( bi, "ISEG:5230102:0:0:5:isVoltageRamp" ) {
  field( INP,  "ISEG:5230102:0:0:5:Status.B4 CP can0" )
  field( ZNAM, "stable" )
  field( ONAM, "ramping" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:5:isEmergency" ) {
  field( INP,  "ISEG:5230102:0:0:5:Status.B5 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:5:isCC" ) {
  field( INP,  "ISEG:5230102:0:0:5:Status.B6 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
  field( SCAN,  "1 second" )
}

record( bi, "ISEG:5230102:0:0:5:isCV" ) {
  field( INP,  "ISEG:5230102:0:0:5:Status.B7 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "1 second" )
}

record( bi, "ISEG:5230102:0:0:5:isCurrentBound" ) {
  field( INP,  "ISEG:5230102:0:0:5:Status.BA CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Out of bounds" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:5:isVoltageBound" ) {
  field( INP,  "ISEG:5230102:0:0:5:Status.BB CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Out of bounds" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:5:isEventInhibit" ) {
  field( INP,  "ISEG:5230102:0:0:5:Status.BC CP can0" )
  field( ZNAM, "no" )
  field( ONAM, "yes" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:5:isTrip" ) {
  field( INP,  "ISEG:5230102:0:0:5:Status.BD CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "tripped" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:5:isCurrentLimit" ) {
  field( INP,  "ISEG:5230102:0:0:5:Status.BE CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "exceeded" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:5:isVoltageLimit" ) {
  field( INP,  "ISEG:5230102:0:0:5:Status.BF CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "exceeded" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

############################################
# ### Decoding of Channel Event Status ### #
############################################
record( bi, "ISEG:5230102:0:0:5:EventInputError" ) {
  field( INP,  "ISEG:5230102:0:0:5:EventStatus.B2 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:0:5:EOn2Off" ) {
  field( INP,  "ISEG:5230102:0:0:5:EventStatus.B3 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:5:EventEndOfRamp" ) {
  field( INP,  "ISEG:5230102:0:0:5:EventStatus.B4 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:5:EventEmergency" ) {
  field( INP,  "ISEG:5230102:0:0:5:EventStatus.B5 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:5:ECC" ) {
  field( INP,  "ISEG:5230102:0:0:5:EventStatus.B6 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:5:ECV" ) {
  field( INP,  "ISEG:5230102:0:0:5:EventStatus.B7 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:5:ECurrentBounds" ) {
  field( INP,  "ISEG:5230102:0:0:5:EventStatus.BA CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:5:EVVoltageBounds" ) {
  field( INP,  "ISEG:5230102:0:0:5:EventStatus.BB CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:5:EventExternalInhibit" ) {
  field( INP,  "ISEG:5230102:0:0:5:EventStatus.BC CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:5:EventTrip" ) {
  field( INP,  "ISEG:5230102:0:0:5:EventStatus.BD CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:5:EventCurrentLimit" ) {
  field( INP,  "ISEG:5230102:0:0:5:EventStatus.BE CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:5:EventVoltageLimit" ) {
  field( INP,  "ISEG:5230102:0:0:5:EventStatus.BF CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

#######################################################################
# ###                                                             ### #
# ### EPICS Database for                                          ### #
# ###   iseg HAL                                                  ### #
# ###                                                             ### #
# ### author: J. Roemer, F.Feldbauer                              ### #
# ###                                                             ### #
# ###                                                             ### #
# ### macros: CONTROLLER_SN    serial number of crate controller  ### #
# ###         CAN_LINE    CAN line ID                             ### #
# ###         CRATE_ID    crate address                           ### #
# ###         MODULE_ID   module address                          ### #
# ###         CHANNEL_ID  HV channel address                      ### #
#######################################################################
# ###    Modified: 8-21-2018 PR     ### #
# ###    Fixes interlock PVs           ### #
# ###    1 Alias           	            ### #
#test
#######################################################################

###############################
# ### CAN_System item values ##
###############################

record( stringin, "ISEG:5230102:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@Status can0" )	
  field( FLNK, "ISEG:5230102:BitRate" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:BitRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@BitRate can0" )
  field( TSE,  "-2" )
}	

record( longin, "ISEG:5230102:ModuleNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@ModuleNumber can0" )
  field( FLNK, "ISEG:5230102:CrateNumber" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:CrateNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CrateNumber can0" )
  field( FLNK, "ISEG:5230102:CrateList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:CrateList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CrateList can0" )
  field( FLNK, "ISEG:5230102:CycleCounter" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:CycleCounter" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CycleCounter can0" )
  field( TSE,  "-2" )
}

#############################
# ### CAN_Line item values ##
#############################

record( stringin, "ISEG:5230102:0:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.Status can0" )
  field( FLNK, "ISEG:5230102:0:BitRate" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:BitRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.BitRate can0" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:ModuleNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.ModuleNumber can0" )
  field( FLNK, "ISEG:5230102:0:ModuleList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:ModuleList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.ModuleList can0" )
  field( FLNK, "ISEG:5230102:0:CrateNumber" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:CrateNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.CrateNumber can0" )
  field( FLNK, "ISEG:5230102:0:CrateList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:CrateList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.CrateList can0" )
  field( TSE,  "-2" )
}

#############################
# ### Crate item values ### #
#############################

record( mbbiDirect, "ISEG:5230102:0:1000:StatusLow" ) {
  field( DESC, "Lower 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Status can0" )
  field( NOBT, "16" )
  field( SHFT, "0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1000:StatusHigh" ) {
  field( DESC, "Upper 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Status can0" )
  field( NOBT, "16" )
  field( SHFT, "16" )  ## shift the value by 16 bits to the right
  field( TSE,  "-2" )
}

# Alternative way to read out the status:
# In this case only the calc record needs to be triggered

#record( longin, "ISEG:5230102:0:1000:StatusRead__" ) {
#  field( DTYP, "isegHAL" )
#  field( INP,  "@0.1000.Status can0" )
#}
#record( calc, "ISEG:5230102:0:1000:StatusSplit__" ) {
#  ## PP = Passive Process: Force the other record to process before sending the value
#  field( INPA, "ISEG:5230102:0:1000:StatusRead PP" )
#
#  field( INPB, "0x0000ffff" )
#  field( INPC, "0xffff0000" )
#
#  ## First, set field D to ( field A bitwise AND field B ),
#  ## then set field VAL to ( field A bitwise AND field C ) right shifted by 16 bit
#  field( CALC, "d:=(A&B); (A&C)>>16" )
#}
#record( mbbiDirect, "ISEG:5230102:0:1000:StatusLow" ) {
#  field( DTYP, "Soft Channel" )
#  field( INP,  "ISEG:5230102:0:1000:StatusSplit__.D CP" )
#}
#record( mbbiDirect, "ISEG:5230102:0:1000:StatusHigh" ) {
#  field( DTYP, "Soft Channel" )
#  field( INP,  "ISEG:5230102:0:1000:StatusSplit__.VAL CP" )
#}

record( mbbiDirect, "ISEG:5230102:0:1000:EventStatusLow" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.EventStatus can0" )
  field( NOBT, "16" )
  field( SHFT, "0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1000:EventStatusHigh" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.EventStatus can0" )
  field( NOBT, "16" )
  field( SHFT, "16" )
  field( TSE,  "-2" )
}
record( longout, "ISEG:5230102:0:1000:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.EventMask can0" )
  field( TSE,  "-2" )
}
record( ai, "ISEG:5230102:0:1000:FanSpeed" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FanSpeed can0" )
  field( TSE,  "-2" )
  field( SCAN, "1 second")
}

record( bo, "ISEG:5230102:0:1000:Control:0" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.Control:0 can0" )
  field( ZNAM, "" )
  field( ONAM, "doClear" )
  field( TSE,  "-2" )
}


record( longin, "ISEG:5230102:0:1000:SerialNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.SerialNumber can0" )
  field( TSE,  "-2" )
  field( SCAN,  "1 second" )
}

record( bo, "ISEG:5230102:0:1000:PowerOn" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.PowerOn can0" )
  field( TSE,  "-2" )
  field( ZNAM, "Off" )
  field( ONAM, "On" )
}

record( stringin, "ISEG:5230102:0:1000:FirmwareRelease" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FirmwareRelease can0" )
  field( FLNK, "ISEG:5230102:0:1000:FirmwareName" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1000:FirmwareName" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FirmwareName can0" )
  field( FLNK, "ISEG:5230102:0:1000:Article" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1000:Article" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Article can0" )
  field( TSE,  "-2" )
}


##############################
# ### Module item values ### #
##############################

record( mbbiDirect, "ISEG:5230102:0:0:Status" ) {
  field( DESC, "Lower 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( DISV, "0" )  ## Disable Value (if value linked by SDIS == DISV record is disabled)
  field( SDIS, "ISEG:5230102:0:1000:PowerOn.VAL NPP MS" )
  field( INP,  "@0.0.Status can0" )
  field( FLNK, "ISEG:5230102:0:0:EventStatus" ) ## Build read out chains
  field( TSE,  "-2" )
  field( SCAN,  "1 second" )
}

record( mbbiDirect, "ISEG:5230102:0:0:EventStatus" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.EventStatus can0" )
  field( FLNK, "ISEG:5230102:0:0:EventMask" )
  field( TSE,  "-2" )
}
record( longout, "ISEG:5230102:0:0:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.EventMask can0" )
  field( FLNK, "ISEG:5230102:0:0:Temperature" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:0:Control:doClear" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.Control:6 can0" )
  field( ZNAM, "" )
  field( ONAM, "doClear" )
  field( TSE,  "-2" )
  alias( "ch6:doClear" )
}

record( bo, "ISEG:5230102:0:0:Control:setFineAdjustment" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.Control:12 can0" )
  field( ZNAM, "FineAdjustment off" )
  field( ONAM, "FineAdjustment on" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:0:Control:setKillEnable" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.Control:14 can0" )
  field( ZNAM, "KillEnable off" )
  field( ONAM, "KillEnable on" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:VoltageRampSpeed" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.VoltageRampSpeed can0" )
  field( FLNK, "ISEG:5230102:0:0:CurrentRampSpeed" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:CurrentRampSpeed" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.CurrentRampSpeed can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:0:VoltageLimit" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.VoltageLimit can0" )
  field( FLNK, "ISEG:5230102:0:0:CurrentLimit" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( ai, "ISEG:5230102:0:0:CurrentLimit" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.CurrentLimit can0" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( ai, "ISEG:5230102:0:0:Temperature" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.Temperature can0" )
  field( TSE,  "-2" )
  field( SCAN, "1 second")
}

record( longin, "ISEG:5230102:0:0:SerialNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.SerialNumber can0" )
  field( FLNK, "ISEG:5230102:0:0:ChannelNumber" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( longin, "ISEG:5230102:0:0:ChannelNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.ChannelNumber can0" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:0:SampleRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.SampleRate can0" )
  field( FLNK, "ISEG:5230102:0:0:DigitalFilter" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:0:DigitalFilter" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.DigitalFilter can0" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:0:FirmwareRelease" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.FirmwareRelease can0" )
  field( FLNK, "ISEG:5230102:0:0:FirmwareName" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:0:FirmwareName" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.FirmwareName can0" )
  field( FLNK, "ISEG:5230102:0:0:Article" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:0:Article" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.Article can0" )
  field( TSE,  "-2" )
}

#####################################
# ### Decoding of Module Status ### #
#####################################

record( bi, "ISEG:5230102:0:0:isAdjustment" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B0 can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:Status:isLiveInsertion" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B2 can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:needService" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B4 can0" )
  field( ZNAM, "ok" )
  field( ONAM, "Hardware failure detected" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:isInputError" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B6 CP can0" )
  field( ZNAM, "ok" )
  field( ONAM, "Error" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:0:isNoSumError" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B8 CP can0" )
  field( ZNAM, "Error" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isNoRamp" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B9 CP can0" )
  field( ZNAM, "channel is ramping" )
  field( ONAM, "all channels stable" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isSafetyLoopGood" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BA CP can0" )
  field( ZNAM, "broken" )
  field( ONAM, "closed" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "Passive" )
  alias( "ch6:isSafetyLoopGood" )  
}

record( bi, "ISEG:5230102:0:0:isEVentActive" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BB CP can0" )
  field( ZNAM, "no active Event" )
  field( ONAM, "any event active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isModuleGood" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BC CP can0" )
  field( ZNAM, "failure" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isSuppliesGodd" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BD CP can0" )
  field( ZNAM, "Out of Range" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isTemperatureGood" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BE CP can0" )
  field( ZNAM, "above 55 degC" )
  field( ONAM, "within range" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isKillEnable" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BF can0" )
  field( ZNAM, "disabled" )
  field( ONAM, "enabled" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

###########################################
# ### Decoding of Module Event Status ### #
###########################################
record( bi, "ISEG:5230102:0:0:EventLiveInsertion" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.B2 CP can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:EventService" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.B4 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Hardware failure detected" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:EventInputError" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.B6 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Input Error in connection" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:EventSafetyLoopNotGood" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.BA CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Safety loop open" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
  alias( "ch6:EventSafetyLoopNotGood" )
}

record( bi, "ISEG:5230102:0:0:EventSuppliesNotGood" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.BD CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Supply is not good" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:EventTemperatureNotGood" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.BD CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Temperature above 55 degC" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

###############################
# ### Channel item values ### #
###############################

record( ao, "ISEG:5230102:0:0:6:VoltageSet" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.6.VoltageSet can0" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" )
  alias( "ch6:VoltageSet" )
}

record( ao, "ISEG:5230102:0:0:6:CurrentSet" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.6.CurrentSet can0" )
  field( TSE,  "-2" )
  field( PREC, "6" )
  field( SCAN, "1 second" )
  field( VAL, ".001")
  field( PINI, "YES")
  alias( "ch6:CurrentSet" )
}

record( ai, "ISEG:5230102:0:0:6:VoltageMeasure" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.6.VoltageMeasure can0" )
  field( FLNK, "ISEG:5230102:0:0:6:CurrentMeasure" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" )
  alias( "ch6:VoltageMeasure" )
}

record( ai, "ISEG:5230102:0:0:6:CurrentMeasure" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.6.CurrentMeasure can0" )
  field( FLNK, "ISEG:5230102:0:0:6:Status" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" ) 
  alias( "ch6:CurrentMeasure" )
}

record( ao, "ISEG:5230102:0:0:6:VoltageBounds" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.6.VoltageBounds can0" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:6:CurrentBounds" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.6.CurrentBounds can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:0:6:VoltageNominal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.6.VoltageNominal can0" )
  field( FLNK, "ISEG:5230102:0:0:6:CurrentNominal" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:0:6:CurrentNominal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.6.CurrentNominal can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:0:6:TemperatureExternal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.6.TemperatureExternal can0" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:6:VctCoefficient" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.6.VctCoefficient can0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:0:6:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.6.Status can0" )
  field( FLNK, "ISEG:5230102:0:0:6:EventStatus" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:0:6:Control:setOn" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.6.Control:3 can0" )
  field( ZNAM, "Channel off" )
  field( ONAM, "Channel on" )
  field( TSE,  "-2" )
  alias( "ch6:setOn" )
}

record( bo, "ISEG:5230102:0:0:6:Control:setEmergency" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.6.Control:5 can0" )
  field( ZNAM, "" )
  field( ONAM, "Set EMCY" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:0:6:EventStatus" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.6.EventStatus can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:0:6:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.6.EventMask can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:0:6:DelayedTripAction" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.6.DelayedTripAction can0" )
  field( FLNK, "ISEG:5230102:0:0:6:DelayedTripTime" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:6:DelayedTripTime" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.6.DelayedTripTime can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:0:6:ExternalInhibitAction" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.6.ExternalInhibitAction can0" )
  field( TSE,  "-2" )
}

######################################
# ### Decoding of Channel Status ### #
######################################
record( bi, "ISEG:5230102:0:0:6:InputError" ) {
  field( INP,  "ISEG:5230102:0:0:6:Status.B2 CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Input Error" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:0:6:isOn" ) {
  field( INP,  "ISEG:5230102:0:0:6:Status.B3 CP can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "1 second" )
  alias( "ch6:isOn" ) 
}

record( bi, "ISEG:5230102:0:0:6:isVoltageRamp" ) {
  field( INP,  "ISEG:5230102:0:0:6:Status.B4 CP can0" )
  field( ZNAM, "stable" )
  field( ONAM, "ramping" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:6:isEmergency" ) {
  field( INP,  "ISEG:5230102:0:0:6:Status.B5 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:6:isCC" ) {
  field( INP,  "ISEG:5230102:0:0:6:Status.B6 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
  field( SCAN,  "1 second" )
}

record( bi, "ISEG:5230102:0:0:6:isCV" ) {
  field( INP,  "ISEG:5230102:0:0:6:Status.B7 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "1 second" )
}

record( bi, "ISEG:5230102:0:0:6:isCurrentBound" ) {
  field( INP,  "ISEG:5230102:0:0:6:Status.BA CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Out of bounds" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:6:isVoltageBound" ) {
  field( INP,  "ISEG:5230102:0:0:6:Status.BB CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Out of bounds" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:6:isEventInhibit" ) {
  field( INP,  "ISEG:5230102:0:0:6:Status.BC CP can0" )
  field( ZNAM, "no" )
  field( ONAM, "yes" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:6:isTrip" ) {
  field( INP,  "ISEG:5230102:0:0:6:Status.BD CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "tripped" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:6:isCurrentLimit" ) {
  field( INP,  "ISEG:5230102:0:0:6:Status.BE CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "exceeded" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:6:isVoltageLimit" ) {
  field( INP,  "ISEG:5230102:0:0:6:Status.BF CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "exceeded" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

############################################
# ### Decoding of Channel Event Status ### #
############################################
record( bi, "ISEG:5230102:0:0:6:EventInputError" ) {
  field( INP,  "ISEG:5230102:0:0:6:EventStatus.B2 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:0:6:EOn2Off" ) {
  field( INP,  "ISEG:5230102:0:0:6:EventStatus.B3 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:6:EventEndOfRamp" ) {
  field( INP,  "ISEG:5230102:0:0:6:EventStatus.B4 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:6:EventEmergency" ) {
  field( INP,  "ISEG:5230102:0:0:6:EventStatus.B5 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:6:ECC" ) {
  field( INP,  "ISEG:5230102:0:0:6:EventStatus.B6 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:6:ECV" ) {
  field( INP,  "ISEG:5230102:0:0:6:EventStatus.B7 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:6:ECurrentBounds" ) {
  field( INP,  "ISEG:5230102:0:0:6:EventStatus.BA CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:6:EVVoltageBounds" ) {
  field( INP,  "ISEG:5230102:0:0:6:EventStatus.BB CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:6:EventExternalInhibit" ) {
  field( INP,  "ISEG:5230102:0:0:6:EventStatus.BC CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:6:EventTrip" ) {
  field( INP,  "ISEG:5230102:0:0:6:EventStatus.BD CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:6:EventCurrentLimit" ) {
  field( INP,  "ISEG:5230102:0:0:6:EventStatus.BE CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:6:EventVoltageLimit" ) {
  field( INP,  "ISEG:5230102:0:0:6:EventStatus.BF CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

#######################################################################
# ###                                                             ### #
# ### EPICS Database for                                          ### #
# ###   iseg HAL                                                  ### #
# ###                                                             ### #
# ### author: J. Roemer, F.Feldbauer                              ### #
# ###                                                             ### #
# ###                                                             ### #
# ### macros: CONTROLLER_SN    serial number of crate controller  ### #
# ###         CAN_LINE    CAN line ID                             ### #
# ###         CRATE_ID    crate address                           ### #
# ###         MODULE_ID   module address                          ### #
# ###         CHANNEL_ID  HV channel address                      ### #
#######################################################################
# ###    Modified: 8-21-2018 PR     ### #
# ###    Fixes interlock PVs           ### #
# ###    1 Alias           	            ### #
#test
#######################################################################

###############################
# ### CAN_System item values ##
###############################

record( stringin, "ISEG:5230102:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@Status can0" )	
  field( FLNK, "ISEG:5230102:BitRate" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:BitRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@BitRate can0" )
  field( TSE,  "-2" )
}	

record( longin, "ISEG:5230102:ModuleNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@ModuleNumber can0" )
  field( FLNK, "ISEG:5230102:CrateNumber" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:CrateNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CrateNumber can0" )
  field( FLNK, "ISEG:5230102:CrateList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:CrateList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CrateList can0" )
  field( FLNK, "ISEG:5230102:CycleCounter" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:CycleCounter" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CycleCounter can0" )
  field( TSE,  "-2" )
}

#############################
# ### CAN_Line item values ##
#############################

record( stringin, "ISEG:5230102:0:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.Status can0" )
  field( FLNK, "ISEG:5230102:0:BitRate" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:BitRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.BitRate can0" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:ModuleNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.ModuleNumber can0" )
  field( FLNK, "ISEG:5230102:0:ModuleList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:ModuleList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.ModuleList can0" )
  field( FLNK, "ISEG:5230102:0:CrateNumber" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:CrateNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.CrateNumber can0" )
  field( FLNK, "ISEG:5230102:0:CrateList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:CrateList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.CrateList can0" )
  field( TSE,  "-2" )
}

#############################
# ### Crate item values ### #
#############################

record( mbbiDirect, "ISEG:5230102:0:1000:StatusLow" ) {
  field( DESC, "Lower 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Status can0" )
  field( NOBT, "16" )
  field( SHFT, "0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1000:StatusHigh" ) {
  field( DESC, "Upper 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Status can0" )
  field( NOBT, "16" )
  field( SHFT, "16" )  ## shift the value by 16 bits to the right
  field( TSE,  "-2" )
}

# Alternative way to read out the status:
# In this case only the calc record needs to be triggered

#record( longin, "ISEG:5230102:0:1000:StatusRead__" ) {
#  field( DTYP, "isegHAL" )
#  field( INP,  "@0.1000.Status can0" )
#}
#record( calc, "ISEG:5230102:0:1000:StatusSplit__" ) {
#  ## PP = Passive Process: Force the other record to process before sending the value
#  field( INPA, "ISEG:5230102:0:1000:StatusRead PP" )
#
#  field( INPB, "0x0000ffff" )
#  field( INPC, "0xffff0000" )
#
#  ## First, set field D to ( field A bitwise AND field B ),
#  ## then set field VAL to ( field A bitwise AND field C ) right shifted by 16 bit
#  field( CALC, "d:=(A&B); (A&C)>>16" )
#}
#record( mbbiDirect, "ISEG:5230102:0:1000:StatusLow" ) {
#  field( DTYP, "Soft Channel" )
#  field( INP,  "ISEG:5230102:0:1000:StatusSplit__.D CP" )
#}
#record( mbbiDirect, "ISEG:5230102:0:1000:StatusHigh" ) {
#  field( DTYP, "Soft Channel" )
#  field( INP,  "ISEG:5230102:0:1000:StatusSplit__.VAL CP" )
#}

record( mbbiDirect, "ISEG:5230102:0:1000:EventStatusLow" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.EventStatus can0" )
  field( NOBT, "16" )
  field( SHFT, "0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1000:EventStatusHigh" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.EventStatus can0" )
  field( NOBT, "16" )
  field( SHFT, "16" )
  field( TSE,  "-2" )
}
record( longout, "ISEG:5230102:0:1000:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.EventMask can0" )
  field( TSE,  "-2" )
}
record( ai, "ISEG:5230102:0:1000:FanSpeed" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FanSpeed can0" )
  field( TSE,  "-2" )
  field( SCAN, "1 second")
}

record( bo, "ISEG:5230102:0:1000:Control:0" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.Control:0 can0" )
  field( ZNAM, "" )
  field( ONAM, "doClear" )
  field( TSE,  "-2" )
}


record( longin, "ISEG:5230102:0:1000:SerialNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.SerialNumber can0" )
  field( TSE,  "-2" )
  field( SCAN,  "1 second" )
}

record( bo, "ISEG:5230102:0:1000:PowerOn" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.PowerOn can0" )
  field( TSE,  "-2" )
  field( ZNAM, "Off" )
  field( ONAM, "On" )
}

record( stringin, "ISEG:5230102:0:1000:FirmwareRelease" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FirmwareRelease can0" )
  field( FLNK, "ISEG:5230102:0:1000:FirmwareName" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1000:FirmwareName" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FirmwareName can0" )
  field( FLNK, "ISEG:5230102:0:1000:Article" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1000:Article" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Article can0" )
  field( TSE,  "-2" )
}


##############################
# ### Module item values ### #
##############################

record( mbbiDirect, "ISEG:5230102:0:0:Status" ) {
  field( DESC, "Lower 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( DISV, "0" )  ## Disable Value (if value linked by SDIS == DISV record is disabled)
  field( SDIS, "ISEG:5230102:0:1000:PowerOn.VAL NPP MS" )
  field( INP,  "@0.0.Status can0" )
  field( FLNK, "ISEG:5230102:0:0:EventStatus" ) ## Build read out chains
  field( TSE,  "-2" )
  field( SCAN,  "1 second" )
}

record( mbbiDirect, "ISEG:5230102:0:0:EventStatus" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.EventStatus can0" )
  field( FLNK, "ISEG:5230102:0:0:EventMask" )
  field( TSE,  "-2" )
}
record( longout, "ISEG:5230102:0:0:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.EventMask can0" )
  field( FLNK, "ISEG:5230102:0:0:Temperature" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:0:Control:doClear" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.Control:6 can0" )
  field( ZNAM, "" )
  field( ONAM, "doClear" )
  field( TSE,  "-2" )
  alias( "ch7:doClear" )
}

record( bo, "ISEG:5230102:0:0:Control:setFineAdjustment" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.Control:12 can0" )
  field( ZNAM, "FineAdjustment off" )
  field( ONAM, "FineAdjustment on" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:0:Control:setKillEnable" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.Control:14 can0" )
  field( ZNAM, "KillEnable off" )
  field( ONAM, "KillEnable on" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:VoltageRampSpeed" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.VoltageRampSpeed can0" )
  field( FLNK, "ISEG:5230102:0:0:CurrentRampSpeed" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:CurrentRampSpeed" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.CurrentRampSpeed can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:0:VoltageLimit" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.VoltageLimit can0" )
  field( FLNK, "ISEG:5230102:0:0:CurrentLimit" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( ai, "ISEG:5230102:0:0:CurrentLimit" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.CurrentLimit can0" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( ai, "ISEG:5230102:0:0:Temperature" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.Temperature can0" )
  field( TSE,  "-2" )
  field( SCAN, "1 second")
}

record( longin, "ISEG:5230102:0:0:SerialNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.SerialNumber can0" )
  field( FLNK, "ISEG:5230102:0:0:ChannelNumber" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( longin, "ISEG:5230102:0:0:ChannelNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.ChannelNumber can0" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:0:SampleRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.SampleRate can0" )
  field( FLNK, "ISEG:5230102:0:0:DigitalFilter" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:0:DigitalFilter" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.DigitalFilter can0" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:0:FirmwareRelease" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.FirmwareRelease can0" )
  field( FLNK, "ISEG:5230102:0:0:FirmwareName" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:0:FirmwareName" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.FirmwareName can0" )
  field( FLNK, "ISEG:5230102:0:0:Article" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:0:Article" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.Article can0" )
  field( TSE,  "-2" )
}

#####################################
# ### Decoding of Module Status ### #
#####################################

record( bi, "ISEG:5230102:0:0:isAdjustment" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B0 can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:Status:isLiveInsertion" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B2 can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:needService" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B4 can0" )
  field( ZNAM, "ok" )
  field( ONAM, "Hardware failure detected" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:isInputError" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B6 CP can0" )
  field( ZNAM, "ok" )
  field( ONAM, "Error" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:0:isNoSumError" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B8 CP can0" )
  field( ZNAM, "Error" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isNoRamp" ) {
  field( INP,  "ISEG:5230102:0:0:Status.B9 CP can0" )
  field( ZNAM, "channel is ramping" )
  field( ONAM, "all channels stable" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isSafetyLoopGood" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BA CP can0" )
  field( ZNAM, "broken" )
  field( ONAM, "closed" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "Passive" )
  alias( "ch7:isSafetyLoopGood" )  
}

record( bi, "ISEG:5230102:0:0:isEVentActive" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BB CP can0" )
  field( ZNAM, "no active Event" )
  field( ONAM, "any event active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isModuleGood" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BC CP can0" )
  field( ZNAM, "failure" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isSuppliesGodd" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BD CP can0" )
  field( ZNAM, "Out of Range" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isTemperatureGood" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BE CP can0" )
  field( ZNAM, "above 55 degC" )
  field( ONAM, "within range" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:isKillEnable" ) {
  field( INP,  "ISEG:5230102:0:0:Status.BF can0" )
  field( ZNAM, "disabled" )
  field( ONAM, "enabled" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

###########################################
# ### Decoding of Module Event Status ### #
###########################################
record( bi, "ISEG:5230102:0:0:EventLiveInsertion" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.B2 CP can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:EventService" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.B4 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Hardware failure detected" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:EventInputError" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.B6 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Input Error in connection" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:EventSafetyLoopNotGood" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.BA CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Safety loop open" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
  alias( "ch7:EventSafetyLoopNotGood" )
}

record( bi, "ISEG:5230102:0:0:EventSuppliesNotGood" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.BD CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Supply is not good" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:EventTemperatureNotGood" ) {
  field( INP,  "ISEG:5230102:0:0:EventStatus.BD CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Temperature above 55 degC" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

###############################
# ### Channel item values ### #
###############################

record( ao, "ISEG:5230102:0:0:7:VoltageSet" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.7.VoltageSet can0" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" )
  alias( "ch7:VoltageSet" )
}

record( ao, "ISEG:5230102:0:0:7:CurrentSet" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.7.CurrentSet can0" )
  field( TSE,  "-2" )
  field( PREC, "6" )
  field( SCAN, "1 second" )
  field( VAL, ".001")
  field( PINI, "YES")
  alias( "ch7:CurrentSet" )
}

record( ai, "ISEG:5230102:0:0:7:VoltageMeasure" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.7.VoltageMeasure can0" )
  field( FLNK, "ISEG:5230102:0:0:7:CurrentMeasure" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" )
  alias( "ch7:VoltageMeasure" )
}

record( ai, "ISEG:5230102:0:0:7:CurrentMeasure" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.7.CurrentMeasure can0" )
  field( FLNK, "ISEG:5230102:0:0:7:Status" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" ) 
  alias( "ch7:CurrentMeasure" )
}

record( ao, "ISEG:5230102:0:0:7:VoltageBounds" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.7.VoltageBounds can0" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:7:CurrentBounds" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.7.CurrentBounds can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:0:7:VoltageNominal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.7.VoltageNominal can0" )
  field( FLNK, "ISEG:5230102:0:0:7:CurrentNominal" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:0:7:CurrentNominal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.7.CurrentNominal can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:0:7:TemperatureExternal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.7.TemperatureExternal can0" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:7:VctCoefficient" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.7.VctCoefficient can0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:0:7:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.7.Status can0" )
  field( FLNK, "ISEG:5230102:0:0:7:EventStatus" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:0:7:Control:setOn" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.7.Control:3 can0" )
  field( ZNAM, "Channel off" )
  field( ONAM, "Channel on" )
  field( TSE,  "-2" )
  alias( "ch7:setOn" )
}

record( bo, "ISEG:5230102:0:0:7:Control:setEmergency" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.7.Control:5 can0" )
  field( ZNAM, "" )
  field( ONAM, "Set EMCY" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:0:7:EventStatus" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.0.7.EventStatus can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:0:7:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.7.EventMask can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:0:7:DelayedTripAction" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.7.DelayedTripAction can0" )
  field( FLNK, "ISEG:5230102:0:0:7:DelayedTripTime" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:0:7:DelayedTripTime" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.7.DelayedTripTime can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:0:7:ExternalInhibitAction" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.0.7.ExternalInhibitAction can0" )
  field( TSE,  "-2" )
}

######################################
# ### Decoding of Channel Status ### #
######################################
record( bi, "ISEG:5230102:0:0:7:InputError" ) {
  field( INP,  "ISEG:5230102:0:0:7:Status.B2 CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Input Error" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:0:7:isOn" ) {
  field( INP,  "ISEG:5230102:0:0:7:Status.B3 CP can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "1 second" )
  alias( "ch7:isOn" ) 
}

record( bi, "ISEG:5230102:0:0:7:isVoltageRamp" ) {
  field( INP,  "ISEG:5230102:0:0:7:Status.B4 CP can0" )
  field( ZNAM, "stable" )
  field( ONAM, "ramping" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:7:isEmergency" ) {
  field( INP,  "ISEG:5230102:0:0:7:Status.B5 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:7:isCC" ) {
  field( INP,  "ISEG:5230102:0:0:7:Status.B6 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
  field( SCAN,  "1 second" )
}

record( bi, "ISEG:5230102:0:0:7:isCV" ) {
  field( INP,  "ISEG:5230102:0:0:7:Status.B7 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "1 second" )
}

record( bi, "ISEG:5230102:0:0:7:isCurrentBound" ) {
  field( INP,  "ISEG:5230102:0:0:7:Status.BA CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Out of bounds" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:7:isVoltageBound" ) {
  field( INP,  "ISEG:5230102:0:0:7:Status.BB CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Out of bounds" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:7:isEventInhibit" ) {
  field( INP,  "ISEG:5230102:0:0:7:Status.BC CP can0" )
  field( ZNAM, "no" )
  field( ONAM, "yes" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:7:isTrip" ) {
  field( INP,  "ISEG:5230102:0:0:7:Status.BD CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "tripped" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:7:isCurrentLimit" ) {
  field( INP,  "ISEG:5230102:0:0:7:Status.BE CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "exceeded" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:7:isVoltageLimit" ) {
  field( INP,  "ISEG:5230102:0:0:7:Status.BF CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "exceeded" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

############################################
# ### Decoding of Channel Event Status ### #
############################################
record( bi, "ISEG:5230102:0:0:7:EventInputError" ) {
  field( INP,  "ISEG:5230102:0:0:7:EventStatus.B2 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:0:7:EOn2Off" ) {
  field( INP,  "ISEG:5230102:0:0:7:EventStatus.B3 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:7:EventEndOfRamp" ) {
  field( INP,  "ISEG:5230102:0:0:7:EventStatus.B4 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:7:EventEmergency" ) {
  field( INP,  "ISEG:5230102:0:0:7:EventStatus.B5 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:7:ECC" ) {
  field( INP,  "ISEG:5230102:0:0:7:EventStatus.B6 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:7:ECV" ) {
  field( INP,  "ISEG:5230102:0:0:7:EventStatus.B7 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:0:7:ECurrentBounds" ) {
  field( INP,  "ISEG:5230102:0:0:7:EventStatus.BA CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:7:EVVoltageBounds" ) {
  field( INP,  "ISEG:5230102:0:0:7:EventStatus.BB CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:7:EventExternalInhibit" ) {
  field( INP,  "ISEG:5230102:0:0:7:EventStatus.BC CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:7:EventTrip" ) {
  field( INP,  "ISEG:5230102:0:0:7:EventStatus.BD CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:7:EventCurrentLimit" ) {
  field( INP,  "ISEG:5230102:0:0:7:EventStatus.BE CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:0:7:EventVoltageLimit" ) {
  field( INP,  "ISEG:5230102:0:0:7:EventStatus.BF CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

#######################################################################
# ###                                                             ### #
# ### EPICS Database for                                          ### #
# ###   iseg HAL                                                  ### #
# ###                                                             ### #
# ### author: J. Roemer, F.Feldbauer                              ### #
# ###                                                             ### #
# ###                                                             ### #
# ### macros: CONTROLLER_SN    serial number of crate controller  ### #
# ###         CAN_LINE    CAN line ID                             ### #
# ###         CRATE_ID    crate address                           ### #
# ###         MODULE_ID   module address                          ### #
# ###         CHANNEL_ID  HV channel address                      ### #
#######################################################################
# ###    Modified: 8-21-2018 PR     ### #
# ###    Fixes interlock PVs           ### #
# ###    1 Alias           	            ### #
#test
#######################################################################

###############################
# ### CAN_System item values ##
###############################

record( stringin, "ISEG:5230102:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@Status can0" )	
  field( FLNK, "ISEG:5230102:BitRate" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:BitRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@BitRate can0" )
  field( TSE,  "-2" )
}	

record( longin, "ISEG:5230102:ModuleNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@ModuleNumber can0" )
  field( FLNK, "ISEG:5230102:CrateNumber" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:CrateNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CrateNumber can0" )
  field( FLNK, "ISEG:5230102:CrateList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:CrateList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CrateList can0" )
  field( FLNK, "ISEG:5230102:CycleCounter" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:CycleCounter" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CycleCounter can0" )
  field( TSE,  "-2" )
}

#############################
# ### CAN_Line item values ##
#############################

record( stringin, "ISEG:5230102:0:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.Status can0" )
  field( FLNK, "ISEG:5230102:0:BitRate" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:BitRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.BitRate can0" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:ModuleNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.ModuleNumber can0" )
  field( FLNK, "ISEG:5230102:0:ModuleList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:ModuleList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.ModuleList can0" )
  field( FLNK, "ISEG:5230102:0:CrateNumber" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:CrateNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.CrateNumber can0" )
  field( FLNK, "ISEG:5230102:0:CrateList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:CrateList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.CrateList can0" )
  field( TSE,  "-2" )
}

#############################
# ### Crate item values ### #
#############################

record( mbbiDirect, "ISEG:5230102:0:1000:StatusLow" ) {
  field( DESC, "Lower 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Status can0" )
  field( NOBT, "16" )
  field( SHFT, "0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1000:StatusHigh" ) {
  field( DESC, "Upper 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Status can0" )
  field( NOBT, "16" )
  field( SHFT, "16" )  ## shift the value by 16 bits to the right
  field( TSE,  "-2" )
}

# Alternative way to read out the status:
# In this case only the calc record needs to be triggered

#record( longin, "ISEG:5230102:0:1000:StatusRead__" ) {
#  field( DTYP, "isegHAL" )
#  field( INP,  "@0.1000.Status can0" )
#}
#record( calc, "ISEG:5230102:0:1000:StatusSplit__" ) {
#  ## PP = Passive Process: Force the other record to process before sending the value
#  field( INPA, "ISEG:5230102:0:1000:StatusRead PP" )
#
#  field( INPB, "0x0000ffff" )
#  field( INPC, "0xffff0000" )
#
#  ## First, set field D to ( field A bitwise AND field B ),
#  ## then set field VAL to ( field A bitwise AND field C ) right shifted by 16 bit
#  field( CALC, "d:=(A&B); (A&C)>>16" )
#}
#record( mbbiDirect, "ISEG:5230102:0:1000:StatusLow" ) {
#  field( DTYP, "Soft Channel" )
#  field( INP,  "ISEG:5230102:0:1000:StatusSplit__.D CP" )
#}
#record( mbbiDirect, "ISEG:5230102:0:1000:StatusHigh" ) {
#  field( DTYP, "Soft Channel" )
#  field( INP,  "ISEG:5230102:0:1000:StatusSplit__.VAL CP" )
#}

record( mbbiDirect, "ISEG:5230102:0:1000:EventStatusLow" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.EventStatus can0" )
  field( NOBT, "16" )
  field( SHFT, "0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1000:EventStatusHigh" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.EventStatus can0" )
  field( NOBT, "16" )
  field( SHFT, "16" )
  field( TSE,  "-2" )
}
record( longout, "ISEG:5230102:0:1000:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.EventMask can0" )
  field( TSE,  "-2" )
}
record( ai, "ISEG:5230102:0:1000:FanSpeed" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FanSpeed can0" )
  field( TSE,  "-2" )
  field( SCAN, "1 second")
}

record( bo, "ISEG:5230102:0:1000:Control:0" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.Control:0 can0" )
  field( ZNAM, "" )
  field( ONAM, "doClear" )
  field( TSE,  "-2" )
}


record( longin, "ISEG:5230102:0:1000:SerialNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.SerialNumber can0" )
  field( TSE,  "-2" )
  field( SCAN,  "1 second" )
}

record( bo, "ISEG:5230102:0:1000:PowerOn" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.PowerOn can0" )
  field( TSE,  "-2" )
  field( ZNAM, "Off" )
  field( ONAM, "On" )
}

record( stringin, "ISEG:5230102:0:1000:FirmwareRelease" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FirmwareRelease can0" )
  field( FLNK, "ISEG:5230102:0:1000:FirmwareName" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1000:FirmwareName" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FirmwareName can0" )
  field( FLNK, "ISEG:5230102:0:1000:Article" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1000:Article" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Article can0" )
  field( TSE,  "-2" )
}


##############################
# ### Module item values ### #
##############################

record( mbbiDirect, "ISEG:5230102:0:1:Status" ) {
  field( DESC, "Lower 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( DISV, "0" )  ## Disable Value (if value linked by SDIS == DISV record is disabled)
  field( SDIS, "ISEG:5230102:0:1000:PowerOn.VAL NPP MS" )
  field( INP,  "@0.1.Status can0" )
  field( FLNK, "ISEG:5230102:0:1:EventStatus" ) ## Build read out chains
  field( TSE,  "-2" )
  field( SCAN,  "1 second" )
}

record( mbbiDirect, "ISEG:5230102:0:1:EventStatus" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.EventStatus can0" )
  field( FLNK, "ISEG:5230102:0:1:EventMask" )
  field( TSE,  "-2" )
}
record( longout, "ISEG:5230102:0:1:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.EventMask can0" )
  field( FLNK, "ISEG:5230102:0:1:Temperature" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:1:Control:doClear" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.Control:6 can0" )
  field( ZNAM, "" )
  field( ONAM, "doClear" )
  field( TSE,  "-2" )
  alias( "ch8:doClear" )
}

record( bo, "ISEG:5230102:0:1:Control:setFineAdjustment" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.Control:12 can0" )
  field( ZNAM, "FineAdjustment off" )
  field( ONAM, "FineAdjustment on" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:1:Control:setKillEnable" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.Control:14 can0" )
  field( ZNAM, "KillEnable off" )
  field( ONAM, "KillEnable on" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:VoltageRampSpeed" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.VoltageRampSpeed can0" )
  field( FLNK, "ISEG:5230102:0:1:CurrentRampSpeed" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:CurrentRampSpeed" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.CurrentRampSpeed can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:1:VoltageLimit" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.VoltageLimit can0" )
  field( FLNK, "ISEG:5230102:0:1:CurrentLimit" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( ai, "ISEG:5230102:0:1:CurrentLimit" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.CurrentLimit can0" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( ai, "ISEG:5230102:0:1:Temperature" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.Temperature can0" )
  field( TSE,  "-2" )
  field( SCAN, "1 second")
}

record( longin, "ISEG:5230102:0:1:SerialNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.SerialNumber can0" )
  field( FLNK, "ISEG:5230102:0:1:ChannelNumber" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( longin, "ISEG:5230102:0:1:ChannelNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.ChannelNumber can0" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:1:SampleRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.SampleRate can0" )
  field( FLNK, "ISEG:5230102:0:1:DigitalFilter" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:1:DigitalFilter" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.DigitalFilter can0" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:1:FirmwareRelease" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.FirmwareRelease can0" )
  field( FLNK, "ISEG:5230102:0:1:FirmwareName" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1:FirmwareName" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.FirmwareName can0" )
  field( FLNK, "ISEG:5230102:0:1:Article" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1:Article" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.Article can0" )
  field( TSE,  "-2" )
}

#####################################
# ### Decoding of Module Status ### #
#####################################

record( bi, "ISEG:5230102:0:1:isAdjustment" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B0 can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:Status:isLiveInsertion" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B2 can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:needService" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B4 can0" )
  field( ZNAM, "ok" )
  field( ONAM, "Hardware failure detected" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:isInputError" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B6 CP can0" )
  field( ZNAM, "ok" )
  field( ONAM, "Error" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:1:isNoSumError" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B8 CP can0" )
  field( ZNAM, "Error" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isNoRamp" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B9 CP can0" )
  field( ZNAM, "channel is ramping" )
  field( ONAM, "all channels stable" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isSafetyLoopGood" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BA CP can0" )
  field( ZNAM, "broken" )
  field( ONAM, "closed" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "Passive" )
  alias( "ch8:isSafetyLoopGood" )  
}

record( bi, "ISEG:5230102:0:1:isEVentActive" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BB CP can0" )
  field( ZNAM, "no active Event" )
  field( ONAM, "any event active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isModuleGood" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BC CP can0" )
  field( ZNAM, "failure" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isSuppliesGodd" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BD CP can0" )
  field( ZNAM, "Out of Range" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isTemperatureGood" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BE CP can0" )
  field( ZNAM, "above 55 degC" )
  field( ONAM, "within range" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isKillEnable" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BF can0" )
  field( ZNAM, "disabled" )
  field( ONAM, "enabled" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

###########################################
# ### Decoding of Module Event Status ### #
###########################################
record( bi, "ISEG:5230102:0:1:EventLiveInsertion" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.B2 CP can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:EventService" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.B4 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Hardware failure detected" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:EventInputError" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.B6 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Input Error in connection" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:EventSafetyLoopNotGood" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.BA CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Safety loop open" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
  alias( "ch8:EventSafetyLoopNotGood" )
}

record( bi, "ISEG:5230102:0:1:EventSuppliesNotGood" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.BD CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Supply is not good" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:EventTemperatureNotGood" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.BD CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Temperature above 55 degC" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

###############################
# ### Channel item values ### #
###############################

record( ao, "ISEG:5230102:0:1:0:VoltageSet" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.0.VoltageSet can0" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" )
  alias( "ch8:VoltageSet" )
}

record( ao, "ISEG:5230102:0:1:0:CurrentSet" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.0.CurrentSet can0" )
  field( TSE,  "-2" )
  field( PREC, "6" )
  field( SCAN, "1 second" )
  field( VAL, ".001")
  field( PINI, "YES")
  alias( "ch8:CurrentSet" )
}

record( ai, "ISEG:5230102:0:1:0:VoltageMeasure" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.0.VoltageMeasure can0" )
  field( FLNK, "ISEG:5230102:0:1:0:CurrentMeasure" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" )
  alias( "ch8:VoltageMeasure" )
}

record( ai, "ISEG:5230102:0:1:0:CurrentMeasure" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.0.CurrentMeasure can0" )
  field( FLNK, "ISEG:5230102:0:1:0:Status" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" ) 
  alias( "ch8:CurrentMeasure" )
}

record( ao, "ISEG:5230102:0:1:0:VoltageBounds" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.0.VoltageBounds can0" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:0:CurrentBounds" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.0.CurrentBounds can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:1:0:VoltageNominal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.0.VoltageNominal can0" )
  field( FLNK, "ISEG:5230102:0:1:0:CurrentNominal" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:1:0:CurrentNominal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.0.CurrentNominal can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:1:0:TemperatureExternal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.0.TemperatureExternal can0" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:0:VctCoefficient" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.0.VctCoefficient can0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1:0:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.0.Status can0" )
  field( FLNK, "ISEG:5230102:0:1:0:EventStatus" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:1:0:Control:setOn" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.0.Control:3 can0" )
  field( ZNAM, "Channel off" )
  field( ONAM, "Channel on" )
  field( TSE,  "-2" )
  alias( "ch8:setOn" )
}

record( bo, "ISEG:5230102:0:1:0:Control:setEmergency" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.0.Control:5 can0" )
  field( ZNAM, "" )
  field( ONAM, "Set EMCY" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1:0:EventStatus" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.0.EventStatus can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:1:0:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.0.EventMask can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:1:0:DelayedTripAction" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.0.DelayedTripAction can0" )
  field( FLNK, "ISEG:5230102:0:1:0:DelayedTripTime" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:0:DelayedTripTime" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.0.DelayedTripTime can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:1:0:ExternalInhibitAction" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.0.ExternalInhibitAction can0" )
  field( TSE,  "-2" )
}

######################################
# ### Decoding of Channel Status ### #
######################################
record( bi, "ISEG:5230102:0:1:0:InputError" ) {
  field( INP,  "ISEG:5230102:0:1:0:Status.B2 CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Input Error" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:1:0:isOn" ) {
  field( INP,  "ISEG:5230102:0:1:0:Status.B3 CP can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "1 second" )
  alias( "ch8:isOn" ) 
}

record( bi, "ISEG:5230102:0:1:0:isVoltageRamp" ) {
  field( INP,  "ISEG:5230102:0:1:0:Status.B4 CP can0" )
  field( ZNAM, "stable" )
  field( ONAM, "ramping" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:0:isEmergency" ) {
  field( INP,  "ISEG:5230102:0:1:0:Status.B5 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:0:isCC" ) {
  field( INP,  "ISEG:5230102:0:1:0:Status.B6 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
  field( SCAN,  "1 second" )
}

record( bi, "ISEG:5230102:0:1:0:isCV" ) {
  field( INP,  "ISEG:5230102:0:1:0:Status.B7 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "1 second" )
}

record( bi, "ISEG:5230102:0:1:0:isCurrentBound" ) {
  field( INP,  "ISEG:5230102:0:1:0:Status.BA CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Out of bounds" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:0:isVoltageBound" ) {
  field( INP,  "ISEG:5230102:0:1:0:Status.BB CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Out of bounds" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:0:isEventInhibit" ) {
  field( INP,  "ISEG:5230102:0:1:0:Status.BC CP can0" )
  field( ZNAM, "no" )
  field( ONAM, "yes" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:0:isTrip" ) {
  field( INP,  "ISEG:5230102:0:1:0:Status.BD CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "tripped" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:0:isCurrentLimit" ) {
  field( INP,  "ISEG:5230102:0:1:0:Status.BE CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "exceeded" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:0:isVoltageLimit" ) {
  field( INP,  "ISEG:5230102:0:1:0:Status.BF CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "exceeded" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

############################################
# ### Decoding of Channel Event Status ### #
############################################
record( bi, "ISEG:5230102:0:1:0:EventInputError" ) {
  field( INP,  "ISEG:5230102:0:1:0:EventStatus.B2 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:1:0:EOn2Off" ) {
  field( INP,  "ISEG:5230102:0:1:0:EventStatus.B3 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:0:EventEndOfRamp" ) {
  field( INP,  "ISEG:5230102:0:1:0:EventStatus.B4 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:0:EventEmergency" ) {
  field( INP,  "ISEG:5230102:0:1:0:EventStatus.B5 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:0:ECC" ) {
  field( INP,  "ISEG:5230102:0:1:0:EventStatus.B6 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:0:ECV" ) {
  field( INP,  "ISEG:5230102:0:1:0:EventStatus.B7 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:0:ECurrentBounds" ) {
  field( INP,  "ISEG:5230102:0:1:0:EventStatus.BA CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:0:EVVoltageBounds" ) {
  field( INP,  "ISEG:5230102:0:1:0:EventStatus.BB CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:0:EventExternalInhibit" ) {
  field( INP,  "ISEG:5230102:0:1:0:EventStatus.BC CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:0:EventTrip" ) {
  field( INP,  "ISEG:5230102:0:1:0:EventStatus.BD CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:0:EventCurrentLimit" ) {
  field( INP,  "ISEG:5230102:0:1:0:EventStatus.BE CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:0:EventVoltageLimit" ) {
  field( INP,  "ISEG:5230102:0:1:0:EventStatus.BF CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

#######################################################################
# ###                                                             ### #
# ### EPICS Database for                                          ### #
# ###   iseg HAL                                                  ### #
# ###                                                             ### #
# ### author: J. Roemer, F.Feldbauer                              ### #
# ###                                                             ### #
# ###                                                             ### #
# ### macros: CONTROLLER_SN    serial number of crate controller  ### #
# ###         CAN_LINE    CAN line ID                             ### #
# ###         CRATE_ID    crate address                           ### #
# ###         MODULE_ID   module address                          ### #
# ###         CHANNEL_ID  HV channel address                      ### #
#######################################################################
# ###    Modified: 8-21-2018 PR     ### #
# ###    Fixes interlock PVs           ### #
# ###    1 Alias           	            ### #
#test
#######################################################################

###############################
# ### CAN_System item values ##
###############################

record( stringin, "ISEG:5230102:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@Status can0" )	
  field( FLNK, "ISEG:5230102:BitRate" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:BitRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@BitRate can0" )
  field( TSE,  "-2" )
}	

record( longin, "ISEG:5230102:ModuleNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@ModuleNumber can0" )
  field( FLNK, "ISEG:5230102:CrateNumber" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:CrateNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CrateNumber can0" )
  field( FLNK, "ISEG:5230102:CrateList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:CrateList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CrateList can0" )
  field( FLNK, "ISEG:5230102:CycleCounter" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:CycleCounter" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CycleCounter can0" )
  field( TSE,  "-2" )
}

#############################
# ### CAN_Line item values ##
#############################

record( stringin, "ISEG:5230102:0:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.Status can0" )
  field( FLNK, "ISEG:5230102:0:BitRate" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:BitRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.BitRate can0" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:ModuleNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.ModuleNumber can0" )
  field( FLNK, "ISEG:5230102:0:ModuleList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:ModuleList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.ModuleList can0" )
  field( FLNK, "ISEG:5230102:0:CrateNumber" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:CrateNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.CrateNumber can0" )
  field( FLNK, "ISEG:5230102:0:CrateList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:CrateList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.CrateList can0" )
  field( TSE,  "-2" )
}

#############################
# ### Crate item values ### #
#############################

record( mbbiDirect, "ISEG:5230102:0:1000:StatusLow" ) {
  field( DESC, "Lower 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Status can0" )
  field( NOBT, "16" )
  field( SHFT, "0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1000:StatusHigh" ) {
  field( DESC, "Upper 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Status can0" )
  field( NOBT, "16" )
  field( SHFT, "16" )  ## shift the value by 16 bits to the right
  field( TSE,  "-2" )
}

# Alternative way to read out the status:
# In this case only the calc record needs to be triggered

#record( longin, "ISEG:5230102:0:1000:StatusRead__" ) {
#  field( DTYP, "isegHAL" )
#  field( INP,  "@0.1000.Status can0" )
#}
#record( calc, "ISEG:5230102:0:1000:StatusSplit__" ) {
#  ## PP = Passive Process: Force the other record to process before sending the value
#  field( INPA, "ISEG:5230102:0:1000:StatusRead PP" )
#
#  field( INPB, "0x0000ffff" )
#  field( INPC, "0xffff0000" )
#
#  ## First, set field D to ( field A bitwise AND field B ),
#  ## then set field VAL to ( field A bitwise AND field C ) right shifted by 16 bit
#  field( CALC, "d:=(A&B); (A&C)>>16" )
#}
#record( mbbiDirect, "ISEG:5230102:0:1000:StatusLow" ) {
#  field( DTYP, "Soft Channel" )
#  field( INP,  "ISEG:5230102:0:1000:StatusSplit__.D CP" )
#}
#record( mbbiDirect, "ISEG:5230102:0:1000:StatusHigh" ) {
#  field( DTYP, "Soft Channel" )
#  field( INP,  "ISEG:5230102:0:1000:StatusSplit__.VAL CP" )
#}

record( mbbiDirect, "ISEG:5230102:0:1000:EventStatusLow" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.EventStatus can0" )
  field( NOBT, "16" )
  field( SHFT, "0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1000:EventStatusHigh" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.EventStatus can0" )
  field( NOBT, "16" )
  field( SHFT, "16" )
  field( TSE,  "-2" )
}
record( longout, "ISEG:5230102:0:1000:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.EventMask can0" )
  field( TSE,  "-2" )
}
record( ai, "ISEG:5230102:0:1000:FanSpeed" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FanSpeed can0" )
  field( TSE,  "-2" )
  field( SCAN, "1 second")
}

record( bo, "ISEG:5230102:0:1000:Control:0" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.Control:0 can0" )
  field( ZNAM, "" )
  field( ONAM, "doClear" )
  field( TSE,  "-2" )
}


record( longin, "ISEG:5230102:0:1000:SerialNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.SerialNumber can0" )
  field( TSE,  "-2" )
  field( SCAN,  "1 second" )
}

record( bo, "ISEG:5230102:0:1000:PowerOn" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.PowerOn can0" )
  field( TSE,  "-2" )
  field( ZNAM, "Off" )
  field( ONAM, "On" )
}

record( stringin, "ISEG:5230102:0:1000:FirmwareRelease" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FirmwareRelease can0" )
  field( FLNK, "ISEG:5230102:0:1000:FirmwareName" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1000:FirmwareName" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FirmwareName can0" )
  field( FLNK, "ISEG:5230102:0:1000:Article" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1000:Article" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Article can0" )
  field( TSE,  "-2" )
}


##############################
# ### Module item values ### #
##############################

record( mbbiDirect, "ISEG:5230102:0:1:Status" ) {
  field( DESC, "Lower 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( DISV, "0" )  ## Disable Value (if value linked by SDIS == DISV record is disabled)
  field( SDIS, "ISEG:5230102:0:1000:PowerOn.VAL NPP MS" )
  field( INP,  "@0.1.Status can0" )
  field( FLNK, "ISEG:5230102:0:1:EventStatus" ) ## Build read out chains
  field( TSE,  "-2" )
  field( SCAN,  "1 second" )
}

record( mbbiDirect, "ISEG:5230102:0:1:EventStatus" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.EventStatus can0" )
  field( FLNK, "ISEG:5230102:0:1:EventMask" )
  field( TSE,  "-2" )
}
record( longout, "ISEG:5230102:0:1:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.EventMask can0" )
  field( FLNK, "ISEG:5230102:0:1:Temperature" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:1:Control:doClear" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.Control:6 can0" )
  field( ZNAM, "" )
  field( ONAM, "doClear" )
  field( TSE,  "-2" )
  alias( "ch9:doClear" )
}

record( bo, "ISEG:5230102:0:1:Control:setFineAdjustment" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.Control:12 can0" )
  field( ZNAM, "FineAdjustment off" )
  field( ONAM, "FineAdjustment on" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:1:Control:setKillEnable" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.Control:14 can0" )
  field( ZNAM, "KillEnable off" )
  field( ONAM, "KillEnable on" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:VoltageRampSpeed" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.VoltageRampSpeed can0" )
  field( FLNK, "ISEG:5230102:0:1:CurrentRampSpeed" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:CurrentRampSpeed" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.CurrentRampSpeed can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:1:VoltageLimit" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.VoltageLimit can0" )
  field( FLNK, "ISEG:5230102:0:1:CurrentLimit" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( ai, "ISEG:5230102:0:1:CurrentLimit" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.CurrentLimit can0" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( ai, "ISEG:5230102:0:1:Temperature" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.Temperature can0" )
  field( TSE,  "-2" )
  field( SCAN, "1 second")
}

record( longin, "ISEG:5230102:0:1:SerialNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.SerialNumber can0" )
  field( FLNK, "ISEG:5230102:0:1:ChannelNumber" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( longin, "ISEG:5230102:0:1:ChannelNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.ChannelNumber can0" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:1:SampleRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.SampleRate can0" )
  field( FLNK, "ISEG:5230102:0:1:DigitalFilter" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:1:DigitalFilter" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.DigitalFilter can0" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:1:FirmwareRelease" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.FirmwareRelease can0" )
  field( FLNK, "ISEG:5230102:0:1:FirmwareName" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1:FirmwareName" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.FirmwareName can0" )
  field( FLNK, "ISEG:5230102:0:1:Article" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1:Article" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.Article can0" )
  field( TSE,  "-2" )
}

#####################################
# ### Decoding of Module Status ### #
#####################################

record( bi, "ISEG:5230102:0:1:isAdjustment" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B0 can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:Status:isLiveInsertion" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B2 can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:needService" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B4 can0" )
  field( ZNAM, "ok" )
  field( ONAM, "Hardware failure detected" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:isInputError" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B6 CP can0" )
  field( ZNAM, "ok" )
  field( ONAM, "Error" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:1:isNoSumError" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B8 CP can0" )
  field( ZNAM, "Error" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isNoRamp" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B9 CP can0" )
  field( ZNAM, "channel is ramping" )
  field( ONAM, "all channels stable" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isSafetyLoopGood" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BA CP can0" )
  field( ZNAM, "broken" )
  field( ONAM, "closed" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "Passive" )
  alias( "ch9:isSafetyLoopGood" )  
}

record( bi, "ISEG:5230102:0:1:isEVentActive" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BB CP can0" )
  field( ZNAM, "no active Event" )
  field( ONAM, "any event active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isModuleGood" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BC CP can0" )
  field( ZNAM, "failure" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isSuppliesGodd" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BD CP can0" )
  field( ZNAM, "Out of Range" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isTemperatureGood" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BE CP can0" )
  field( ZNAM, "above 55 degC" )
  field( ONAM, "within range" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isKillEnable" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BF can0" )
  field( ZNAM, "disabled" )
  field( ONAM, "enabled" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

###########################################
# ### Decoding of Module Event Status ### #
###########################################
record( bi, "ISEG:5230102:0:1:EventLiveInsertion" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.B2 CP can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:EventService" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.B4 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Hardware failure detected" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:EventInputError" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.B6 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Input Error in connection" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:EventSafetyLoopNotGood" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.BA CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Safety loop open" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
  alias( "ch9:EventSafetyLoopNotGood" )
}

record( bi, "ISEG:5230102:0:1:EventSuppliesNotGood" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.BD CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Supply is not good" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:EventTemperatureNotGood" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.BD CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Temperature above 55 degC" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

###############################
# ### Channel item values ### #
###############################

record( ao, "ISEG:5230102:0:1:1:VoltageSet" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.1.VoltageSet can0" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" )
  alias( "ch9:VoltageSet" )
}

record( ao, "ISEG:5230102:0:1:1:CurrentSet" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.1.CurrentSet can0" )
  field( TSE,  "-2" )
  field( PREC, "6" )
  field( SCAN, "1 second" )
  field( VAL, ".001")
  field( PINI, "YES")
  alias( "ch9:CurrentSet" )
}

record( ai, "ISEG:5230102:0:1:1:VoltageMeasure" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.1.VoltageMeasure can0" )
  field( FLNK, "ISEG:5230102:0:1:1:CurrentMeasure" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" )
  alias( "ch9:VoltageMeasure" )
}

record( ai, "ISEG:5230102:0:1:1:CurrentMeasure" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.1.CurrentMeasure can0" )
  field( FLNK, "ISEG:5230102:0:1:1:Status" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" ) 
  alias( "ch9:CurrentMeasure" )
}

record( ao, "ISEG:5230102:0:1:1:VoltageBounds" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.1.VoltageBounds can0" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:1:CurrentBounds" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.1.CurrentBounds can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:1:1:VoltageNominal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.1.VoltageNominal can0" )
  field( FLNK, "ISEG:5230102:0:1:1:CurrentNominal" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:1:1:CurrentNominal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.1.CurrentNominal can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:1:1:TemperatureExternal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.1.TemperatureExternal can0" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:1:VctCoefficient" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.1.VctCoefficient can0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1:1:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.1.Status can0" )
  field( FLNK, "ISEG:5230102:0:1:1:EventStatus" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:1:1:Control:setOn" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.1.Control:3 can0" )
  field( ZNAM, "Channel off" )
  field( ONAM, "Channel on" )
  field( TSE,  "-2" )
  alias( "ch9:setOn" )
}

record( bo, "ISEG:5230102:0:1:1:Control:setEmergency" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.1.Control:5 can0" )
  field( ZNAM, "" )
  field( ONAM, "Set EMCY" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1:1:EventStatus" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.1.EventStatus can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:1:1:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.1.EventMask can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:1:1:DelayedTripAction" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.1.DelayedTripAction can0" )
  field( FLNK, "ISEG:5230102:0:1:1:DelayedTripTime" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:1:DelayedTripTime" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.1.DelayedTripTime can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:1:1:ExternalInhibitAction" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.1.ExternalInhibitAction can0" )
  field( TSE,  "-2" )
}

######################################
# ### Decoding of Channel Status ### #
######################################
record( bi, "ISEG:5230102:0:1:1:InputError" ) {
  field( INP,  "ISEG:5230102:0:1:1:Status.B2 CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Input Error" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:1:1:isOn" ) {
  field( INP,  "ISEG:5230102:0:1:1:Status.B3 CP can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "1 second" )
  alias( "ch9:isOn" ) 
}

record( bi, "ISEG:5230102:0:1:1:isVoltageRamp" ) {
  field( INP,  "ISEG:5230102:0:1:1:Status.B4 CP can0" )
  field( ZNAM, "stable" )
  field( ONAM, "ramping" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:1:isEmergency" ) {
  field( INP,  "ISEG:5230102:0:1:1:Status.B5 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:1:isCC" ) {
  field( INP,  "ISEG:5230102:0:1:1:Status.B6 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
  field( SCAN,  "1 second" )
}

record( bi, "ISEG:5230102:0:1:1:isCV" ) {
  field( INP,  "ISEG:5230102:0:1:1:Status.B7 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "1 second" )
}

record( bi, "ISEG:5230102:0:1:1:isCurrentBound" ) {
  field( INP,  "ISEG:5230102:0:1:1:Status.BA CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Out of bounds" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:1:isVoltageBound" ) {
  field( INP,  "ISEG:5230102:0:1:1:Status.BB CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Out of bounds" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:1:isEventInhibit" ) {
  field( INP,  "ISEG:5230102:0:1:1:Status.BC CP can0" )
  field( ZNAM, "no" )
  field( ONAM, "yes" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:1:isTrip" ) {
  field( INP,  "ISEG:5230102:0:1:1:Status.BD CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "tripped" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:1:isCurrentLimit" ) {
  field( INP,  "ISEG:5230102:0:1:1:Status.BE CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "exceeded" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:1:isVoltageLimit" ) {
  field( INP,  "ISEG:5230102:0:1:1:Status.BF CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "exceeded" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

############################################
# ### Decoding of Channel Event Status ### #
############################################
record( bi, "ISEG:5230102:0:1:1:EventInputError" ) {
  field( INP,  "ISEG:5230102:0:1:1:EventStatus.B2 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:1:1:EOn2Off" ) {
  field( INP,  "ISEG:5230102:0:1:1:EventStatus.B3 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:1:EventEndOfRamp" ) {
  field( INP,  "ISEG:5230102:0:1:1:EventStatus.B4 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:1:EventEmergency" ) {
  field( INP,  "ISEG:5230102:0:1:1:EventStatus.B5 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:1:ECC" ) {
  field( INP,  "ISEG:5230102:0:1:1:EventStatus.B6 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:1:ECV" ) {
  field( INP,  "ISEG:5230102:0:1:1:EventStatus.B7 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:1:ECurrentBounds" ) {
  field( INP,  "ISEG:5230102:0:1:1:EventStatus.BA CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:1:EVVoltageBounds" ) {
  field( INP,  "ISEG:5230102:0:1:1:EventStatus.BB CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:1:EventExternalInhibit" ) {
  field( INP,  "ISEG:5230102:0:1:1:EventStatus.BC CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:1:EventTrip" ) {
  field( INP,  "ISEG:5230102:0:1:1:EventStatus.BD CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:1:EventCurrentLimit" ) {
  field( INP,  "ISEG:5230102:0:1:1:EventStatus.BE CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:1:EventVoltageLimit" ) {
  field( INP,  "ISEG:5230102:0:1:1:EventStatus.BF CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

#######################################################################
# ###                                                             ### #
# ### EPICS Database for                                          ### #
# ###   iseg HAL                                                  ### #
# ###                                                             ### #
# ### author: J. Roemer, F.Feldbauer                              ### #
# ###                                                             ### #
# ###                                                             ### #
# ### macros: CONTROLLER_SN    serial number of crate controller  ### #
# ###         CAN_LINE    CAN line ID                             ### #
# ###         CRATE_ID    crate address                           ### #
# ###         MODULE_ID   module address                          ### #
# ###         CHANNEL_ID  HV channel address                      ### #
#######################################################################
# ###    Modified: 8-21-2018 PR     ### #
# ###    Fixes interlock PVs           ### #
# ###    1 Alias           	            ### #
#test
#######################################################################

###############################
# ### CAN_System item values ##
###############################

record( stringin, "ISEG:5230102:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@Status can0" )	
  field( FLNK, "ISEG:5230102:BitRate" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:BitRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@BitRate can0" )
  field( TSE,  "-2" )
}	

record( longin, "ISEG:5230102:ModuleNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@ModuleNumber can0" )
  field( FLNK, "ISEG:5230102:CrateNumber" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:CrateNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CrateNumber can0" )
  field( FLNK, "ISEG:5230102:CrateList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:CrateList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CrateList can0" )
  field( FLNK, "ISEG:5230102:CycleCounter" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:CycleCounter" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CycleCounter can0" )
  field( TSE,  "-2" )
}

#############################
# ### CAN_Line item values ##
#############################

record( stringin, "ISEG:5230102:0:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.Status can0" )
  field( FLNK, "ISEG:5230102:0:BitRate" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:BitRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.BitRate can0" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:ModuleNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.ModuleNumber can0" )
  field( FLNK, "ISEG:5230102:0:ModuleList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:ModuleList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.ModuleList can0" )
  field( FLNK, "ISEG:5230102:0:CrateNumber" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:CrateNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.CrateNumber can0" )
  field( FLNK, "ISEG:5230102:0:CrateList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:CrateList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.CrateList can0" )
  field( TSE,  "-2" )
}

#############################
# ### Crate item values ### #
#############################

record( mbbiDirect, "ISEG:5230102:0:1000:StatusLow" ) {
  field( DESC, "Lower 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Status can0" )
  field( NOBT, "16" )
  field( SHFT, "0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1000:StatusHigh" ) {
  field( DESC, "Upper 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Status can0" )
  field( NOBT, "16" )
  field( SHFT, "16" )  ## shift the value by 16 bits to the right
  field( TSE,  "-2" )
}

# Alternative way to read out the status:
# In this case only the calc record needs to be triggered

#record( longin, "ISEG:5230102:0:1000:StatusRead__" ) {
#  field( DTYP, "isegHAL" )
#  field( INP,  "@0.1000.Status can0" )
#}
#record( calc, "ISEG:5230102:0:1000:StatusSplit__" ) {
#  ## PP = Passive Process: Force the other record to process before sending the value
#  field( INPA, "ISEG:5230102:0:1000:StatusRead PP" )
#
#  field( INPB, "0x0000ffff" )
#  field( INPC, "0xffff0000" )
#
#  ## First, set field D to ( field A bitwise AND field B ),
#  ## then set field VAL to ( field A bitwise AND field C ) right shifted by 16 bit
#  field( CALC, "d:=(A&B); (A&C)>>16" )
#}
#record( mbbiDirect, "ISEG:5230102:0:1000:StatusLow" ) {
#  field( DTYP, "Soft Channel" )
#  field( INP,  "ISEG:5230102:0:1000:StatusSplit__.D CP" )
#}
#record( mbbiDirect, "ISEG:5230102:0:1000:StatusHigh" ) {
#  field( DTYP, "Soft Channel" )
#  field( INP,  "ISEG:5230102:0:1000:StatusSplit__.VAL CP" )
#}

record( mbbiDirect, "ISEG:5230102:0:1000:EventStatusLow" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.EventStatus can0" )
  field( NOBT, "16" )
  field( SHFT, "0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1000:EventStatusHigh" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.EventStatus can0" )
  field( NOBT, "16" )
  field( SHFT, "16" )
  field( TSE,  "-2" )
}
record( longout, "ISEG:5230102:0:1000:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.EventMask can0" )
  field( TSE,  "-2" )
}
record( ai, "ISEG:5230102:0:1000:FanSpeed" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FanSpeed can0" )
  field( TSE,  "-2" )
  field( SCAN, "1 second")
}

record( bo, "ISEG:5230102:0:1000:Control:0" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.Control:0 can0" )
  field( ZNAM, "" )
  field( ONAM, "doClear" )
  field( TSE,  "-2" )
}


record( longin, "ISEG:5230102:0:1000:SerialNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.SerialNumber can0" )
  field( TSE,  "-2" )
  field( SCAN,  "1 second" )
}

record( bo, "ISEG:5230102:0:1000:PowerOn" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.PowerOn can0" )
  field( TSE,  "-2" )
  field( ZNAM, "Off" )
  field( ONAM, "On" )
}

record( stringin, "ISEG:5230102:0:1000:FirmwareRelease" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FirmwareRelease can0" )
  field( FLNK, "ISEG:5230102:0:1000:FirmwareName" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1000:FirmwareName" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FirmwareName can0" )
  field( FLNK, "ISEG:5230102:0:1000:Article" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1000:Article" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Article can0" )
  field( TSE,  "-2" )
}


##############################
# ### Module item values ### #
##############################

record( mbbiDirect, "ISEG:5230102:0:1:Status" ) {
  field( DESC, "Lower 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( DISV, "0" )  ## Disable Value (if value linked by SDIS == DISV record is disabled)
  field( SDIS, "ISEG:5230102:0:1000:PowerOn.VAL NPP MS" )
  field( INP,  "@0.1.Status can0" )
  field( FLNK, "ISEG:5230102:0:1:EventStatus" ) ## Build read out chains
  field( TSE,  "-2" )
  field( SCAN,  "1 second" )
}

record( mbbiDirect, "ISEG:5230102:0:1:EventStatus" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.EventStatus can0" )
  field( FLNK, "ISEG:5230102:0:1:EventMask" )
  field( TSE,  "-2" )
}
record( longout, "ISEG:5230102:0:1:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.EventMask can0" )
  field( FLNK, "ISEG:5230102:0:1:Temperature" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:1:Control:doClear" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.Control:6 can0" )
  field( ZNAM, "" )
  field( ONAM, "doClear" )
  field( TSE,  "-2" )
  alias( "ch10:doClear" )
}

record( bo, "ISEG:5230102:0:1:Control:setFineAdjustment" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.Control:12 can0" )
  field( ZNAM, "FineAdjustment off" )
  field( ONAM, "FineAdjustment on" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:1:Control:setKillEnable" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.Control:14 can0" )
  field( ZNAM, "KillEnable off" )
  field( ONAM, "KillEnable on" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:VoltageRampSpeed" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.VoltageRampSpeed can0" )
  field( FLNK, "ISEG:5230102:0:1:CurrentRampSpeed" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:CurrentRampSpeed" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.CurrentRampSpeed can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:1:VoltageLimit" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.VoltageLimit can0" )
  field( FLNK, "ISEG:5230102:0:1:CurrentLimit" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( ai, "ISEG:5230102:0:1:CurrentLimit" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.CurrentLimit can0" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( ai, "ISEG:5230102:0:1:Temperature" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.Temperature can0" )
  field( TSE,  "-2" )
  field( SCAN, "1 second")
}

record( longin, "ISEG:5230102:0:1:SerialNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.SerialNumber can0" )
  field( FLNK, "ISEG:5230102:0:1:ChannelNumber" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( longin, "ISEG:5230102:0:1:ChannelNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.ChannelNumber can0" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:1:SampleRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.SampleRate can0" )
  field( FLNK, "ISEG:5230102:0:1:DigitalFilter" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:1:DigitalFilter" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.DigitalFilter can0" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:1:FirmwareRelease" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.FirmwareRelease can0" )
  field( FLNK, "ISEG:5230102:0:1:FirmwareName" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1:FirmwareName" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.FirmwareName can0" )
  field( FLNK, "ISEG:5230102:0:1:Article" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1:Article" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.Article can0" )
  field( TSE,  "-2" )
}

#####################################
# ### Decoding of Module Status ### #
#####################################

record( bi, "ISEG:5230102:0:1:isAdjustment" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B0 can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:Status:isLiveInsertion" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B2 can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:needService" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B4 can0" )
  field( ZNAM, "ok" )
  field( ONAM, "Hardware failure detected" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:isInputError" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B6 CP can0" )
  field( ZNAM, "ok" )
  field( ONAM, "Error" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:1:isNoSumError" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B8 CP can0" )
  field( ZNAM, "Error" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isNoRamp" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B9 CP can0" )
  field( ZNAM, "channel is ramping" )
  field( ONAM, "all channels stable" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isSafetyLoopGood" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BA CP can0" )
  field( ZNAM, "broken" )
  field( ONAM, "closed" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "Passive" )
  alias( "ch10:isSafetyLoopGood" )  
}

record( bi, "ISEG:5230102:0:1:isEVentActive" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BB CP can0" )
  field( ZNAM, "no active Event" )
  field( ONAM, "any event active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isModuleGood" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BC CP can0" )
  field( ZNAM, "failure" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isSuppliesGodd" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BD CP can0" )
  field( ZNAM, "Out of Range" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isTemperatureGood" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BE CP can0" )
  field( ZNAM, "above 55 degC" )
  field( ONAM, "within range" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isKillEnable" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BF can0" )
  field( ZNAM, "disabled" )
  field( ONAM, "enabled" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

###########################################
# ### Decoding of Module Event Status ### #
###########################################
record( bi, "ISEG:5230102:0:1:EventLiveInsertion" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.B2 CP can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:EventService" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.B4 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Hardware failure detected" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:EventInputError" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.B6 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Input Error in connection" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:EventSafetyLoopNotGood" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.BA CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Safety loop open" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
  alias( "ch10:EventSafetyLoopNotGood" )
}

record( bi, "ISEG:5230102:0:1:EventSuppliesNotGood" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.BD CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Supply is not good" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:EventTemperatureNotGood" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.BD CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Temperature above 55 degC" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

###############################
# ### Channel item values ### #
###############################

record( ao, "ISEG:5230102:0:1:2:VoltageSet" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.2.VoltageSet can0" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" )
  alias( "ch10:VoltageSet" )
}

record( ao, "ISEG:5230102:0:1:2:CurrentSet" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.2.CurrentSet can0" )
  field( TSE,  "-2" )
  field( PREC, "6" )
  field( SCAN, "1 second" )
  field( VAL, ".001")
  field( PINI, "YES")
  alias( "ch10:CurrentSet" )
}

record( ai, "ISEG:5230102:0:1:2:VoltageMeasure" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.2.VoltageMeasure can0" )
  field( FLNK, "ISEG:5230102:0:1:2:CurrentMeasure" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" )
  alias( "ch10:VoltageMeasure" )
}

record( ai, "ISEG:5230102:0:1:2:CurrentMeasure" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.2.CurrentMeasure can0" )
  field( FLNK, "ISEG:5230102:0:1:2:Status" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" ) 
  alias( "ch10:CurrentMeasure" )
}

record( ao, "ISEG:5230102:0:1:2:VoltageBounds" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.2.VoltageBounds can0" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:2:CurrentBounds" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.2.CurrentBounds can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:1:2:VoltageNominal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.2.VoltageNominal can0" )
  field( FLNK, "ISEG:5230102:0:1:2:CurrentNominal" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:1:2:CurrentNominal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.2.CurrentNominal can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:1:2:TemperatureExternal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.2.TemperatureExternal can0" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:2:VctCoefficient" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.2.VctCoefficient can0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1:2:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.2.Status can0" )
  field( FLNK, "ISEG:5230102:0:1:2:EventStatus" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:1:2:Control:setOn" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.2.Control:3 can0" )
  field( ZNAM, "Channel off" )
  field( ONAM, "Channel on" )
  field( TSE,  "-2" )
  alias( "ch10:setOn" )
}

record( bo, "ISEG:5230102:0:1:2:Control:setEmergency" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.2.Control:5 can0" )
  field( ZNAM, "" )
  field( ONAM, "Set EMCY" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1:2:EventStatus" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.2.EventStatus can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:1:2:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.2.EventMask can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:1:2:DelayedTripAction" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.2.DelayedTripAction can0" )
  field( FLNK, "ISEG:5230102:0:1:2:DelayedTripTime" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:2:DelayedTripTime" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.2.DelayedTripTime can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:1:2:ExternalInhibitAction" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.2.ExternalInhibitAction can0" )
  field( TSE,  "-2" )
}

######################################
# ### Decoding of Channel Status ### #
######################################
record( bi, "ISEG:5230102:0:1:2:InputError" ) {
  field( INP,  "ISEG:5230102:0:1:2:Status.B2 CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Input Error" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:1:2:isOn" ) {
  field( INP,  "ISEG:5230102:0:1:2:Status.B3 CP can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "1 second" )
  alias( "ch10:isOn" ) 
}

record( bi, "ISEG:5230102:0:1:2:isVoltageRamp" ) {
  field( INP,  "ISEG:5230102:0:1:2:Status.B4 CP can0" )
  field( ZNAM, "stable" )
  field( ONAM, "ramping" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:2:isEmergency" ) {
  field( INP,  "ISEG:5230102:0:1:2:Status.B5 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:2:isCC" ) {
  field( INP,  "ISEG:5230102:0:1:2:Status.B6 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
  field( SCAN,  "1 second" )
}

record( bi, "ISEG:5230102:0:1:2:isCV" ) {
  field( INP,  "ISEG:5230102:0:1:2:Status.B7 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "1 second" )
}

record( bi, "ISEG:5230102:0:1:2:isCurrentBound" ) {
  field( INP,  "ISEG:5230102:0:1:2:Status.BA CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Out of bounds" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:2:isVoltageBound" ) {
  field( INP,  "ISEG:5230102:0:1:2:Status.BB CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Out of bounds" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:2:isEventInhibit" ) {
  field( INP,  "ISEG:5230102:0:1:2:Status.BC CP can0" )
  field( ZNAM, "no" )
  field( ONAM, "yes" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:2:isTrip" ) {
  field( INP,  "ISEG:5230102:0:1:2:Status.BD CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "tripped" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:2:isCurrentLimit" ) {
  field( INP,  "ISEG:5230102:0:1:2:Status.BE CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "exceeded" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:2:isVoltageLimit" ) {
  field( INP,  "ISEG:5230102:0:1:2:Status.BF CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "exceeded" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

############################################
# ### Decoding of Channel Event Status ### #
############################################
record( bi, "ISEG:5230102:0:1:2:EventInputError" ) {
  field( INP,  "ISEG:5230102:0:1:2:EventStatus.B2 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:1:2:EOn2Off" ) {
  field( INP,  "ISEG:5230102:0:1:2:EventStatus.B3 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:2:EventEndOfRamp" ) {
  field( INP,  "ISEG:5230102:0:1:2:EventStatus.B4 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:2:EventEmergency" ) {
  field( INP,  "ISEG:5230102:0:1:2:EventStatus.B5 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:2:ECC" ) {
  field( INP,  "ISEG:5230102:0:1:2:EventStatus.B6 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:2:ECV" ) {
  field( INP,  "ISEG:5230102:0:1:2:EventStatus.B7 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:2:ECurrentBounds" ) {
  field( INP,  "ISEG:5230102:0:1:2:EventStatus.BA CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:2:EVVoltageBounds" ) {
  field( INP,  "ISEG:5230102:0:1:2:EventStatus.BB CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:2:EventExternalInhibit" ) {
  field( INP,  "ISEG:5230102:0:1:2:EventStatus.BC CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:2:EventTrip" ) {
  field( INP,  "ISEG:5230102:0:1:2:EventStatus.BD CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:2:EventCurrentLimit" ) {
  field( INP,  "ISEG:5230102:0:1:2:EventStatus.BE CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:2:EventVoltageLimit" ) {
  field( INP,  "ISEG:5230102:0:1:2:EventStatus.BF CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

#######################################################################
# ###                                                             ### #
# ### EPICS Database for                                          ### #
# ###   iseg HAL                                                  ### #
# ###                                                             ### #
# ### author: J. Roemer, F.Feldbauer                              ### #
# ###                                                             ### #
# ###                                                             ### #
# ### macros: CONTROLLER_SN    serial number of crate controller  ### #
# ###         CAN_LINE    CAN line ID                             ### #
# ###         CRATE_ID    crate address                           ### #
# ###         MODULE_ID   module address                          ### #
# ###         CHANNEL_ID  HV channel address                      ### #
#######################################################################
# ###    Modified: 8-21-2018 PR     ### #
# ###    Fixes interlock PVs           ### #
# ###    1 Alias           	            ### #
#test
#######################################################################

###############################
# ### CAN_System item values ##
###############################

record( stringin, "ISEG:5230102:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@Status can0" )	
  field( FLNK, "ISEG:5230102:BitRate" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:BitRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@BitRate can0" )
  field( TSE,  "-2" )
}	

record( longin, "ISEG:5230102:ModuleNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@ModuleNumber can0" )
  field( FLNK, "ISEG:5230102:CrateNumber" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:CrateNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CrateNumber can0" )
  field( FLNK, "ISEG:5230102:CrateList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:CrateList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CrateList can0" )
  field( FLNK, "ISEG:5230102:CycleCounter" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:CycleCounter" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CycleCounter can0" )
  field( TSE,  "-2" )
}

#############################
# ### CAN_Line item values ##
#############################

record( stringin, "ISEG:5230102:0:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.Status can0" )
  field( FLNK, "ISEG:5230102:0:BitRate" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:BitRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.BitRate can0" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:ModuleNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.ModuleNumber can0" )
  field( FLNK, "ISEG:5230102:0:ModuleList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:ModuleList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.ModuleList can0" )
  field( FLNK, "ISEG:5230102:0:CrateNumber" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:CrateNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.CrateNumber can0" )
  field( FLNK, "ISEG:5230102:0:CrateList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:CrateList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.CrateList can0" )
  field( TSE,  "-2" )
}

#############################
# ### Crate item values ### #
#############################

record( mbbiDirect, "ISEG:5230102:0:1000:StatusLow" ) {
  field( DESC, "Lower 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Status can0" )
  field( NOBT, "16" )
  field( SHFT, "0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1000:StatusHigh" ) {
  field( DESC, "Upper 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Status can0" )
  field( NOBT, "16" )
  field( SHFT, "16" )  ## shift the value by 16 bits to the right
  field( TSE,  "-2" )
}

# Alternative way to read out the status:
# In this case only the calc record needs to be triggered

#record( longin, "ISEG:5230102:0:1000:StatusRead__" ) {
#  field( DTYP, "isegHAL" )
#  field( INP,  "@0.1000.Status can0" )
#}
#record( calc, "ISEG:5230102:0:1000:StatusSplit__" ) {
#  ## PP = Passive Process: Force the other record to process before sending the value
#  field( INPA, "ISEG:5230102:0:1000:StatusRead PP" )
#
#  field( INPB, "0x0000ffff" )
#  field( INPC, "0xffff0000" )
#
#  ## First, set field D to ( field A bitwise AND field B ),
#  ## then set field VAL to ( field A bitwise AND field C ) right shifted by 16 bit
#  field( CALC, "d:=(A&B); (A&C)>>16" )
#}
#record( mbbiDirect, "ISEG:5230102:0:1000:StatusLow" ) {
#  field( DTYP, "Soft Channel" )
#  field( INP,  "ISEG:5230102:0:1000:StatusSplit__.D CP" )
#}
#record( mbbiDirect, "ISEG:5230102:0:1000:StatusHigh" ) {
#  field( DTYP, "Soft Channel" )
#  field( INP,  "ISEG:5230102:0:1000:StatusSplit__.VAL CP" )
#}

record( mbbiDirect, "ISEG:5230102:0:1000:EventStatusLow" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.EventStatus can0" )
  field( NOBT, "16" )
  field( SHFT, "0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1000:EventStatusHigh" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.EventStatus can0" )
  field( NOBT, "16" )
  field( SHFT, "16" )
  field( TSE,  "-2" )
}
record( longout, "ISEG:5230102:0:1000:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.EventMask can0" )
  field( TSE,  "-2" )
}
record( ai, "ISEG:5230102:0:1000:FanSpeed" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FanSpeed can0" )
  field( TSE,  "-2" )
  field( SCAN, "1 second")
}

record( bo, "ISEG:5230102:0:1000:Control:0" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.Control:0 can0" )
  field( ZNAM, "" )
  field( ONAM, "doClear" )
  field( TSE,  "-2" )
}


record( longin, "ISEG:5230102:0:1000:SerialNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.SerialNumber can0" )
  field( TSE,  "-2" )
  field( SCAN,  "1 second" )
}

record( bo, "ISEG:5230102:0:1000:PowerOn" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.PowerOn can0" )
  field( TSE,  "-2" )
  field( ZNAM, "Off" )
  field( ONAM, "On" )
}

record( stringin, "ISEG:5230102:0:1000:FirmwareRelease" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FirmwareRelease can0" )
  field( FLNK, "ISEG:5230102:0:1000:FirmwareName" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1000:FirmwareName" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FirmwareName can0" )
  field( FLNK, "ISEG:5230102:0:1000:Article" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1000:Article" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Article can0" )
  field( TSE,  "-2" )
}


##############################
# ### Module item values ### #
##############################

record( mbbiDirect, "ISEG:5230102:0:1:Status" ) {
  field( DESC, "Lower 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( DISV, "0" )  ## Disable Value (if value linked by SDIS == DISV record is disabled)
  field( SDIS, "ISEG:5230102:0:1000:PowerOn.VAL NPP MS" )
  field( INP,  "@0.1.Status can0" )
  field( FLNK, "ISEG:5230102:0:1:EventStatus" ) ## Build read out chains
  field( TSE,  "-2" )
  field( SCAN,  "1 second" )
}

record( mbbiDirect, "ISEG:5230102:0:1:EventStatus" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.EventStatus can0" )
  field( FLNK, "ISEG:5230102:0:1:EventMask" )
  field( TSE,  "-2" )
}
record( longout, "ISEG:5230102:0:1:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.EventMask can0" )
  field( FLNK, "ISEG:5230102:0:1:Temperature" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:1:Control:doClear" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.Control:6 can0" )
  field( ZNAM, "" )
  field( ONAM, "doClear" )
  field( TSE,  "-2" )
  alias( "ch11:doClear" )
}

record( bo, "ISEG:5230102:0:1:Control:setFineAdjustment" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.Control:12 can0" )
  field( ZNAM, "FineAdjustment off" )
  field( ONAM, "FineAdjustment on" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:1:Control:setKillEnable" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.Control:14 can0" )
  field( ZNAM, "KillEnable off" )
  field( ONAM, "KillEnable on" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:VoltageRampSpeed" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.VoltageRampSpeed can0" )
  field( FLNK, "ISEG:5230102:0:1:CurrentRampSpeed" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:CurrentRampSpeed" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.CurrentRampSpeed can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:1:VoltageLimit" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.VoltageLimit can0" )
  field( FLNK, "ISEG:5230102:0:1:CurrentLimit" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( ai, "ISEG:5230102:0:1:CurrentLimit" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.CurrentLimit can0" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( ai, "ISEG:5230102:0:1:Temperature" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.Temperature can0" )
  field( TSE,  "-2" )
  field( SCAN, "1 second")
}

record( longin, "ISEG:5230102:0:1:SerialNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.SerialNumber can0" )
  field( FLNK, "ISEG:5230102:0:1:ChannelNumber" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( longin, "ISEG:5230102:0:1:ChannelNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.ChannelNumber can0" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:1:SampleRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.SampleRate can0" )
  field( FLNK, "ISEG:5230102:0:1:DigitalFilter" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:1:DigitalFilter" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.DigitalFilter can0" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:1:FirmwareRelease" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.FirmwareRelease can0" )
  field( FLNK, "ISEG:5230102:0:1:FirmwareName" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1:FirmwareName" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.FirmwareName can0" )
  field( FLNK, "ISEG:5230102:0:1:Article" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1:Article" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.Article can0" )
  field( TSE,  "-2" )
}

#####################################
# ### Decoding of Module Status ### #
#####################################

record( bi, "ISEG:5230102:0:1:isAdjustment" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B0 can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:Status:isLiveInsertion" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B2 can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:needService" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B4 can0" )
  field( ZNAM, "ok" )
  field( ONAM, "Hardware failure detected" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:isInputError" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B6 CP can0" )
  field( ZNAM, "ok" )
  field( ONAM, "Error" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:1:isNoSumError" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B8 CP can0" )
  field( ZNAM, "Error" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isNoRamp" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B9 CP can0" )
  field( ZNAM, "channel is ramping" )
  field( ONAM, "all channels stable" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isSafetyLoopGood" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BA CP can0" )
  field( ZNAM, "broken" )
  field( ONAM, "closed" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "Passive" )
  alias( "ch11:isSafetyLoopGood" )  
}

record( bi, "ISEG:5230102:0:1:isEVentActive" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BB CP can0" )
  field( ZNAM, "no active Event" )
  field( ONAM, "any event active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isModuleGood" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BC CP can0" )
  field( ZNAM, "failure" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isSuppliesGodd" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BD CP can0" )
  field( ZNAM, "Out of Range" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isTemperatureGood" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BE CP can0" )
  field( ZNAM, "above 55 degC" )
  field( ONAM, "within range" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isKillEnable" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BF can0" )
  field( ZNAM, "disabled" )
  field( ONAM, "enabled" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

###########################################
# ### Decoding of Module Event Status ### #
###########################################
record( bi, "ISEG:5230102:0:1:EventLiveInsertion" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.B2 CP can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:EventService" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.B4 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Hardware failure detected" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:EventInputError" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.B6 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Input Error in connection" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:EventSafetyLoopNotGood" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.BA CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Safety loop open" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
  alias( "ch11:EventSafetyLoopNotGood" )
}

record( bi, "ISEG:5230102:0:1:EventSuppliesNotGood" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.BD CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Supply is not good" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:EventTemperatureNotGood" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.BD CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Temperature above 55 degC" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

###############################
# ### Channel item values ### #
###############################

record( ao, "ISEG:5230102:0:1:3:VoltageSet" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.3.VoltageSet can0" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" )
  alias( "ch11:VoltageSet" )
}

record( ao, "ISEG:5230102:0:1:3:CurrentSet" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.3.CurrentSet can0" )
  field( TSE,  "-2" )
  field( PREC, "6" )
  field( SCAN, "1 second" )
  field( VAL, ".001")
  field( PINI, "YES")
  alias( "ch11:CurrentSet" )
}

record( ai, "ISEG:5230102:0:1:3:VoltageMeasure" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.3.VoltageMeasure can0" )
  field( FLNK, "ISEG:5230102:0:1:3:CurrentMeasure" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" )
  alias( "ch11:VoltageMeasure" )
}

record( ai, "ISEG:5230102:0:1:3:CurrentMeasure" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.3.CurrentMeasure can0" )
  field( FLNK, "ISEG:5230102:0:1:3:Status" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" ) 
  alias( "ch11:CurrentMeasure" )
}

record( ao, "ISEG:5230102:0:1:3:VoltageBounds" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.3.VoltageBounds can0" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:3:CurrentBounds" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.3.CurrentBounds can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:1:3:VoltageNominal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.3.VoltageNominal can0" )
  field( FLNK, "ISEG:5230102:0:1:3:CurrentNominal" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:1:3:CurrentNominal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.3.CurrentNominal can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:1:3:TemperatureExternal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.3.TemperatureExternal can0" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:3:VctCoefficient" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.3.VctCoefficient can0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1:3:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.3.Status can0" )
  field( FLNK, "ISEG:5230102:0:1:3:EventStatus" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:1:3:Control:setOn" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.3.Control:3 can0" )
  field( ZNAM, "Channel off" )
  field( ONAM, "Channel on" )
  field( TSE,  "-2" )
  alias( "ch11:setOn" )
}

record( bo, "ISEG:5230102:0:1:3:Control:setEmergency" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.3.Control:5 can0" )
  field( ZNAM, "" )
  field( ONAM, "Set EMCY" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1:3:EventStatus" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.3.EventStatus can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:1:3:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.3.EventMask can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:1:3:DelayedTripAction" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.3.DelayedTripAction can0" )
  field( FLNK, "ISEG:5230102:0:1:3:DelayedTripTime" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:3:DelayedTripTime" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.3.DelayedTripTime can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:1:3:ExternalInhibitAction" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.3.ExternalInhibitAction can0" )
  field( TSE,  "-2" )
}

######################################
# ### Decoding of Channel Status ### #
######################################
record( bi, "ISEG:5230102:0:1:3:InputError" ) {
  field( INP,  "ISEG:5230102:0:1:3:Status.B2 CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Input Error" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:1:3:isOn" ) {
  field( INP,  "ISEG:5230102:0:1:3:Status.B3 CP can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "1 second" )
  alias( "ch11:isOn" ) 
}

record( bi, "ISEG:5230102:0:1:3:isVoltageRamp" ) {
  field( INP,  "ISEG:5230102:0:1:3:Status.B4 CP can0" )
  field( ZNAM, "stable" )
  field( ONAM, "ramping" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:3:isEmergency" ) {
  field( INP,  "ISEG:5230102:0:1:3:Status.B5 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:3:isCC" ) {
  field( INP,  "ISEG:5230102:0:1:3:Status.B6 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
  field( SCAN,  "1 second" )
}

record( bi, "ISEG:5230102:0:1:3:isCV" ) {
  field( INP,  "ISEG:5230102:0:1:3:Status.B7 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "1 second" )
}

record( bi, "ISEG:5230102:0:1:3:isCurrentBound" ) {
  field( INP,  "ISEG:5230102:0:1:3:Status.BA CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Out of bounds" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:3:isVoltageBound" ) {
  field( INP,  "ISEG:5230102:0:1:3:Status.BB CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Out of bounds" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:3:isEventInhibit" ) {
  field( INP,  "ISEG:5230102:0:1:3:Status.BC CP can0" )
  field( ZNAM, "no" )
  field( ONAM, "yes" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:3:isTrip" ) {
  field( INP,  "ISEG:5230102:0:1:3:Status.BD CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "tripped" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:3:isCurrentLimit" ) {
  field( INP,  "ISEG:5230102:0:1:3:Status.BE CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "exceeded" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:3:isVoltageLimit" ) {
  field( INP,  "ISEG:5230102:0:1:3:Status.BF CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "exceeded" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

############################################
# ### Decoding of Channel Event Status ### #
############################################
record( bi, "ISEG:5230102:0:1:3:EventInputError" ) {
  field( INP,  "ISEG:5230102:0:1:3:EventStatus.B2 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:1:3:EOn2Off" ) {
  field( INP,  "ISEG:5230102:0:1:3:EventStatus.B3 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:3:EventEndOfRamp" ) {
  field( INP,  "ISEG:5230102:0:1:3:EventStatus.B4 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:3:EventEmergency" ) {
  field( INP,  "ISEG:5230102:0:1:3:EventStatus.B5 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:3:ECC" ) {
  field( INP,  "ISEG:5230102:0:1:3:EventStatus.B6 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:3:ECV" ) {
  field( INP,  "ISEG:5230102:0:1:3:EventStatus.B7 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:3:ECurrentBounds" ) {
  field( INP,  "ISEG:5230102:0:1:3:EventStatus.BA CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:3:EVVoltageBounds" ) {
  field( INP,  "ISEG:5230102:0:1:3:EventStatus.BB CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:3:EventExternalInhibit" ) {
  field( INP,  "ISEG:5230102:0:1:3:EventStatus.BC CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:3:EventTrip" ) {
  field( INP,  "ISEG:5230102:0:1:3:EventStatus.BD CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:3:EventCurrentLimit" ) {
  field( INP,  "ISEG:5230102:0:1:3:EventStatus.BE CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:3:EventVoltageLimit" ) {
  field( INP,  "ISEG:5230102:0:1:3:EventStatus.BF CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

#######################################################################
# ###                                                             ### #
# ### EPICS Database for                                          ### #
# ###   iseg HAL                                                  ### #
# ###                                                             ### #
# ### author: J. Roemer, F.Feldbauer                              ### #
# ###                                                             ### #
# ###                                                             ### #
# ### macros: CONTROLLER_SN    serial number of crate controller  ### #
# ###         CAN_LINE    CAN line ID                             ### #
# ###         CRATE_ID    crate address                           ### #
# ###         MODULE_ID   module address                          ### #
# ###         CHANNEL_ID  HV channel address                      ### #
#######################################################################
# ###    Modified: 8-21-2018 PR     ### #
# ###    Fixes interlock PVs           ### #
# ###    1 Alias           	            ### #
#test
#######################################################################

###############################
# ### CAN_System item values ##
###############################

record( stringin, "ISEG:5230102:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@Status can0" )	
  field( FLNK, "ISEG:5230102:BitRate" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:BitRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@BitRate can0" )
  field( TSE,  "-2" )
}	

record( longin, "ISEG:5230102:ModuleNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@ModuleNumber can0" )
  field( FLNK, "ISEG:5230102:CrateNumber" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:CrateNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CrateNumber can0" )
  field( FLNK, "ISEG:5230102:CrateList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:CrateList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CrateList can0" )
  field( FLNK, "ISEG:5230102:CycleCounter" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:CycleCounter" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CycleCounter can0" )
  field( TSE,  "-2" )
}

#############################
# ### CAN_Line item values ##
#############################

record( stringin, "ISEG:5230102:0:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.Status can0" )
  field( FLNK, "ISEG:5230102:0:BitRate" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:BitRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.BitRate can0" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:ModuleNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.ModuleNumber can0" )
  field( FLNK, "ISEG:5230102:0:ModuleList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:ModuleList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.ModuleList can0" )
  field( FLNK, "ISEG:5230102:0:CrateNumber" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:CrateNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.CrateNumber can0" )
  field( FLNK, "ISEG:5230102:0:CrateList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:CrateList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.CrateList can0" )
  field( TSE,  "-2" )
}

#############################
# ### Crate item values ### #
#############################

record( mbbiDirect, "ISEG:5230102:0:1000:StatusLow" ) {
  field( DESC, "Lower 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Status can0" )
  field( NOBT, "16" )
  field( SHFT, "0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1000:StatusHigh" ) {
  field( DESC, "Upper 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Status can0" )
  field( NOBT, "16" )
  field( SHFT, "16" )  ## shift the value by 16 bits to the right
  field( TSE,  "-2" )
}

# Alternative way to read out the status:
# In this case only the calc record needs to be triggered

#record( longin, "ISEG:5230102:0:1000:StatusRead__" ) {
#  field( DTYP, "isegHAL" )
#  field( INP,  "@0.1000.Status can0" )
#}
#record( calc, "ISEG:5230102:0:1000:StatusSplit__" ) {
#  ## PP = Passive Process: Force the other record to process before sending the value
#  field( INPA, "ISEG:5230102:0:1000:StatusRead PP" )
#
#  field( INPB, "0x0000ffff" )
#  field( INPC, "0xffff0000" )
#
#  ## First, set field D to ( field A bitwise AND field B ),
#  ## then set field VAL to ( field A bitwise AND field C ) right shifted by 16 bit
#  field( CALC, "d:=(A&B); (A&C)>>16" )
#}
#record( mbbiDirect, "ISEG:5230102:0:1000:StatusLow" ) {
#  field( DTYP, "Soft Channel" )
#  field( INP,  "ISEG:5230102:0:1000:StatusSplit__.D CP" )
#}
#record( mbbiDirect, "ISEG:5230102:0:1000:StatusHigh" ) {
#  field( DTYP, "Soft Channel" )
#  field( INP,  "ISEG:5230102:0:1000:StatusSplit__.VAL CP" )
#}

record( mbbiDirect, "ISEG:5230102:0:1000:EventStatusLow" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.EventStatus can0" )
  field( NOBT, "16" )
  field( SHFT, "0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1000:EventStatusHigh" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.EventStatus can0" )
  field( NOBT, "16" )
  field( SHFT, "16" )
  field( TSE,  "-2" )
}
record( longout, "ISEG:5230102:0:1000:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.EventMask can0" )
  field( TSE,  "-2" )
}
record( ai, "ISEG:5230102:0:1000:FanSpeed" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FanSpeed can0" )
  field( TSE,  "-2" )
  field( SCAN, "1 second")
}

record( bo, "ISEG:5230102:0:1000:Control:0" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.Control:0 can0" )
  field( ZNAM, "" )
  field( ONAM, "doClear" )
  field( TSE,  "-2" )
}


record( longin, "ISEG:5230102:0:1000:SerialNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.SerialNumber can0" )
  field( TSE,  "-2" )
  field( SCAN,  "1 second" )
}

record( bo, "ISEG:5230102:0:1000:PowerOn" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.PowerOn can0" )
  field( TSE,  "-2" )
  field( ZNAM, "Off" )
  field( ONAM, "On" )
}

record( stringin, "ISEG:5230102:0:1000:FirmwareRelease" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FirmwareRelease can0" )
  field( FLNK, "ISEG:5230102:0:1000:FirmwareName" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1000:FirmwareName" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FirmwareName can0" )
  field( FLNK, "ISEG:5230102:0:1000:Article" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1000:Article" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Article can0" )
  field( TSE,  "-2" )
}


##############################
# ### Module item values ### #
##############################

record( mbbiDirect, "ISEG:5230102:0:1:Status" ) {
  field( DESC, "Lower 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( DISV, "0" )  ## Disable Value (if value linked by SDIS == DISV record is disabled)
  field( SDIS, "ISEG:5230102:0:1000:PowerOn.VAL NPP MS" )
  field( INP,  "@0.1.Status can0" )
  field( FLNK, "ISEG:5230102:0:1:EventStatus" ) ## Build read out chains
  field( TSE,  "-2" )
  field( SCAN,  "1 second" )
}

record( mbbiDirect, "ISEG:5230102:0:1:EventStatus" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.EventStatus can0" )
  field( FLNK, "ISEG:5230102:0:1:EventMask" )
  field( TSE,  "-2" )
}
record( longout, "ISEG:5230102:0:1:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.EventMask can0" )
  field( FLNK, "ISEG:5230102:0:1:Temperature" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:1:Control:doClear" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.Control:6 can0" )
  field( ZNAM, "" )
  field( ONAM, "doClear" )
  field( TSE,  "-2" )
  alias( "ch12:doClear" )
}

record( bo, "ISEG:5230102:0:1:Control:setFineAdjustment" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.Control:12 can0" )
  field( ZNAM, "FineAdjustment off" )
  field( ONAM, "FineAdjustment on" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:1:Control:setKillEnable" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.Control:14 can0" )
  field( ZNAM, "KillEnable off" )
  field( ONAM, "KillEnable on" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:VoltageRampSpeed" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.VoltageRampSpeed can0" )
  field( FLNK, "ISEG:5230102:0:1:CurrentRampSpeed" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:CurrentRampSpeed" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.CurrentRampSpeed can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:1:VoltageLimit" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.VoltageLimit can0" )
  field( FLNK, "ISEG:5230102:0:1:CurrentLimit" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( ai, "ISEG:5230102:0:1:CurrentLimit" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.CurrentLimit can0" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( ai, "ISEG:5230102:0:1:Temperature" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.Temperature can0" )
  field( TSE,  "-2" )
  field( SCAN, "1 second")
}

record( longin, "ISEG:5230102:0:1:SerialNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.SerialNumber can0" )
  field( FLNK, "ISEG:5230102:0:1:ChannelNumber" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( longin, "ISEG:5230102:0:1:ChannelNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.ChannelNumber can0" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:1:SampleRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.SampleRate can0" )
  field( FLNK, "ISEG:5230102:0:1:DigitalFilter" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:1:DigitalFilter" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.DigitalFilter can0" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:1:FirmwareRelease" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.FirmwareRelease can0" )
  field( FLNK, "ISEG:5230102:0:1:FirmwareName" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1:FirmwareName" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.FirmwareName can0" )
  field( FLNK, "ISEG:5230102:0:1:Article" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1:Article" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.Article can0" )
  field( TSE,  "-2" )
}

#####################################
# ### Decoding of Module Status ### #
#####################################

record( bi, "ISEG:5230102:0:1:isAdjustment" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B0 can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:Status:isLiveInsertion" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B2 can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:needService" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B4 can0" )
  field( ZNAM, "ok" )
  field( ONAM, "Hardware failure detected" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:isInputError" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B6 CP can0" )
  field( ZNAM, "ok" )
  field( ONAM, "Error" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:1:isNoSumError" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B8 CP can0" )
  field( ZNAM, "Error" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isNoRamp" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B9 CP can0" )
  field( ZNAM, "channel is ramping" )
  field( ONAM, "all channels stable" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isSafetyLoopGood" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BA CP can0" )
  field( ZNAM, "broken" )
  field( ONAM, "closed" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "Passive" )
  alias( "ch12:isSafetyLoopGood" )  
}

record( bi, "ISEG:5230102:0:1:isEVentActive" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BB CP can0" )
  field( ZNAM, "no active Event" )
  field( ONAM, "any event active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isModuleGood" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BC CP can0" )
  field( ZNAM, "failure" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isSuppliesGodd" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BD CP can0" )
  field( ZNAM, "Out of Range" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isTemperatureGood" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BE CP can0" )
  field( ZNAM, "above 55 degC" )
  field( ONAM, "within range" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isKillEnable" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BF can0" )
  field( ZNAM, "disabled" )
  field( ONAM, "enabled" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

###########################################
# ### Decoding of Module Event Status ### #
###########################################
record( bi, "ISEG:5230102:0:1:EventLiveInsertion" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.B2 CP can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:EventService" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.B4 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Hardware failure detected" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:EventInputError" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.B6 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Input Error in connection" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:EventSafetyLoopNotGood" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.BA CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Safety loop open" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
  alias( "ch12:EventSafetyLoopNotGood" )
}

record( bi, "ISEG:5230102:0:1:EventSuppliesNotGood" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.BD CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Supply is not good" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:EventTemperatureNotGood" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.BD CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Temperature above 55 degC" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

###############################
# ### Channel item values ### #
###############################

record( ao, "ISEG:5230102:0:1:4:VoltageSet" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.4.VoltageSet can0" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" )
  alias( "ch12:VoltageSet" )
}

record( ao, "ISEG:5230102:0:1:4:CurrentSet" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.4.CurrentSet can0" )
  field( TSE,  "-2" )
  field( PREC, "6" )
  field( SCAN, "1 second" )
  field( VAL, ".001")
  field( PINI, "YES")
  alias( "ch12:CurrentSet" )
}

record( ai, "ISEG:5230102:0:1:4:VoltageMeasure" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.4.VoltageMeasure can0" )
  field( FLNK, "ISEG:5230102:0:1:4:CurrentMeasure" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" )
  alias( "ch12:VoltageMeasure" )
}

record( ai, "ISEG:5230102:0:1:4:CurrentMeasure" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.4.CurrentMeasure can0" )
  field( FLNK, "ISEG:5230102:0:1:4:Status" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" ) 
  alias( "ch12:CurrentMeasure" )
}

record( ao, "ISEG:5230102:0:1:4:VoltageBounds" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.4.VoltageBounds can0" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:4:CurrentBounds" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.4.CurrentBounds can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:1:4:VoltageNominal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.4.VoltageNominal can0" )
  field( FLNK, "ISEG:5230102:0:1:4:CurrentNominal" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:1:4:CurrentNominal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.4.CurrentNominal can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:1:4:TemperatureExternal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.4.TemperatureExternal can0" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:4:VctCoefficient" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.4.VctCoefficient can0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1:4:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.4.Status can0" )
  field( FLNK, "ISEG:5230102:0:1:4:EventStatus" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:1:4:Control:setOn" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.4.Control:3 can0" )
  field( ZNAM, "Channel off" )
  field( ONAM, "Channel on" )
  field( TSE,  "-2" )
  alias( "ch12:setOn" )
}

record( bo, "ISEG:5230102:0:1:4:Control:setEmergency" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.4.Control:5 can0" )
  field( ZNAM, "" )
  field( ONAM, "Set EMCY" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1:4:EventStatus" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.4.EventStatus can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:1:4:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.4.EventMask can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:1:4:DelayedTripAction" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.4.DelayedTripAction can0" )
  field( FLNK, "ISEG:5230102:0:1:4:DelayedTripTime" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:4:DelayedTripTime" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.4.DelayedTripTime can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:1:4:ExternalInhibitAction" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.4.ExternalInhibitAction can0" )
  field( TSE,  "-2" )
}

######################################
# ### Decoding of Channel Status ### #
######################################
record( bi, "ISEG:5230102:0:1:4:InputError" ) {
  field( INP,  "ISEG:5230102:0:1:4:Status.B2 CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Input Error" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:1:4:isOn" ) {
  field( INP,  "ISEG:5230102:0:1:4:Status.B3 CP can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "1 second" )
  alias( "ch12:isOn" ) 
}

record( bi, "ISEG:5230102:0:1:4:isVoltageRamp" ) {
  field( INP,  "ISEG:5230102:0:1:4:Status.B4 CP can0" )
  field( ZNAM, "stable" )
  field( ONAM, "ramping" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:4:isEmergency" ) {
  field( INP,  "ISEG:5230102:0:1:4:Status.B5 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:4:isCC" ) {
  field( INP,  "ISEG:5230102:0:1:4:Status.B6 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
  field( SCAN,  "1 second" )
}

record( bi, "ISEG:5230102:0:1:4:isCV" ) {
  field( INP,  "ISEG:5230102:0:1:4:Status.B7 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "1 second" )
}

record( bi, "ISEG:5230102:0:1:4:isCurrentBound" ) {
  field( INP,  "ISEG:5230102:0:1:4:Status.BA CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Out of bounds" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:4:isVoltageBound" ) {
  field( INP,  "ISEG:5230102:0:1:4:Status.BB CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Out of bounds" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:4:isEventInhibit" ) {
  field( INP,  "ISEG:5230102:0:1:4:Status.BC CP can0" )
  field( ZNAM, "no" )
  field( ONAM, "yes" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:4:isTrip" ) {
  field( INP,  "ISEG:5230102:0:1:4:Status.BD CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "tripped" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:4:isCurrentLimit" ) {
  field( INP,  "ISEG:5230102:0:1:4:Status.BE CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "exceeded" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:4:isVoltageLimit" ) {
  field( INP,  "ISEG:5230102:0:1:4:Status.BF CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "exceeded" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

############################################
# ### Decoding of Channel Event Status ### #
############################################
record( bi, "ISEG:5230102:0:1:4:EventInputError" ) {
  field( INP,  "ISEG:5230102:0:1:4:EventStatus.B2 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:1:4:EOn2Off" ) {
  field( INP,  "ISEG:5230102:0:1:4:EventStatus.B3 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:4:EventEndOfRamp" ) {
  field( INP,  "ISEG:5230102:0:1:4:EventStatus.B4 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:4:EventEmergency" ) {
  field( INP,  "ISEG:5230102:0:1:4:EventStatus.B5 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:4:ECC" ) {
  field( INP,  "ISEG:5230102:0:1:4:EventStatus.B6 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:4:ECV" ) {
  field( INP,  "ISEG:5230102:0:1:4:EventStatus.B7 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:4:ECurrentBounds" ) {
  field( INP,  "ISEG:5230102:0:1:4:EventStatus.BA CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:4:EVVoltageBounds" ) {
  field( INP,  "ISEG:5230102:0:1:4:EventStatus.BB CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:4:EventExternalInhibit" ) {
  field( INP,  "ISEG:5230102:0:1:4:EventStatus.BC CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:4:EventTrip" ) {
  field( INP,  "ISEG:5230102:0:1:4:EventStatus.BD CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:4:EventCurrentLimit" ) {
  field( INP,  "ISEG:5230102:0:1:4:EventStatus.BE CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:4:EventVoltageLimit" ) {
  field( INP,  "ISEG:5230102:0:1:4:EventStatus.BF CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

#######################################################################
# ###                                                             ### #
# ### EPICS Database for                                          ### #
# ###   iseg HAL                                                  ### #
# ###                                                             ### #
# ### author: J. Roemer, F.Feldbauer                              ### #
# ###                                                             ### #
# ###                                                             ### #
# ### macros: CONTROLLER_SN    serial number of crate controller  ### #
# ###         CAN_LINE    CAN line ID                             ### #
# ###         CRATE_ID    crate address                           ### #
# ###         MODULE_ID   module address                          ### #
# ###         CHANNEL_ID  HV channel address                      ### #
#######################################################################
# ###    Modified: 8-21-2018 PR     ### #
# ###    Fixes interlock PVs           ### #
# ###    1 Alias           	            ### #
#test
#######################################################################

###############################
# ### CAN_System item values ##
###############################

record( stringin, "ISEG:5230102:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@Status can0" )	
  field( FLNK, "ISEG:5230102:BitRate" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:BitRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@BitRate can0" )
  field( TSE,  "-2" )
}	

record( longin, "ISEG:5230102:ModuleNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@ModuleNumber can0" )
  field( FLNK, "ISEG:5230102:CrateNumber" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:CrateNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CrateNumber can0" )
  field( FLNK, "ISEG:5230102:CrateList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:CrateList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CrateList can0" )
  field( FLNK, "ISEG:5230102:CycleCounter" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:CycleCounter" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CycleCounter can0" )
  field( TSE,  "-2" )
}

#############################
# ### CAN_Line item values ##
#############################

record( stringin, "ISEG:5230102:0:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.Status can0" )
  field( FLNK, "ISEG:5230102:0:BitRate" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:BitRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.BitRate can0" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:ModuleNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.ModuleNumber can0" )
  field( FLNK, "ISEG:5230102:0:ModuleList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:ModuleList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.ModuleList can0" )
  field( FLNK, "ISEG:5230102:0:CrateNumber" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:CrateNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.CrateNumber can0" )
  field( FLNK, "ISEG:5230102:0:CrateList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:CrateList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.CrateList can0" )
  field( TSE,  "-2" )
}

#############################
# ### Crate item values ### #
#############################

record( mbbiDirect, "ISEG:5230102:0:1000:StatusLow" ) {
  field( DESC, "Lower 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Status can0" )
  field( NOBT, "16" )
  field( SHFT, "0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1000:StatusHigh" ) {
  field( DESC, "Upper 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Status can0" )
  field( NOBT, "16" )
  field( SHFT, "16" )  ## shift the value by 16 bits to the right
  field( TSE,  "-2" )
}

# Alternative way to read out the status:
# In this case only the calc record needs to be triggered

#record( longin, "ISEG:5230102:0:1000:StatusRead__" ) {
#  field( DTYP, "isegHAL" )
#  field( INP,  "@0.1000.Status can0" )
#}
#record( calc, "ISEG:5230102:0:1000:StatusSplit__" ) {
#  ## PP = Passive Process: Force the other record to process before sending the value
#  field( INPA, "ISEG:5230102:0:1000:StatusRead PP" )
#
#  field( INPB, "0x0000ffff" )
#  field( INPC, "0xffff0000" )
#
#  ## First, set field D to ( field A bitwise AND field B ),
#  ## then set field VAL to ( field A bitwise AND field C ) right shifted by 16 bit
#  field( CALC, "d:=(A&B); (A&C)>>16" )
#}
#record( mbbiDirect, "ISEG:5230102:0:1000:StatusLow" ) {
#  field( DTYP, "Soft Channel" )
#  field( INP,  "ISEG:5230102:0:1000:StatusSplit__.D CP" )
#}
#record( mbbiDirect, "ISEG:5230102:0:1000:StatusHigh" ) {
#  field( DTYP, "Soft Channel" )
#  field( INP,  "ISEG:5230102:0:1000:StatusSplit__.VAL CP" )
#}

record( mbbiDirect, "ISEG:5230102:0:1000:EventStatusLow" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.EventStatus can0" )
  field( NOBT, "16" )
  field( SHFT, "0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1000:EventStatusHigh" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.EventStatus can0" )
  field( NOBT, "16" )
  field( SHFT, "16" )
  field( TSE,  "-2" )
}
record( longout, "ISEG:5230102:0:1000:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.EventMask can0" )
  field( TSE,  "-2" )
}
record( ai, "ISEG:5230102:0:1000:FanSpeed" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FanSpeed can0" )
  field( TSE,  "-2" )
  field( SCAN, "1 second")
}

record( bo, "ISEG:5230102:0:1000:Control:0" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.Control:0 can0" )
  field( ZNAM, "" )
  field( ONAM, "doClear" )
  field( TSE,  "-2" )
}


record( longin, "ISEG:5230102:0:1000:SerialNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.SerialNumber can0" )
  field( TSE,  "-2" )
  field( SCAN,  "1 second" )
}

record( bo, "ISEG:5230102:0:1000:PowerOn" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.PowerOn can0" )
  field( TSE,  "-2" )
  field( ZNAM, "Off" )
  field( ONAM, "On" )
}

record( stringin, "ISEG:5230102:0:1000:FirmwareRelease" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FirmwareRelease can0" )
  field( FLNK, "ISEG:5230102:0:1000:FirmwareName" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1000:FirmwareName" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FirmwareName can0" )
  field( FLNK, "ISEG:5230102:0:1000:Article" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1000:Article" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Article can0" )
  field( TSE,  "-2" )
}


##############################
# ### Module item values ### #
##############################

record( mbbiDirect, "ISEG:5230102:0:1:Status" ) {
  field( DESC, "Lower 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( DISV, "0" )  ## Disable Value (if value linked by SDIS == DISV record is disabled)
  field( SDIS, "ISEG:5230102:0:1000:PowerOn.VAL NPP MS" )
  field( INP,  "@0.1.Status can0" )
  field( FLNK, "ISEG:5230102:0:1:EventStatus" ) ## Build read out chains
  field( TSE,  "-2" )
  field( SCAN,  "1 second" )
}

record( mbbiDirect, "ISEG:5230102:0:1:EventStatus" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.EventStatus can0" )
  field( FLNK, "ISEG:5230102:0:1:EventMask" )
  field( TSE,  "-2" )
}
record( longout, "ISEG:5230102:0:1:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.EventMask can0" )
  field( FLNK, "ISEG:5230102:0:1:Temperature" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:1:Control:doClear" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.Control:6 can0" )
  field( ZNAM, "" )
  field( ONAM, "doClear" )
  field( TSE,  "-2" )
  alias( "ch13:doClear" )
}

record( bo, "ISEG:5230102:0:1:Control:setFineAdjustment" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.Control:12 can0" )
  field( ZNAM, "FineAdjustment off" )
  field( ONAM, "FineAdjustment on" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:1:Control:setKillEnable" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.Control:14 can0" )
  field( ZNAM, "KillEnable off" )
  field( ONAM, "KillEnable on" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:VoltageRampSpeed" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.VoltageRampSpeed can0" )
  field( FLNK, "ISEG:5230102:0:1:CurrentRampSpeed" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:CurrentRampSpeed" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.CurrentRampSpeed can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:1:VoltageLimit" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.VoltageLimit can0" )
  field( FLNK, "ISEG:5230102:0:1:CurrentLimit" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( ai, "ISEG:5230102:0:1:CurrentLimit" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.CurrentLimit can0" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( ai, "ISEG:5230102:0:1:Temperature" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.Temperature can0" )
  field( TSE,  "-2" )
  field( SCAN, "1 second")
}

record( longin, "ISEG:5230102:0:1:SerialNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.SerialNumber can0" )
  field( FLNK, "ISEG:5230102:0:1:ChannelNumber" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( longin, "ISEG:5230102:0:1:ChannelNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.ChannelNumber can0" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:1:SampleRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.SampleRate can0" )
  field( FLNK, "ISEG:5230102:0:1:DigitalFilter" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:1:DigitalFilter" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.DigitalFilter can0" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:1:FirmwareRelease" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.FirmwareRelease can0" )
  field( FLNK, "ISEG:5230102:0:1:FirmwareName" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1:FirmwareName" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.FirmwareName can0" )
  field( FLNK, "ISEG:5230102:0:1:Article" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1:Article" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.Article can0" )
  field( TSE,  "-2" )
}

#####################################
# ### Decoding of Module Status ### #
#####################################

record( bi, "ISEG:5230102:0:1:isAdjustment" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B0 can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:Status:isLiveInsertion" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B2 can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:needService" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B4 can0" )
  field( ZNAM, "ok" )
  field( ONAM, "Hardware failure detected" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:isInputError" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B6 CP can0" )
  field( ZNAM, "ok" )
  field( ONAM, "Error" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:1:isNoSumError" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B8 CP can0" )
  field( ZNAM, "Error" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isNoRamp" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B9 CP can0" )
  field( ZNAM, "channel is ramping" )
  field( ONAM, "all channels stable" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isSafetyLoopGood" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BA CP can0" )
  field( ZNAM, "broken" )
  field( ONAM, "closed" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "Passive" )
  alias( "ch13:isSafetyLoopGood" )  
}

record( bi, "ISEG:5230102:0:1:isEVentActive" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BB CP can0" )
  field( ZNAM, "no active Event" )
  field( ONAM, "any event active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isModuleGood" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BC CP can0" )
  field( ZNAM, "failure" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isSuppliesGodd" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BD CP can0" )
  field( ZNAM, "Out of Range" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isTemperatureGood" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BE CP can0" )
  field( ZNAM, "above 55 degC" )
  field( ONAM, "within range" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isKillEnable" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BF can0" )
  field( ZNAM, "disabled" )
  field( ONAM, "enabled" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

###########################################
# ### Decoding of Module Event Status ### #
###########################################
record( bi, "ISEG:5230102:0:1:EventLiveInsertion" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.B2 CP can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:EventService" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.B4 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Hardware failure detected" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:EventInputError" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.B6 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Input Error in connection" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:EventSafetyLoopNotGood" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.BA CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Safety loop open" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
  alias( "ch13:EventSafetyLoopNotGood" )
}

record( bi, "ISEG:5230102:0:1:EventSuppliesNotGood" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.BD CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Supply is not good" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:EventTemperatureNotGood" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.BD CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Temperature above 55 degC" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

###############################
# ### Channel item values ### #
###############################

record( ao, "ISEG:5230102:0:1:5:VoltageSet" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.5.VoltageSet can0" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" )
  alias( "ch13:VoltageSet" )
}

record( ao, "ISEG:5230102:0:1:5:CurrentSet" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.5.CurrentSet can0" )
  field( TSE,  "-2" )
  field( PREC, "6" )
  field( SCAN, "1 second" )
  field( VAL, ".001")
  field( PINI, "YES")
  alias( "ch13:CurrentSet" )
}

record( ai, "ISEG:5230102:0:1:5:VoltageMeasure" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.5.VoltageMeasure can0" )
  field( FLNK, "ISEG:5230102:0:1:5:CurrentMeasure" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" )
  alias( "ch13:VoltageMeasure" )
}

record( ai, "ISEG:5230102:0:1:5:CurrentMeasure" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.5.CurrentMeasure can0" )
  field( FLNK, "ISEG:5230102:0:1:5:Status" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" ) 
  alias( "ch13:CurrentMeasure" )
}

record( ao, "ISEG:5230102:0:1:5:VoltageBounds" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.5.VoltageBounds can0" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:5:CurrentBounds" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.5.CurrentBounds can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:1:5:VoltageNominal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.5.VoltageNominal can0" )
  field( FLNK, "ISEG:5230102:0:1:5:CurrentNominal" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:1:5:CurrentNominal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.5.CurrentNominal can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:1:5:TemperatureExternal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.5.TemperatureExternal can0" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:5:VctCoefficient" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.5.VctCoefficient can0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1:5:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.5.Status can0" )
  field( FLNK, "ISEG:5230102:0:1:5:EventStatus" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:1:5:Control:setOn" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.5.Control:3 can0" )
  field( ZNAM, "Channel off" )
  field( ONAM, "Channel on" )
  field( TSE,  "-2" )
  alias( "ch13:setOn" )
}

record( bo, "ISEG:5230102:0:1:5:Control:setEmergency" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.5.Control:5 can0" )
  field( ZNAM, "" )
  field( ONAM, "Set EMCY" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1:5:EventStatus" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.5.EventStatus can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:1:5:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.5.EventMask can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:1:5:DelayedTripAction" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.5.DelayedTripAction can0" )
  field( FLNK, "ISEG:5230102:0:1:5:DelayedTripTime" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:5:DelayedTripTime" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.5.DelayedTripTime can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:1:5:ExternalInhibitAction" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.5.ExternalInhibitAction can0" )
  field( TSE,  "-2" )
}

######################################
# ### Decoding of Channel Status ### #
######################################
record( bi, "ISEG:5230102:0:1:5:InputError" ) {
  field( INP,  "ISEG:5230102:0:1:5:Status.B2 CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Input Error" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:1:5:isOn" ) {
  field( INP,  "ISEG:5230102:0:1:5:Status.B3 CP can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "1 second" )
  alias( "ch13:isOn" ) 
}

record( bi, "ISEG:5230102:0:1:5:isVoltageRamp" ) {
  field( INP,  "ISEG:5230102:0:1:5:Status.B4 CP can0" )
  field( ZNAM, "stable" )
  field( ONAM, "ramping" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:5:isEmergency" ) {
  field( INP,  "ISEG:5230102:0:1:5:Status.B5 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:5:isCC" ) {
  field( INP,  "ISEG:5230102:0:1:5:Status.B6 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
  field( SCAN,  "1 second" )
}

record( bi, "ISEG:5230102:0:1:5:isCV" ) {
  field( INP,  "ISEG:5230102:0:1:5:Status.B7 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "1 second" )
}

record( bi, "ISEG:5230102:0:1:5:isCurrentBound" ) {
  field( INP,  "ISEG:5230102:0:1:5:Status.BA CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Out of bounds" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:5:isVoltageBound" ) {
  field( INP,  "ISEG:5230102:0:1:5:Status.BB CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Out of bounds" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:5:isEventInhibit" ) {
  field( INP,  "ISEG:5230102:0:1:5:Status.BC CP can0" )
  field( ZNAM, "no" )
  field( ONAM, "yes" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:5:isTrip" ) {
  field( INP,  "ISEG:5230102:0:1:5:Status.BD CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "tripped" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:5:isCurrentLimit" ) {
  field( INP,  "ISEG:5230102:0:1:5:Status.BE CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "exceeded" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:5:isVoltageLimit" ) {
  field( INP,  "ISEG:5230102:0:1:5:Status.BF CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "exceeded" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

############################################
# ### Decoding of Channel Event Status ### #
############################################
record( bi, "ISEG:5230102:0:1:5:EventInputError" ) {
  field( INP,  "ISEG:5230102:0:1:5:EventStatus.B2 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:1:5:EOn2Off" ) {
  field( INP,  "ISEG:5230102:0:1:5:EventStatus.B3 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:5:EventEndOfRamp" ) {
  field( INP,  "ISEG:5230102:0:1:5:EventStatus.B4 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:5:EventEmergency" ) {
  field( INP,  "ISEG:5230102:0:1:5:EventStatus.B5 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:5:ECC" ) {
  field( INP,  "ISEG:5230102:0:1:5:EventStatus.B6 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:5:ECV" ) {
  field( INP,  "ISEG:5230102:0:1:5:EventStatus.B7 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:5:ECurrentBounds" ) {
  field( INP,  "ISEG:5230102:0:1:5:EventStatus.BA CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:5:EVVoltageBounds" ) {
  field( INP,  "ISEG:5230102:0:1:5:EventStatus.BB CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:5:EventExternalInhibit" ) {
  field( INP,  "ISEG:5230102:0:1:5:EventStatus.BC CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:5:EventTrip" ) {
  field( INP,  "ISEG:5230102:0:1:5:EventStatus.BD CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:5:EventCurrentLimit" ) {
  field( INP,  "ISEG:5230102:0:1:5:EventStatus.BE CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:5:EventVoltageLimit" ) {
  field( INP,  "ISEG:5230102:0:1:5:EventStatus.BF CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

#######################################################################
# ###                                                             ### #
# ### EPICS Database for                                          ### #
# ###   iseg HAL                                                  ### #
# ###                                                             ### #
# ### author: J. Roemer, F.Feldbauer                              ### #
# ###                                                             ### #
# ###                                                             ### #
# ### macros: CONTROLLER_SN    serial number of crate controller  ### #
# ###         CAN_LINE    CAN line ID                             ### #
# ###         CRATE_ID    crate address                           ### #
# ###         MODULE_ID   module address                          ### #
# ###         CHANNEL_ID  HV channel address                      ### #
#######################################################################
# ###    Modified: 8-21-2018 PR     ### #
# ###    Fixes interlock PVs           ### #
# ###    1 Alias           	            ### #
#test
#######################################################################

###############################
# ### CAN_System item values ##
###############################

record( stringin, "ISEG:5230102:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@Status can0" )	
  field( FLNK, "ISEG:5230102:BitRate" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:BitRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@BitRate can0" )
  field( TSE,  "-2" )
}	

record( longin, "ISEG:5230102:ModuleNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@ModuleNumber can0" )
  field( FLNK, "ISEG:5230102:CrateNumber" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:CrateNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CrateNumber can0" )
  field( FLNK, "ISEG:5230102:CrateList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:CrateList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CrateList can0" )
  field( FLNK, "ISEG:5230102:CycleCounter" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:CycleCounter" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CycleCounter can0" )
  field( TSE,  "-2" )
}

#############################
# ### CAN_Line item values ##
#############################

record( stringin, "ISEG:5230102:0:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.Status can0" )
  field( FLNK, "ISEG:5230102:0:BitRate" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:BitRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.BitRate can0" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:ModuleNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.ModuleNumber can0" )
  field( FLNK, "ISEG:5230102:0:ModuleList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:ModuleList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.ModuleList can0" )
  field( FLNK, "ISEG:5230102:0:CrateNumber" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:CrateNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.CrateNumber can0" )
  field( FLNK, "ISEG:5230102:0:CrateList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:CrateList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.CrateList can0" )
  field( TSE,  "-2" )
}

#############################
# ### Crate item values ### #
#############################

record( mbbiDirect, "ISEG:5230102:0:1000:StatusLow" ) {
  field( DESC, "Lower 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Status can0" )
  field( NOBT, "16" )
  field( SHFT, "0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1000:StatusHigh" ) {
  field( DESC, "Upper 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Status can0" )
  field( NOBT, "16" )
  field( SHFT, "16" )  ## shift the value by 16 bits to the right
  field( TSE,  "-2" )
}

# Alternative way to read out the status:
# In this case only the calc record needs to be triggered

#record( longin, "ISEG:5230102:0:1000:StatusRead__" ) {
#  field( DTYP, "isegHAL" )
#  field( INP,  "@0.1000.Status can0" )
#}
#record( calc, "ISEG:5230102:0:1000:StatusSplit__" ) {
#  ## PP = Passive Process: Force the other record to process before sending the value
#  field( INPA, "ISEG:5230102:0:1000:StatusRead PP" )
#
#  field( INPB, "0x0000ffff" )
#  field( INPC, "0xffff0000" )
#
#  ## First, set field D to ( field A bitwise AND field B ),
#  ## then set field VAL to ( field A bitwise AND field C ) right shifted by 16 bit
#  field( CALC, "d:=(A&B); (A&C)>>16" )
#}
#record( mbbiDirect, "ISEG:5230102:0:1000:StatusLow" ) {
#  field( DTYP, "Soft Channel" )
#  field( INP,  "ISEG:5230102:0:1000:StatusSplit__.D CP" )
#}
#record( mbbiDirect, "ISEG:5230102:0:1000:StatusHigh" ) {
#  field( DTYP, "Soft Channel" )
#  field( INP,  "ISEG:5230102:0:1000:StatusSplit__.VAL CP" )
#}

record( mbbiDirect, "ISEG:5230102:0:1000:EventStatusLow" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.EventStatus can0" )
  field( NOBT, "16" )
  field( SHFT, "0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1000:EventStatusHigh" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.EventStatus can0" )
  field( NOBT, "16" )
  field( SHFT, "16" )
  field( TSE,  "-2" )
}
record( longout, "ISEG:5230102:0:1000:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.EventMask can0" )
  field( TSE,  "-2" )
}
record( ai, "ISEG:5230102:0:1000:FanSpeed" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FanSpeed can0" )
  field( TSE,  "-2" )
  field( SCAN, "1 second")
}

record( bo, "ISEG:5230102:0:1000:Control:0" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.Control:0 can0" )
  field( ZNAM, "" )
  field( ONAM, "doClear" )
  field( TSE,  "-2" )
}


record( longin, "ISEG:5230102:0:1000:SerialNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.SerialNumber can0" )
  field( TSE,  "-2" )
  field( SCAN,  "1 second" )
}

record( bo, "ISEG:5230102:0:1000:PowerOn" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.PowerOn can0" )
  field( TSE,  "-2" )
  field( ZNAM, "Off" )
  field( ONAM, "On" )
}

record( stringin, "ISEG:5230102:0:1000:FirmwareRelease" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FirmwareRelease can0" )
  field( FLNK, "ISEG:5230102:0:1000:FirmwareName" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1000:FirmwareName" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FirmwareName can0" )
  field( FLNK, "ISEG:5230102:0:1000:Article" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1000:Article" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Article can0" )
  field( TSE,  "-2" )
}


##############################
# ### Module item values ### #
##############################

record( mbbiDirect, "ISEG:5230102:0:1:Status" ) {
  field( DESC, "Lower 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( DISV, "0" )  ## Disable Value (if value linked by SDIS == DISV record is disabled)
  field( SDIS, "ISEG:5230102:0:1000:PowerOn.VAL NPP MS" )
  field( INP,  "@0.1.Status can0" )
  field( FLNK, "ISEG:5230102:0:1:EventStatus" ) ## Build read out chains
  field( TSE,  "-2" )
  field( SCAN,  "1 second" )
}

record( mbbiDirect, "ISEG:5230102:0:1:EventStatus" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.EventStatus can0" )
  field( FLNK, "ISEG:5230102:0:1:EventMask" )
  field( TSE,  "-2" )
}
record( longout, "ISEG:5230102:0:1:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.EventMask can0" )
  field( FLNK, "ISEG:5230102:0:1:Temperature" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:1:Control:doClear" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.Control:6 can0" )
  field( ZNAM, "" )
  field( ONAM, "doClear" )
  field( TSE,  "-2" )
  alias( "ch14:doClear" )
}

record( bo, "ISEG:5230102:0:1:Control:setFineAdjustment" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.Control:12 can0" )
  field( ZNAM, "FineAdjustment off" )
  field( ONAM, "FineAdjustment on" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:1:Control:setKillEnable" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.Control:14 can0" )
  field( ZNAM, "KillEnable off" )
  field( ONAM, "KillEnable on" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:VoltageRampSpeed" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.VoltageRampSpeed can0" )
  field( FLNK, "ISEG:5230102:0:1:CurrentRampSpeed" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:CurrentRampSpeed" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.CurrentRampSpeed can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:1:VoltageLimit" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.VoltageLimit can0" )
  field( FLNK, "ISEG:5230102:0:1:CurrentLimit" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( ai, "ISEG:5230102:0:1:CurrentLimit" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.CurrentLimit can0" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( ai, "ISEG:5230102:0:1:Temperature" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.Temperature can0" )
  field( TSE,  "-2" )
  field( SCAN, "1 second")
}

record( longin, "ISEG:5230102:0:1:SerialNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.SerialNumber can0" )
  field( FLNK, "ISEG:5230102:0:1:ChannelNumber" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( longin, "ISEG:5230102:0:1:ChannelNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.ChannelNumber can0" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:1:SampleRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.SampleRate can0" )
  field( FLNK, "ISEG:5230102:0:1:DigitalFilter" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:1:DigitalFilter" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.DigitalFilter can0" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:1:FirmwareRelease" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.FirmwareRelease can0" )
  field( FLNK, "ISEG:5230102:0:1:FirmwareName" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1:FirmwareName" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.FirmwareName can0" )
  field( FLNK, "ISEG:5230102:0:1:Article" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1:Article" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.Article can0" )
  field( TSE,  "-2" )
}

#####################################
# ### Decoding of Module Status ### #
#####################################

record( bi, "ISEG:5230102:0:1:isAdjustment" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B0 can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:Status:isLiveInsertion" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B2 can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:needService" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B4 can0" )
  field( ZNAM, "ok" )
  field( ONAM, "Hardware failure detected" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:isInputError" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B6 CP can0" )
  field( ZNAM, "ok" )
  field( ONAM, "Error" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:1:isNoSumError" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B8 CP can0" )
  field( ZNAM, "Error" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isNoRamp" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B9 CP can0" )
  field( ZNAM, "channel is ramping" )
  field( ONAM, "all channels stable" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isSafetyLoopGood" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BA CP can0" )
  field( ZNAM, "broken" )
  field( ONAM, "closed" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "Passive" )
  alias( "ch14:isSafetyLoopGood" )  
}

record( bi, "ISEG:5230102:0:1:isEVentActive" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BB CP can0" )
  field( ZNAM, "no active Event" )
  field( ONAM, "any event active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isModuleGood" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BC CP can0" )
  field( ZNAM, "failure" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isSuppliesGodd" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BD CP can0" )
  field( ZNAM, "Out of Range" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isTemperatureGood" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BE CP can0" )
  field( ZNAM, "above 55 degC" )
  field( ONAM, "within range" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isKillEnable" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BF can0" )
  field( ZNAM, "disabled" )
  field( ONAM, "enabled" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

###########################################
# ### Decoding of Module Event Status ### #
###########################################
record( bi, "ISEG:5230102:0:1:EventLiveInsertion" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.B2 CP can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:EventService" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.B4 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Hardware failure detected" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:EventInputError" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.B6 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Input Error in connection" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:EventSafetyLoopNotGood" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.BA CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Safety loop open" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
  alias( "ch14:EventSafetyLoopNotGood" )
}

record( bi, "ISEG:5230102:0:1:EventSuppliesNotGood" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.BD CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Supply is not good" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:EventTemperatureNotGood" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.BD CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Temperature above 55 degC" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

###############################
# ### Channel item values ### #
###############################

record( ao, "ISEG:5230102:0:1:6:VoltageSet" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.6.VoltageSet can0" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" )
  alias( "ch14:VoltageSet" )
}

record( ao, "ISEG:5230102:0:1:6:CurrentSet" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.6.CurrentSet can0" )
  field( TSE,  "-2" )
  field( PREC, "6" )
  field( SCAN, "1 second" )
  field( VAL, ".001")
  field( PINI, "YES")
  alias( "ch14:CurrentSet" )
}

record( ai, "ISEG:5230102:0:1:6:VoltageMeasure" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.6.VoltageMeasure can0" )
  field( FLNK, "ISEG:5230102:0:1:6:CurrentMeasure" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" )
  alias( "ch14:VoltageMeasure" )
}

record( ai, "ISEG:5230102:0:1:6:CurrentMeasure" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.6.CurrentMeasure can0" )
  field( FLNK, "ISEG:5230102:0:1:6:Status" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" ) 
  alias( "ch14:CurrentMeasure" )
}

record( ao, "ISEG:5230102:0:1:6:VoltageBounds" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.6.VoltageBounds can0" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:6:CurrentBounds" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.6.CurrentBounds can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:1:6:VoltageNominal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.6.VoltageNominal can0" )
  field( FLNK, "ISEG:5230102:0:1:6:CurrentNominal" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:1:6:CurrentNominal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.6.CurrentNominal can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:1:6:TemperatureExternal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.6.TemperatureExternal can0" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:6:VctCoefficient" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.6.VctCoefficient can0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1:6:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.6.Status can0" )
  field( FLNK, "ISEG:5230102:0:1:6:EventStatus" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:1:6:Control:setOn" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.6.Control:3 can0" )
  field( ZNAM, "Channel off" )
  field( ONAM, "Channel on" )
  field( TSE,  "-2" )
  alias( "ch14:setOn" )
}

record( bo, "ISEG:5230102:0:1:6:Control:setEmergency" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.6.Control:5 can0" )
  field( ZNAM, "" )
  field( ONAM, "Set EMCY" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1:6:EventStatus" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.6.EventStatus can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:1:6:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.6.EventMask can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:1:6:DelayedTripAction" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.6.DelayedTripAction can0" )
  field( FLNK, "ISEG:5230102:0:1:6:DelayedTripTime" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:6:DelayedTripTime" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.6.DelayedTripTime can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:1:6:ExternalInhibitAction" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.6.ExternalInhibitAction can0" )
  field( TSE,  "-2" )
}

######################################
# ### Decoding of Channel Status ### #
######################################
record( bi, "ISEG:5230102:0:1:6:InputError" ) {
  field( INP,  "ISEG:5230102:0:1:6:Status.B2 CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Input Error" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:1:6:isOn" ) {
  field( INP,  "ISEG:5230102:0:1:6:Status.B3 CP can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "1 second" )
  alias( "ch14:isOn" ) 
}

record( bi, "ISEG:5230102:0:1:6:isVoltageRamp" ) {
  field( INP,  "ISEG:5230102:0:1:6:Status.B4 CP can0" )
  field( ZNAM, "stable" )
  field( ONAM, "ramping" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:6:isEmergency" ) {
  field( INP,  "ISEG:5230102:0:1:6:Status.B5 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:6:isCC" ) {
  field( INP,  "ISEG:5230102:0:1:6:Status.B6 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
  field( SCAN,  "1 second" )
}

record( bi, "ISEG:5230102:0:1:6:isCV" ) {
  field( INP,  "ISEG:5230102:0:1:6:Status.B7 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "1 second" )
}

record( bi, "ISEG:5230102:0:1:6:isCurrentBound" ) {
  field( INP,  "ISEG:5230102:0:1:6:Status.BA CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Out of bounds" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:6:isVoltageBound" ) {
  field( INP,  "ISEG:5230102:0:1:6:Status.BB CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Out of bounds" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:6:isEventInhibit" ) {
  field( INP,  "ISEG:5230102:0:1:6:Status.BC CP can0" )
  field( ZNAM, "no" )
  field( ONAM, "yes" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:6:isTrip" ) {
  field( INP,  "ISEG:5230102:0:1:6:Status.BD CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "tripped" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:6:isCurrentLimit" ) {
  field( INP,  "ISEG:5230102:0:1:6:Status.BE CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "exceeded" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:6:isVoltageLimit" ) {
  field( INP,  "ISEG:5230102:0:1:6:Status.BF CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "exceeded" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

############################################
# ### Decoding of Channel Event Status ### #
############################################
record( bi, "ISEG:5230102:0:1:6:EventInputError" ) {
  field( INP,  "ISEG:5230102:0:1:6:EventStatus.B2 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:1:6:EOn2Off" ) {
  field( INP,  "ISEG:5230102:0:1:6:EventStatus.B3 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:6:EventEndOfRamp" ) {
  field( INP,  "ISEG:5230102:0:1:6:EventStatus.B4 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:6:EventEmergency" ) {
  field( INP,  "ISEG:5230102:0:1:6:EventStatus.B5 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:6:ECC" ) {
  field( INP,  "ISEG:5230102:0:1:6:EventStatus.B6 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:6:ECV" ) {
  field( INP,  "ISEG:5230102:0:1:6:EventStatus.B7 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:6:ECurrentBounds" ) {
  field( INP,  "ISEG:5230102:0:1:6:EventStatus.BA CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:6:EVVoltageBounds" ) {
  field( INP,  "ISEG:5230102:0:1:6:EventStatus.BB CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:6:EventExternalInhibit" ) {
  field( INP,  "ISEG:5230102:0:1:6:EventStatus.BC CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:6:EventTrip" ) {
  field( INP,  "ISEG:5230102:0:1:6:EventStatus.BD CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:6:EventCurrentLimit" ) {
  field( INP,  "ISEG:5230102:0:1:6:EventStatus.BE CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:6:EventVoltageLimit" ) {
  field( INP,  "ISEG:5230102:0:1:6:EventStatus.BF CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

#######################################################################
# ###                                                             ### #
# ### EPICS Database for                                          ### #
# ###   iseg HAL                                                  ### #
# ###                                                             ### #
# ### author: J. Roemer, F.Feldbauer                              ### #
# ###                                                             ### #
# ###                                                             ### #
# ### macros: CONTROLLER_SN    serial number of crate controller  ### #
# ###         CAN_LINE    CAN line ID                             ### #
# ###         CRATE_ID    crate address                           ### #
# ###         MODULE_ID   module address                          ### #
# ###         CHANNEL_ID  HV channel address                      ### #
#######################################################################
# ###    Modified: 8-21-2018 PR     ### #
# ###    Fixes interlock PVs           ### #
# ###    1 Alias           	            ### #
#test
#######################################################################

###############################
# ### CAN_System item values ##
###############################

record( stringin, "ISEG:5230102:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@Status can0" )	
  field( FLNK, "ISEG:5230102:BitRate" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:BitRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@BitRate can0" )
  field( TSE,  "-2" )
}	

record( longin, "ISEG:5230102:ModuleNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@ModuleNumber can0" )
  field( FLNK, "ISEG:5230102:CrateNumber" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:CrateNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CrateNumber can0" )
  field( FLNK, "ISEG:5230102:CrateList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:CrateList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CrateList can0" )
  field( FLNK, "ISEG:5230102:CycleCounter" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:CycleCounter" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@CycleCounter can0" )
  field( TSE,  "-2" )
}

#############################
# ### CAN_Line item values ##
#############################

record( stringin, "ISEG:5230102:0:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.Status can0" )
  field( FLNK, "ISEG:5230102:0:BitRate" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:BitRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.BitRate can0" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:ModuleNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.ModuleNumber can0" )
  field( FLNK, "ISEG:5230102:0:ModuleList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:ModuleList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.ModuleList can0" )
  field( FLNK, "ISEG:5230102:0:CrateNumber" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:CrateNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.CrateNumber can0" )
  field( FLNK, "ISEG:5230102:0:CrateList" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:CrateList" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.CrateList can0" )
  field( TSE,  "-2" )
}

#############################
# ### Crate item values ### #
#############################

record( mbbiDirect, "ISEG:5230102:0:1000:StatusLow" ) {
  field( DESC, "Lower 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Status can0" )
  field( NOBT, "16" )
  field( SHFT, "0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1000:StatusHigh" ) {
  field( DESC, "Upper 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Status can0" )
  field( NOBT, "16" )
  field( SHFT, "16" )  ## shift the value by 16 bits to the right
  field( TSE,  "-2" )
}

# Alternative way to read out the status:
# In this case only the calc record needs to be triggered

#record( longin, "ISEG:5230102:0:1000:StatusRead__" ) {
#  field( DTYP, "isegHAL" )
#  field( INP,  "@0.1000.Status can0" )
#}
#record( calc, "ISEG:5230102:0:1000:StatusSplit__" ) {
#  ## PP = Passive Process: Force the other record to process before sending the value
#  field( INPA, "ISEG:5230102:0:1000:StatusRead PP" )
#
#  field( INPB, "0x0000ffff" )
#  field( INPC, "0xffff0000" )
#
#  ## First, set field D to ( field A bitwise AND field B ),
#  ## then set field VAL to ( field A bitwise AND field C ) right shifted by 16 bit
#  field( CALC, "d:=(A&B); (A&C)>>16" )
#}
#record( mbbiDirect, "ISEG:5230102:0:1000:StatusLow" ) {
#  field( DTYP, "Soft Channel" )
#  field( INP,  "ISEG:5230102:0:1000:StatusSplit__.D CP" )
#}
#record( mbbiDirect, "ISEG:5230102:0:1000:StatusHigh" ) {
#  field( DTYP, "Soft Channel" )
#  field( INP,  "ISEG:5230102:0:1000:StatusSplit__.VAL CP" )
#}

record( mbbiDirect, "ISEG:5230102:0:1000:EventStatusLow" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.EventStatus can0" )
  field( NOBT, "16" )
  field( SHFT, "0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1000:EventStatusHigh" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.EventStatus can0" )
  field( NOBT, "16" )
  field( SHFT, "16" )
  field( TSE,  "-2" )
}
record( longout, "ISEG:5230102:0:1000:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.EventMask can0" )
  field( TSE,  "-2" )
}
record( ai, "ISEG:5230102:0:1000:FanSpeed" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FanSpeed can0" )
  field( TSE,  "-2" )
  field( SCAN, "1 second")
}

record( bo, "ISEG:5230102:0:1000:Control:0" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.Control:0 can0" )
  field( ZNAM, "" )
  field( ONAM, "doClear" )
  field( TSE,  "-2" )
}


record( longin, "ISEG:5230102:0:1000:SerialNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.SerialNumber can0" )
  field( TSE,  "-2" )
  field( SCAN,  "1 second" )
}

record( bo, "ISEG:5230102:0:1000:PowerOn" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1000.PowerOn can0" )
  field( TSE,  "-2" )
  field( ZNAM, "Off" )
  field( ONAM, "On" )
}

record( stringin, "ISEG:5230102:0:1000:FirmwareRelease" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FirmwareRelease can0" )
  field( FLNK, "ISEG:5230102:0:1000:FirmwareName" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1000:FirmwareName" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.FirmwareName can0" )
  field( FLNK, "ISEG:5230102:0:1000:Article" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1000:Article" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1000.Article can0" )
  field( TSE,  "-2" )
}


##############################
# ### Module item values ### #
##############################

record( mbbiDirect, "ISEG:5230102:0:1:Status" ) {
  field( DESC, "Lower 16 bit of module status register" )
  field( DTYP, "isegHAL" )
  field( DISV, "0" )  ## Disable Value (if value linked by SDIS == DISV record is disabled)
  field( SDIS, "ISEG:5230102:0:1000:PowerOn.VAL NPP MS" )
  field( INP,  "@0.1.Status can0" )
  field( FLNK, "ISEG:5230102:0:1:EventStatus" ) ## Build read out chains
  field( TSE,  "-2" )
  field( SCAN,  "1 second" )
}

record( mbbiDirect, "ISEG:5230102:0:1:EventStatus" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.EventStatus can0" )
  field( FLNK, "ISEG:5230102:0:1:EventMask" )
  field( TSE,  "-2" )
}
record( longout, "ISEG:5230102:0:1:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.EventMask can0" )
  field( FLNK, "ISEG:5230102:0:1:Temperature" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:1:Control:doClear" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.Control:6 can0" )
  field( ZNAM, "" )
  field( ONAM, "doClear" )
  field( TSE,  "-2" )
  alias( "ch15:doClear" )
}

record( bo, "ISEG:5230102:0:1:Control:setFineAdjustment" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.Control:12 can0" )
  field( ZNAM, "FineAdjustment off" )
  field( ONAM, "FineAdjustment on" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:1:Control:setKillEnable" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.Control:14 can0" )
  field( ZNAM, "KillEnable off" )
  field( ONAM, "KillEnable on" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:VoltageRampSpeed" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.VoltageRampSpeed can0" )
  field( FLNK, "ISEG:5230102:0:1:CurrentRampSpeed" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:CurrentRampSpeed" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.CurrentRampSpeed can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:1:VoltageLimit" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.VoltageLimit can0" )
  field( FLNK, "ISEG:5230102:0:1:CurrentLimit" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( ai, "ISEG:5230102:0:1:CurrentLimit" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.CurrentLimit can0" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( ai, "ISEG:5230102:0:1:Temperature" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.Temperature can0" )
  field( TSE,  "-2" )
  field( SCAN, "1 second")
}

record( longin, "ISEG:5230102:0:1:SerialNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.SerialNumber can0" )
  field( FLNK, "ISEG:5230102:0:1:ChannelNumber" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( longin, "ISEG:5230102:0:1:ChannelNumber" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.ChannelNumber can0" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:1:SampleRate" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.SampleRate can0" )
  field( FLNK, "ISEG:5230102:0:1:DigitalFilter" )
  field( TSE,  "-2" )
}

record( longin, "ISEG:5230102:0:1:DigitalFilter" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.DigitalFilter can0" )
  field( TSE,  "-2" )
}

record( stringin, "ISEG:5230102:0:1:FirmwareRelease" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.FirmwareRelease can0" )
  field( FLNK, "ISEG:5230102:0:1:FirmwareName" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1:FirmwareName" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.FirmwareName can0" )
  field( FLNK, "ISEG:5230102:0:1:Article" )
  field( TSE,  "-2" )
  field( SCAN, "10 second")
}

record( stringin, "ISEG:5230102:0:1:Article" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.Article can0" )
  field( TSE,  "-2" )
}

#####################################
# ### Decoding of Module Status ### #
#####################################

record( bi, "ISEG:5230102:0:1:isAdjustment" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B0 can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:Status:isLiveInsertion" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B2 can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:needService" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B4 can0" )
  field( ZNAM, "ok" )
  field( ONAM, "Hardware failure detected" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:isInputError" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B6 CP can0" )
  field( ZNAM, "ok" )
  field( ONAM, "Error" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:1:isNoSumError" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B8 CP can0" )
  field( ZNAM, "Error" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isNoRamp" ) {
  field( INP,  "ISEG:5230102:0:1:Status.B9 CP can0" )
  field( ZNAM, "channel is ramping" )
  field( ONAM, "all channels stable" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isSafetyLoopGood" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BA CP can0" )
  field( ZNAM, "broken" )
  field( ONAM, "closed" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "Passive" )
  alias( "ch15:isSafetyLoopGood" )  
}

record( bi, "ISEG:5230102:0:1:isEVentActive" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BB CP can0" )
  field( ZNAM, "no active Event" )
  field( ONAM, "any event active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isModuleGood" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BC CP can0" )
  field( ZNAM, "failure" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isSuppliesGodd" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BD CP can0" )
  field( ZNAM, "Out of Range" )
  field( ONAM, "ok" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isTemperatureGood" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BE CP can0" )
  field( ZNAM, "above 55 degC" )
  field( ONAM, "within range" )
  field( ZSV,  "MAJOR" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:isKillEnable" ) {
  field( INP,  "ISEG:5230102:0:1:Status.BF can0" )
  field( ZNAM, "disabled" )
  field( ONAM, "enabled" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

###########################################
# ### Decoding of Module Event Status ### #
###########################################
record( bi, "ISEG:5230102:0:1:EventLiveInsertion" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.B2 CP can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:EventService" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.B4 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Hardware failure detected" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:EventInputError" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.B6 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Input Error in connection" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:EventSafetyLoopNotGood" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.BA CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Safety loop open" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
  alias( "ch15:EventSafetyLoopNotGood" )
}

record( bi, "ISEG:5230102:0:1:EventSuppliesNotGood" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.BD CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Supply is not good" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:EventTemperatureNotGood" ) {
  field( INP,  "ISEG:5230102:0:1:EventStatus.BD CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "Temperature above 55 degC" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

###############################
# ### Channel item values ### #
###############################

record( ao, "ISEG:5230102:0:1:7:VoltageSet" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.7.VoltageSet can0" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" )
  alias( "ch15:VoltageSet" )
}

record( ao, "ISEG:5230102:0:1:7:CurrentSet" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.7.CurrentSet can0" )
  field( TSE,  "-2" )
  field( PREC, "6" )
  field( SCAN, "1 second" )
  field( VAL, ".001")
  field( PINI, "YES")
  alias( "ch15:CurrentSet" )
}

record( ai, "ISEG:5230102:0:1:7:VoltageMeasure" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.7.VoltageMeasure can0" )
  field( FLNK, "ISEG:5230102:0:1:7:CurrentMeasure" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" )
  alias( "ch15:VoltageMeasure" )
}

record( ai, "ISEG:5230102:0:1:7:CurrentMeasure" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.7.CurrentMeasure can0" )
  field( FLNK, "ISEG:5230102:0:1:7:Status" )
  field( TSE,  "-2" )
  field( PREC,  "6" )
  field( SCAN,  "1 second" ) 
  alias( "ch15:CurrentMeasure" )
}

record( ao, "ISEG:5230102:0:1:7:VoltageBounds" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.7.VoltageBounds can0" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:7:CurrentBounds" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.7.CurrentBounds can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:1:7:VoltageNominal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.7.VoltageNominal can0" )
  field( FLNK, "ISEG:5230102:0:1:7:CurrentNominal" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:1:7:CurrentNominal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.7.CurrentNominal can0" )
  field( TSE,  "-2" )
}

record( ai, "ISEG:5230102:0:1:7:TemperatureExternal" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.7.TemperatureExternal can0" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:7:VctCoefficient" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.7.VctCoefficient can0" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1:7:Status" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.7.Status can0" )
  field( FLNK, "ISEG:5230102:0:1:7:EventStatus" )
  field( TSE,  "-2" )
}

record( bo, "ISEG:5230102:0:1:7:Control:setOn" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.7.Control:3 can0" )
  field( ZNAM, "Channel off" )
  field( ONAM, "Channel on" )
  field( TSE,  "-2" )
  alias( "ch15:setOn" )
}

record( bo, "ISEG:5230102:0:1:7:Control:setEmergency" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.7.Control:5 can0" )
  field( ZNAM, "" )
  field( ONAM, "Set EMCY" )
  field( TSE,  "-2" )
}

record( mbbiDirect, "ISEG:5230102:0:1:7:EventStatus" ) {
  field( DTYP, "isegHAL" )
  field( INP,  "@0.1.7.EventStatus can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:1:7:EventMask" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.7.EventMask can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:1:7:DelayedTripAction" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.7.DelayedTripAction can0" )
  field( FLNK, "ISEG:5230102:0:1:7:DelayedTripTime" )
  field( TSE,  "-2" )
}

record( ao, "ISEG:5230102:0:1:7:DelayedTripTime" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.7.DelayedTripTime can0" )
  field( TSE,  "-2" )
}

record( longout, "ISEG:5230102:0:1:7:ExternalInhibitAction" ) {
  field( DTYP, "isegHAL" )
  field( OUT,  "@0.1.7.ExternalInhibitAction can0" )
  field( TSE,  "-2" )
}

######################################
# ### Decoding of Channel Status ### #
######################################
record( bi, "ISEG:5230102:0:1:7:InputError" ) {
  field( INP,  "ISEG:5230102:0:1:7:Status.B2 CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Input Error" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:1:7:isOn" ) {
  field( INP,  "ISEG:5230102:0:1:7:Status.B3 CP can0" )
  field( ZNAM, "off" )
  field( ONAM, "on" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "1 second" )
  alias( "ch15:isOn" ) 
}

record( bi, "ISEG:5230102:0:1:7:isVoltageRamp" ) {
  field( INP,  "ISEG:5230102:0:1:7:Status.B4 CP can0" )
  field( ZNAM, "stable" )
  field( ONAM, "ramping" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:7:isEmergency" ) {
  field( INP,  "ISEG:5230102:0:1:7:Status.B5 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:7:isCC" ) {
  field( INP,  "ISEG:5230102:0:1:7:Status.B6 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
  field( SCAN,  "1 second" )
}

record( bi, "ISEG:5230102:0:1:7:isCV" ) {
  field( INP,  "ISEG:5230102:0:1:7:Status.B7 CP can0" )
  field( ZNAM, "-" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
  field( SCAN,  "1 second" )
}

record( bi, "ISEG:5230102:0:1:7:isCurrentBound" ) {
  field( INP,  "ISEG:5230102:0:1:7:Status.BA CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Out of bounds" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:7:isVoltageBound" ) {
  field( INP,  "ISEG:5230102:0:1:7:Status.BB CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "Out of bounds" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:7:isEventInhibit" ) {
  field( INP,  "ISEG:5230102:0:1:7:Status.BC CP can0" )
  field( ZNAM, "no" )
  field( ONAM, "yes" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:7:isTrip" ) {
  field( INP,  "ISEG:5230102:0:1:7:Status.BD CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "tripped" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:7:isCurrentLimit" ) {
  field( INP,  "ISEG:5230102:0:1:7:Status.BE CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "exceeded" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:7:isVoltageLimit" ) {
  field( INP,  "ISEG:5230102:0:1:7:Status.BF CP can0" )
  field( ZNAM, "OK" )
  field( ONAM, "exceeded" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

############################################
# ### Decoding of Channel Event Status ### #
############################################
record( bi, "ISEG:5230102:0:1:7:EventInputError" ) {
  field( INP,  "ISEG:5230102:0:1:7:EventStatus.B2 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MINOR" )
}

record( bi, "ISEG:5230102:0:1:7:EOn2Off" ) {
  field( INP,  "ISEG:5230102:0:1:7:EventStatus.B3 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:7:EventEndOfRamp" ) {
  field( INP,  "ISEG:5230102:0:1:7:EventStatus.B4 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:7:EventEmergency" ) {
  field( INP,  "ISEG:5230102:0:1:7:EventStatus.B5 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:7:ECC" ) {
  field( INP,  "ISEG:5230102:0:1:7:EventStatus.B6 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:7:ECV" ) {
  field( INP,  "ISEG:5230102:0:1:7:EventStatus.B7 CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "NO_ALARM" )
}

record( bi, "ISEG:5230102:0:1:7:ECurrentBounds" ) {
  field( INP,  "ISEG:5230102:0:1:7:EventStatus.BA CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:7:EVVoltageBounds" ) {
  field( INP,  "ISEG:5230102:0:1:7:EventStatus.BB CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:7:EventExternalInhibit" ) {
  field( INP,  "ISEG:5230102:0:1:7:EventStatus.BC CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:7:EventTrip" ) {
  field( INP,  "ISEG:5230102:0:1:7:EventStatus.BD CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:7:EventCurrentLimit" ) {
  field( INP,  "ISEG:5230102:0:1:7:EventStatus.BE CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

record( bi, "ISEG:5230102:0:1:7:EventVoltageLimit" ) {
  field( INP,  "ISEG:5230102:0:1:7:EventStatus.BF CP can0" )
  field( ZNAM, "--" )
  field( ONAM, "active" )
  field( ZSV,  "NO_ALARM" )
  field( OSV,  "MAJOR" )
}

